import{_ as e,k as a,h as t,j as l,f as r,r as s,o,c as n,a as i,w as d,g as c,x as u,u as m,y as p,n as f,T as w,I as v,l as h,t as g,v as _,p as b,J as y,K as N,N as S,O as P,U as V,R as C,V as I,S as x}from"./_plugin-vue_export-helper-6ff18c06.js";const D={class:"merchant-product-management"},T={class:"merchant-info"},k={class:"info-row"},A={class:"info-item"},E={class:"value"},Y={class:"info-row"},O={class:"info-item"},U={class:"value"},R={class:"info-row"},M={class:"info-item"},z={class:"value"},$={class:"info-row"},B={class:"info-item"},H={class:"value ip-list"},K={class:"action-buttons"},F={class:"product-name"},L={class:"rate-value"},W={class:"form-tip"},j={class:"dialog-footer"},Q=e({__name:"MerchantProductManagement",props:{merchantInfo:{type:Object,default:()=>null}},setup(e){const h=e,g=a(()=>h.merchantInfo?{merchantId:h.merchantInfo.customerId,merchantNo:h.merchantInfo.merchantNo,signPassword:h.merchantInfo.signKey||"YOUR_SIGN_KEY_HERE",aesPassword:h.merchantInfo.merchantKey||"YOUR_AES_KEY_HERE",ipWhitelist:"39.98.76.22,39.98.76.22"}:{merchantId:"10",merchantNo:"M17408123456",signPassword:"YOUR_SIGN_KEY_HERE",aesPassword:"YOUR_AES_KEY_HERE",ipWhitelist:"39.98.76.22,39.98.76.22"}),_=t([{productName:"产品A-[10]",productCode:"PD1001",rate:"0.9760",status:"已开启",faceValue:10,productId:"PD1001"},{productName:"产品A-[20]",productCode:"PD1002",rate:"0.9760",status:"已开启",faceValue:20,productId:"PD1002"},{productName:"产品A-[30]",productCode:"PD1003",rate:"0.9760",status:"已开启",faceValue:30,productId:"PD1003"},{productName:"产品B-[50]",productCode:"PD1004",rate:"0.9760",status:"已开启",faceValue:50,productId:"PD1004"},{productName:"产品B-[100]",productCode:"PD1005",rate:"0.9760",status:"已开启",faceValue:100,productId:"PD1005"},{productName:"产品B-[200]",productCode:"PD1006",rate:"0.9760",status:"已开启",faceValue:200,productId:"PD1006"},{productName:"产品C-[200]",productCode:"PD1007",rate:"0.9760",status:"已开启",faceValue:200,productId:"PD1007"},{productName:"产品C-[100]",productCode:"PD1008",rate:"0.9760",status:"已开启",faceValue:100,productId:"PD1008"}]),b=t(!1),y=l({ipList:""}),N=t(),S=()=>{y.ipList=g.value.ipWhitelist||"",b.value=!0},P=async()=>{try{await N.value.validate(),v.success("IP白名单设置成功"),b.value=!1,h.merchantInfo||(g.value.ipWhitelist=y.ipList)}catch(e){}},V=()=>{b.value=!1,y.ipList=""},C={ipList:[{validator:(e,a,t)=>{if(!a||""===a.trim())return void t(new Error("请输入IP地址"));const l=a.split(",").map(e=>e.trim()).filter(e=>e),r=/^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;for(let s of l)if(!r.test(s))return void t(new Error(`IP地址格式不正确: ${s}`));t()},trigger:"blur"}]},I=async(e,a)=>{try{await navigator.clipboard.writeText(e),v.success(`${a}已复制到剪贴板`)}catch(t){const l=document.createElement("textarea");l.value=e,document.body.appendChild(l),l.select(),document.execCommand("copy"),document.body.removeChild(l),v.success(`${a}已复制到剪贴板`)}};return r(()=>{}),(e,a)=>{const t=s("el-icon"),l=s("el-button"),r=s("el-card"),v=s("el-table-column"),h=s("el-tag"),x=s("el-table"),Q=s("el-input"),q=s("el-text"),G=s("el-form-item"),J=s("el-form"),X=s("el-dialog");return o(),n("div",D,[i(r,{shadow:"never",class:"merchant-info-card"},{default:d(()=>[c("div",T,[c("div",k,[c("div",A,[a[5]||(a[5]=c("span",{class:"label"},"商户号",-1)),c("span",E,u(g.value.merchantNo),1),i(t,{class:"copy-icon",onClick:a[0]||(a[0]=e=>I(g.value.merchantNo,"商户号"))},{default:d(()=>[i(m(p))]),_:1})])]),c("div",Y,[c("div",O,[a[6]||(a[6]=c("span",{class:"label"},"签名密钥",-1)),c("span",U,u(g.value.signPassword),1),i(t,{class:"copy-icon",onClick:a[1]||(a[1]=e=>I(g.value.signPassword,"签名密钥"))},{default:d(()=>[i(m(p))]),_:1})])]),c("div",R,[c("div",M,[a[7]||(a[7]=c("span",{class:"label"},"AES密钥",-1)),c("span",z,u(g.value.aesPassword),1),i(t,{class:"copy-icon",onClick:a[2]||(a[2]=e=>I(g.value.aesPassword,"AES密钥"))},{default:d(()=>[i(m(p))]),_:1})])]),c("div",$,[c("div",B,[a[8]||(a[8]=c("span",{class:"label"},"IP白名单",-1)),c("span",H,u(g.value.ipWhitelist),1)])])]),c("div",K,[i(l,{type:"warning",onClick:S},{default:d(()=>[...a[9]||(a[9]=[f("设置IP白名单",-1)])]),_:1})])]),_:1}),i(r,{shadow:"never",class:"product-rate-card"},{default:d(()=>[a[10]||(a[10]=c("div",{class:"card-header"},[c("h3",null,"产品费率：")],-1)),i(x,{data:_.value,border:"",stripe:"",style:{width:"100%"},height:"400"},{default:d(()=>[i(v,{prop:"productName",label:"产品名称","min-width":"200"},{default:d(({row:e})=>[c("span",F,u(e.productName),1)]),_:1}),i(v,{prop:"productCode",label:"产品编码","min-width":"150"}),i(v,{prop:"rate",label:"费率","min-width":"120",align:"center"},{default:d(({row:e})=>[c("span",L,u(e.rate),1)]),_:1}),i(v,{prop:"status",label:"状态","min-width":"120",align:"center"},{default:d(({row:e})=>[i(h,{type:"success",size:"small"},{default:d(()=>[f(u(e.status),1)]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1}),i(X,{modelValue:b.value,"onUpdate:modelValue":a[4]||(a[4]=e=>b.value=e),title:"设置IP白名单",width:"500px","close-on-click-modal":!1},{footer:d(()=>[c("div",j,[i(l,{onClick:V},{default:d(()=>[...a[12]||(a[12]=[f("取消",-1)])]),_:1}),i(l,{type:"primary",onClick:P},{default:d(()=>[...a[13]||(a[13]=[f("确认",-1)])]),_:1})])]),default:d(()=>[i(J,{ref_key:"ipWhitelistFormRef",ref:N,model:y,rules:C,"label-width":"100px","label-position":"top"},{default:d(()=>[i(G,{label:"IP地址列表",prop:"ipList"},{default:d(()=>[i(Q,{modelValue:y.ipList,"onUpdate:modelValue":a[3]||(a[3]=e=>y.ipList=e),type:"textarea",rows:6,placeholder:"请输入IP地址，多个IP地址之间用英文逗号(,)分隔\n\n示例：192.168.1.1,192.168.1.2,10.0.0.1",clearable:""},null,8,["modelValue"]),c("div",W,[i(q,{type:"info",size:"small"},{default:d(()=>[i(t,null,{default:d(()=>[i(m(w))]),_:1}),a[11]||(a[11]=f(" 多个IP地址之间请用英文逗号(,)分隔，支持IPv4格式 ",-1))]),_:1})])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-97199654"]]),q={class:"page-container"},G={class:"filter-line"},J={class:"count-text"},X={class:"amount-text"},Z={class:"success-text"},ee={class:"success-amount-text"},ae={class:"real-success-text"},te={class:"real-success-amount-text"},le={class:"fail-text"},re={class:"fail-amount-text"},se={class:"processing-text"},oe={class:"processing-amount-text"},ne=e({__name:"ProductStatistics",setup(e){const a=l({dateRange:[]}),m=t([{date:"2025-08-27",totalCount:913,totalAmount:"39330",successCount:913,successAmount:"39330",realSuccessCount:"38396.0500",realSuccessAmount:0,failCount:0,failAmount:0,processingCount:0,processingAmount:0}]),p=t(!1),w=()=>{p.value=!0,setTimeout(()=>{p.value=!1,v.success("查询完成")},1e3)},b=()=>{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0),l=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59);a.dateRange=[t.toISOString().slice(0,19).replace("T"," "),l.toISOString().slice(0,19).replace("T"," ")],w()},y=()=>{const e=new Date;e.setDate(e.getDate()-1);const t=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0),l=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59);a.dateRange=[t.toISOString().slice(0,19).replace("T"," "),l.toISOString().slice(0,19).replace("T"," ")],w()},N=()=>{const e=new Date,t=new Date;t.setDate(e.getDate()-7);const l=new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0),r=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59);a.dateRange=[l.toISOString().slice(0,19).replace("T"," "),r.toISOString().slice(0,19).replace("T"," ")],w()};return r(()=>{b()}),(e,t)=>{const l=s("el-date-picker"),r=s("el-form-item"),v=s("el-button"),S=s("el-form"),P=s("el-card"),V=s("el-table-column"),C=s("el-table"),I=h("loading");return o(),n("div",q,[i(P,{class:"filter-container",shadow:"never"},{default:d(()=>[i(S,{model:a,inline:"",class:"multi-line-filter-form"},{default:d(()=>[c("div",G,[i(r,{label:"日期时间：",prop:"dateRange"},{default:d(()=>[i(l,{modelValue:a.dateRange,"onUpdate:modelValue":t[0]||(t[0]=e=>a.dateRange=e),type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",style:{width:"350px"}},null,8,["modelValue"])]),_:1}),i(r,null,{default:d(()=>[i(v,{type:"primary",onClick:w},{default:d(()=>[...t[1]||(t[1]=[f("查询",-1)])]),_:1}),i(v,{onClick:b},{default:d(()=>[...t[2]||(t[2]=[f("今天",-1)])]),_:1}),i(v,{onClick:y},{default:d(()=>[...t[3]||(t[3]=[f("昨天",-1)])]),_:1}),i(v,{onClick:N},{default:d(()=>[...t[4]||(t[4]=[f("最近7天",-1)])]),_:1})]),_:1})])]),_:1},8,["model"])]),_:1}),i(P,{shadow:"never",class:"table-card"},{default:d(()=>[t[5]||(t[5]=c("div",{class:"card-header"},[c("h3",null,"产品统计")],-1)),g((o(),_(C,{data:m.value,border:"",stripe:"",class:"statistics-table"},{default:d(()=>[i(V,{prop:"date",label:"统计日期","min-width":"120",align:"center"}),i(V,{prop:"totalCount",label:"总笔数","min-width":"100",align:"center"},{default:d(({row:e})=>[c("span",J,u(e.totalCount),1)]),_:1}),i(V,{prop:"totalAmount",label:"总金额","min-width":"120",align:"center"},{default:d(({row:e})=>[c("span",X,u(e.totalAmount),1)]),_:1}),i(V,{prop:"successCount",label:"成功笔数","min-width":"100",align:"center"},{default:d(({row:e})=>[c("span",Z,u(e.successCount),1)]),_:1}),i(V,{prop:"successAmount",label:"成功金额","min-width":"120",align:"center"},{default:d(({row:e})=>[c("span",ee,u(e.successAmount),1)]),_:1}),i(V,{prop:"realSuccessCount",label:"实际成功笔数","min-width":"120",align:"center"},{default:d(({row:e})=>[c("span",ae,u(e.realSuccessCount),1)]),_:1}),i(V,{prop:"realSuccessAmount",label:"实际成功金额","min-width":"120",align:"center"},{default:d(({row:e})=>[c("span",te,u(e.realSuccessAmount),1)]),_:1}),i(V,{prop:"failCount",label:"失败笔数","min-width":"100",align:"center"},{default:d(({row:e})=>[c("span",le,u(e.failCount),1)]),_:1}),i(V,{prop:"failAmount",label:"失败金额","min-width":"120",align:"center"},{default:d(({row:e})=>[c("span",re,u(e.failAmount),1)]),_:1}),i(V,{prop:"processingCount",label:"处理中笔数","min-width":"120",align:"center"},{default:d(({row:e})=>[c("span",se,u(e.processingCount),1)]),_:1}),i(V,{prop:"processingAmount",label:"处理中金额","min-width":"120",align:"center"},{default:d(({row:e})=>[c("span",oe,u(e.processingAmount),1)]),_:1})]),_:1},8,["data"])),[[I,p.value]])]),_:1})])}}},[["__scopeId","data-v-0fc711ea"]]),ie={class:"page-container"},de={class:"filter-line"},ce={class:"filter-line"},ue={class:"filter-line"},me={class:"filter-line"},pe={class:"filter-buttons"},fe={class:"table-toolbar"},we={class:"toolbar-left"},ve={class:"toolbar-right"},he={class:"order-info"},ge={class:"order-id"},_e={class:"system-id"},be={class:"card-info"},ye={class:"card-number"},Ne={class:"card-password"},Se={class:"pagination-container"},Pe=e({__name:"WithdrawalRecords",setup(e){const p=l({orderNo:"",productName:"",transactionStatus:"",verificationStatus:"",withdrawalTime:[],merchantOrderNo:"",systemOrderNo:"",faceValue:"",cardNo:""}),w=t([]),N=t(!1),S=t([]),P=a(()=>S.value.filter(e=>"unverified"===e.verificationStatus).length),V=a(()=>S.value.filter(e=>"locked"===e.verificationStatus).length),C=a(()=>S.value.length>0&&S.value.every(e=>"unverified"===e.verificationStatus)),I=a(()=>S.value.length>0&&S.value.every(e=>"locked"===e.verificationStatus)),x=l({currentPage:1,pageSize:20,total:0}),D=[{id:1,orderNo:"B1720300348648058428",systemId:"2024073651326773609",productName:"联通充值卡 【10元】",faceValue:"10",cardNumber:"626816800002319902",cardPassword:"••••••••1020",transactionAmount:"29.28",transactionQuantity:1,transactionStatus:"success",withdrawalTime:"2025-06-27 21:16:26",verificationStatus:"verified",withdrawalTimestamp:"1719504986000"},{id:2,orderNo:"B1720300379060721406",systemId:"2024073651326907464",productName:"移动充值卡 【20元】",faceValue:"20",cardNumber:"654688700000616170",cardPassword:"••••••••9934",transactionAmount:"19.52",transactionQuantity:1,transactionStatus:"success",withdrawalTime:"2025-06-27 21:16:19",verificationStatus:"unverified",withdrawalTimestamp:"1719504979000"},{id:3,orderNo:"B1720300352624312456",systemId:"2024073651327704814",productName:"电信充值卡 【30元】",faceValue:"30",cardNumber:"654683000137951548",cardPassword:"••••••••7823",transactionAmount:"29.28",transactionQuantity:1,transactionStatus:"processing",withdrawalTime:"2025-06-27 21:15:52",verificationStatus:"locked",withdrawalTimestamp:"1719504952000"},{id:4,orderNo:"B1720300342476025715",systemId:"2024073651326876567",productName:"联通充值卡 【20元】",faceValue:"20",cardNumber:"626816800002319903",cardPassword:"••••••••2031",transactionAmount:"29.28",transactionQuantity:1,transactionStatus:"failed",withdrawalTime:"2025-06-27 21:14:54",verificationStatus:"unverified",withdrawalTimestamp:"1719504894000"},{id:5,orderNo:"B1720300348367603714",systemId:"V1720300316764341412",productName:"移动充值卡 【20元】",faceValue:"20",cardNumber:"654688700000616171",cardPassword:"••••••••4567",transactionAmount:"29.28",transactionQuantity:1,transactionStatus:"success",withdrawalTime:"2025-06-27 21:14:48",verificationStatus:"verified",withdrawalTimestamp:"1719504888000"}],T=e=>({success:"处理成功",processing:"处理中",failed:"处理失败"}[e]||"未知状态"),k=e=>({verified:"已核销",unverified:"未核销",locked:"已锁定"}[e]||"未知状态"),A=e=>{if(!e)return"-";return new Date(parseInt(e)).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})},E=async(e=null)=>{N.value=!0;try{await new Promise(e=>setTimeout(e,500));let a=[...D];e&&(e.cardNumbers&&e.cardNumbers.length>0&&(a=a.filter(a=>e.cardNumbers.some(e=>a.cardNumber.includes(e)))),e.orderNo&&(a=a.filter(a=>a.orderNo.includes(e.orderNo))),e.productName&&(a=a.filter(a=>a.productName.includes(e.productName))),e.transactionStatus&&(a=a.filter(a=>a.transactionStatus===e.transactionStatus)),e.verificationStatus&&(a=a.filter(a=>a.verificationStatus===e.verificationStatus)),e.merchantOrderNo&&(a=a.filter(a=>a.orderNo.includes(e.merchantOrderNo))),e.systemOrderNo&&(a=a.filter(a=>a.systemId.includes(e.systemOrderNo))),e.faceValue&&(a=a.filter(a=>a.faceValue===e.faceValue))),w.value=a,x.total=a.length}catch(a){v.error("加载数据失败")}finally{N.value=!1}},Y=()=>{let e=[];p.cardNo&&p.cardNo.trim()&&(e=p.cardNo.split("\n").map(e=>e.trim()).filter(e=>e.length>0));const a={...p,cardNumbers:e};E(a)},O=()=>{Object.keys(p).forEach(e=>{Array.isArray(p[e])?p[e]=[]:p[e]=""}),E()},U=()=>{E()},R=e=>{S.value=e},M=async()=>{if(!C.value)return void v.warning("请选择未核销状态的记录进行锁定");const e=S.value.filter(e=>"unverified"===e.verificationStatus);try{await y.confirm(`确认锁定选中的 ${e.length} 条记录？`,"锁卡确认",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}),await new Promise(e=>setTimeout(e,1e3)),e.forEach(e=>{e.verificationStatus="locked"}),v.success(`成功锁定 ${e.length} 条记录`)}catch(a){"cancel"!==a&&v.error("锁卡操作失败")}},z=async()=>{if(!I.value)return void v.warning("请选择已锁定状态的记录进行解锁");const e=S.value.filter(e=>"locked"===e.verificationStatus);try{await y.confirm(`确认解锁选中的 ${e.length} 条记录？`,"解锁确认",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}),await new Promise(e=>setTimeout(e,1e3)),e.forEach(e=>{e.verificationStatus="unverified"}),v.success(`成功解锁 ${e.length} 条记录`)}catch(a){"cancel"!==a&&v.error("解锁操作失败")}},$=e=>{x.pageSize=e,x.currentPage=1,E()},B=e=>{x.currentPage=e,E()};return r(()=>{E()}),(e,a)=>{const t=s("el-input"),l=s("el-form-item"),r=s("el-option"),S=s("el-select"),D=s("el-date-picker"),E=s("el-button"),H=s("el-form"),K=s("el-card"),F=s("el-table-column"),L=s("el-tag"),W=s("el-switch"),j=s("el-table"),Q=s("el-pagination"),q=h("loading");return o(),n("div",ie,[i(K,{class:"filter-container",shadow:"never"},{default:d(()=>[i(H,{model:p,inline:"",class:"multi-line-filter-form"},{default:d(()=>[c("div",de,[i(l,{label:"订单号：",prop:"orderNo"},{default:d(()=>[i(t,{modelValue:p.orderNo,"onUpdate:modelValue":a[0]||(a[0]=e=>p.orderNo=e),placeholder:"请输入订单号",clearable:"",style:{width:"220px"}},null,8,["modelValue"])]),_:1}),i(l,{label:"产品：",prop:"productName"},{default:d(()=>[i(t,{modelValue:p.productName,"onUpdate:modelValue":a[1]||(a[1]=e=>p.productName=e),placeholder:"请输入产品名称",clearable:"",style:{width:"168px"}},null,8,["modelValue"])]),_:1}),i(l,{label:"交易状态：",prop:"transactionStatus"},{default:d(()=>[i(S,{modelValue:p.transactionStatus,"onUpdate:modelValue":a[2]||(a[2]=e=>p.transactionStatus=e),placeholder:"请选择交易状态",clearable:"",style:{width:"168px"}},{default:d(()=>[i(r,{label:"处理成功",value:"success"}),i(r,{label:"处理中",value:"processing"}),i(r,{label:"处理失败",value:"failed"})]),_:1},8,["modelValue"])]),_:1})]),c("div",ce,[i(l,{label:"核销状态：",prop:"verificationStatus"},{default:d(()=>[i(S,{modelValue:p.verificationStatus,"onUpdate:modelValue":a[3]||(a[3]=e=>p.verificationStatus=e),placeholder:"请选择核销状态",clearable:"",style:{width:"168px"}},{default:d(()=>[i(r,{label:"已核销",value:"verified"}),i(r,{label:"未核销",value:"unverified"}),i(r,{label:"已锁定",value:"locked"})]),_:1},8,["modelValue"])]),_:1}),i(l,{label:"提卡时间：",prop:"withdrawalTime"},{default:d(()=>[i(D,{modelValue:p.withdrawalTime,"onUpdate:modelValue":a[4]||(a[4]=e=>p.withdrawalTime=e),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",style:{width:"350px"}},null,8,["modelValue"])]),_:1})]),c("div",ue,[i(l,{label:"商户单号：",prop:"merchantOrderNo"},{default:d(()=>[i(t,{modelValue:p.merchantOrderNo,"onUpdate:modelValue":a[5]||(a[5]=e=>p.merchantOrderNo=e),placeholder:"请输入商户单号",clearable:"",style:{width:"220px"}},null,8,["modelValue"])]),_:1}),i(l,{label:"系统单号：",prop:"systemOrderNo"},{default:d(()=>[i(t,{modelValue:p.systemOrderNo,"onUpdate:modelValue":a[6]||(a[6]=e=>p.systemOrderNo=e),placeholder:"请输入系统单号",clearable:"",style:{width:"220px"}},null,8,["modelValue"])]),_:1})]),c("div",me,[i(l,{label:"面值：",prop:"faceValue"},{default:d(()=>[i(S,{modelValue:p.faceValue,"onUpdate:modelValue":a[7]||(a[7]=e=>p.faceValue=e),placeholder:"请选择面值",clearable:"",style:{width:"168px"}},{default:d(()=>[i(r,{label:"10元",value:"10"}),i(r,{label:"20元",value:"20"}),i(r,{label:"30元",value:"30"}),i(r,{label:"50元",value:"50"}),i(r,{label:"100元",value:"100"}),i(r,{label:"200元",value:"200"}),i(r,{label:"300元",value:"300"})]),_:1},8,["modelValue"])]),_:1}),i(l,{label:"卡号：",prop:"cardNo"},{default:d(()=>[i(t,{modelValue:p.cardNo,"onUpdate:modelValue":a[8]||(a[8]=e=>p.cardNo=e),type:"textarea",rows:3,maxlength:1e3,placeholder:"请输入卡号，多个卡号请换行分隔",clearable:"",style:{width:"220px"},resize:"none"},null,8,["modelValue"])]),_:1}),c("div",pe,[i(E,{type:"primary",onClick:Y},{default:d(()=>[...a[11]||(a[11]=[f("查询",-1)])]),_:1}),i(E,{plain:"",onClick:O},{default:d(()=>[...a[12]||(a[12]=[f("重置",-1)])]),_:1})])])]),_:1},8,["model"])]),_:1}),i(K,{class:"table-container",shadow:"never"},{default:d(()=>[c("div",fe,[c("div",we,[i(E,{type:"warning",disabled:!C.value,onClick:M},{default:d(()=>[f(" 锁卡"+u(P.value>0?`(${P.value})`:""),1)]),_:1},8,["disabled"]),i(E,{type:"success",disabled:!I.value,onClick:z},{default:d(()=>[f(" 解锁"+u(V.value>0?`(${V.value})`:""),1)]),_:1},8,["disabled"])]),c("div",ve,[i(E,{icon:m(b),onClick:U},{default:d(()=>[...a[13]||(a[13]=[f("刷新",-1)])]),_:1},8,["icon"])])]),g((o(),_(j,{data:w.value,border:"",stripe:"",style:{"margin-top":"16px"},onSelectionChange:R},{default:d(()=>[i(F,{type:"selection",width:"55"}),i(F,{prop:"orderNo",label:"订单号","min-width":"180"},{default:d(({row:e})=>[c("div",he,[c("div",ge,u(e.orderNo),1),c("div",_e,u(e.systemId),1)])]),_:1}),i(F,{prop:"productName",label:"产品","min-width":"150"},{default:d(({row:e,$index:a})=>[c("span",null,"产品"+u(String.fromCharCode(65+a))+"-["+u(e.faceValue)+"]",1)]),_:1}),i(F,{prop:"cardInfo",label:"卡密","min-width":"200"},{default:d(({row:e})=>[c("div",be,[c("div",ye,u(e.cardNumber),1),c("div",Ne,u(e.cardPassword),1)])]),_:1}),i(F,{prop:"transactionAmount",label:"交易金额","min-width":"100"},{default:d(({row:e})=>[f(" ¥"+u(e.transactionAmount),1)]),_:1}),i(F,{prop:"transactionQuantity",label:"交易数量","min-width":"100"}),i(F,{prop:"transactionStatus",label:"交易状态","min-width":"120"},{default:d(({row:e})=>{return[i(L,{type:(a=e.transactionStatus,{success:"success",processing:"warning",failed:"danger"}[a]||"info"),size:"small"},{default:d(()=>[f(u(T(e.transactionStatus)),1)]),_:2},1032,["type"])];var a}),_:1}),i(F,{prop:"withdrawalTime",label:"提卡时间","min-width":"160"}),i(F,{prop:"verificationStatus",label:"核销状态","min-width":"120"},{default:d(({row:e})=>{return[i(L,{type:(a=e.verificationStatus,{verified:"success",unverified:"warning",locked:"danger"}[a]||"info"),size:"small"},{default:d(()=>[f(u(k(e.verificationStatus)),1)]),_:2},1032,["type"])];var a}),_:1}),i(F,{label:"锁卡开关","min-width":"100",align:"center",fixed:"right"},{default:d(({row:e})=>[i(W,{"model-value":"locked"===e.verificationStatus,disabled:"verified"===e.verificationStatus,onChange:a=>(async(e,a)=>{const t=a?"锁定":"解锁",l=`确认${t}该卡密？`;try{await y.confirm(l,`${t}确认`,{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}),await new Promise(e=>setTimeout(e,500)),e.verificationStatus=a?"locked":"unverified",v.success(`${t}成功`)}catch(r){"cancel"!==r&&v.error(`${t}操作失败`)}})(e,a),"active-text":"","inactive-text":"","active-color":"verified"===e.verificationStatus?"#C0C4CC":"#13CE66","inactive-color":"verified"===e.verificationStatus?"#C0C4CC":"#DCDFE6"},null,8,["model-value","disabled","onChange","active-color","inactive-color"])]),_:1}),i(F,{prop:"withdrawalTimestamp",label:"核销时间","min-width":"180"},{default:d(({row:e})=>[f(u(A(e.withdrawalTimestamp)),1)]),_:1})]),_:1},8,["data"])),[[q,N.value]]),c("div",Se,[i(Q,{"current-page":x.currentPage,"onUpdate:currentPage":a[9]||(a[9]=e=>x.currentPage=e),"page-size":x.pageSize,"onUpdate:pageSize":a[10]||(a[10]=e=>x.pageSize=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:x.total,onSizeChange:$,onCurrentChange:B},null,8,["current-page","page-size","total"])])]),_:1})])}}},[["__scopeId","data-v-41b7a15e"]]),Ve={class:"reset-password"},Ce={class:"form-container"},Ie=e({__name:"ResetPassword",setup(e){const a=t(),r=t(!1),u=l({currentPassword:"",newPassword:"",confirmPassword:""}),m={currentPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"}],newPassword:[{required:!0,validator:(e,t,l)=>{""===t?l(new Error("请输入新密码")):t.length<6?l(new Error("密码长度不能少于6位")):t===u.currentPassword?l(new Error("新密码不能与当前密码相同")):(""!==u.confirmPassword&&a.value.validateField("confirmPassword"),l())},trigger:"blur"}],confirmPassword:[{required:!0,validator:(e,a,t)=>{""===a?t(new Error("请再次输入新密码")):a!==u.newPassword?t(new Error("两次输入密码不一致")):t()},trigger:"blur"}]},p=async()=>{try{await a.value.validate(),r.value=!0,await new Promise(e=>setTimeout(e,1e3)),v.success("密码修改成功"),w()}catch(e){}finally{r.value=!1}},w=()=>{var e;null==(e=a.value)||e.resetFields(),Object.assign(u,{currentPassword:"",newPassword:"",confirmPassword:""})};return(e,t)=>{const l=s("el-input"),v=s("el-form-item"),h=s("el-button"),g=s("el-space"),_=s("el-form"),b=s("el-card");return o(),n("div",Ve,[c("div",Ce,[i(b,{class:"form-card"},{default:d(()=>[i(_,{ref_key:"passwordFormRef",ref:a,model:u,rules:m,"label-width":"100px"},{default:d(()=>[i(v,{label:"当前密码",prop:"currentPassword"},{default:d(()=>[i(l,{modelValue:u.currentPassword,"onUpdate:modelValue":t[0]||(t[0]=e=>u.currentPassword=e),type:"password",placeholder:"请输入当前密码","show-password":""},null,8,["modelValue"])]),_:1}),i(v,{label:"新密码",prop:"newPassword"},{default:d(()=>[i(l,{modelValue:u.newPassword,"onUpdate:modelValue":t[1]||(t[1]=e=>u.newPassword=e),type:"password",placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),i(v,{label:"确认新密码",prop:"confirmPassword"},{default:d(()=>[i(l,{modelValue:u.confirmPassword,"onUpdate:modelValue":t[2]||(t[2]=e=>u.confirmPassword=e),type:"password",placeholder:"请再次输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),i(v,null,{default:d(()=>[i(g,null,{default:d(()=>[i(h,{type:"primary",loading:r.value,onClick:p},{default:d(()=>[...t[3]||(t[3]=[f(" 保存 ",-1)])]),_:1},8,["loading"]),i(h,{onClick:w},{default:d(()=>[...t[4]||(t[4]=[f("重置",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])])}}},[["__scopeId","data-v-d14f508e"]]),xe={class:"header-left"},De={class:"page-title"},Te={class:"toolbar"},ke={class:"user-info"},Ae={class:"user-nickname"},Ee=e({__name:"MerchantDashboard",setup(e){const l=t({merchantNo:"",merchantKey:"",customerName:"",customerId:""});r(()=>{const e=new URLSearchParams(window.location.search),a=e.get("merchantNo"),t=e.get("merchantKey"),r=e.get("customerName"),s=e.get("customerId");a&&t&&r&&s?(l.value={merchantNo:a,merchantKey:t,customerName:r,customerId:s},v.success(`欢迎进入商户后台系统，${r}`)):(l.value={merchantNo:"MERCHANT001",merchantKey:"KEY001",customerName:"测试商户",customerId:"001"},v.success("欢迎进入商户后台系统"))});const n=t("product-management"),p=N(Q),f={"product-management":Q,"order-management":ne,"withdrawal-records":Pe,"reset-password":Ie},w={"product-management":"产品管理","order-management":"产品统计","balance-management":"余额管理","withdrawal-records":"提卡记录","reset-password":"重置密码","api-docs":"API文档","account-settings":"账户设置","security-settings":"安全设置"},h=a(()=>w[n.value]||"商户后台"),g=e=>{f[e]?(n.value=e,p.value=f[e]):v.info(`${w[e]||"该功能"}正在开发中...`)},b=e=>{switch(e){case"profile":v.info("个人资料功能开发中...");break;case"reset-password":n.value="reset-password",p.value=Ie;break;case"logout":v.success("退出登录成功")}};return(e,a)=>{const t=s("el-icon"),r=s("el-menu-item"),f=s("el-menu"),w=s("el-scrollbar"),v=s("el-aside"),y=s("el-avatar"),N=s("el-dropdown-item"),D=s("el-dropdown-menu"),T=s("el-dropdown"),k=s("el-header"),A=s("el-main"),E=s("el-container");return o(),_(E,{class:"merchant-layout-container"},{default:d(()=>[i(v,{width:"200px",class:"merchant-layout-aside"},{default:d(()=>[a[4]||(a[4]=c("div",{class:"merchant-layout-logo"},[c("span",null,"商户后台")],-1)),i(w,null,{default:d(()=>[i(f,{"default-active":n.value,onSelect:g},{default:d(()=>[i(r,{index:"product-management"},{default:d(()=>[i(t,null,{default:d(()=>[i(m(S))]),_:1}),a[0]||(a[0]=c("span",null,"产品管理",-1))]),_:1}),i(r,{index:"order-management"},{default:d(()=>[i(t,null,{default:d(()=>[i(m(P))]),_:1}),a[1]||(a[1]=c("span",null,"产品统计",-1))]),_:1}),i(r,{index:"withdrawal-records"},{default:d(()=>[i(t,null,{default:d(()=>[i(m(V))]),_:1}),a[2]||(a[2]=c("span",null,"提卡记录",-1))]),_:1}),i(r,{index:"reset-password"},{default:d(()=>[i(t,null,{default:d(()=>[i(m(C))]),_:1}),a[3]||(a[3]=c("span",null,"重置密码",-1))]),_:1})]),_:1},8,["default-active"])]),_:1})]),_:1}),i(E,null,{default:d(()=>[i(k,{class:"merchant-layout-header"},{default:d(()=>[c("div",xe,[c("span",De,u(h.value),1)]),c("div",Te,[i(T,{onCommand:b},{dropdown:d(()=>[i(D,null,{default:d(()=>[i(N,{command:"reset-password"},{default:d(()=>[i(t,null,{default:d(()=>[i(m(C))]),_:1}),a[5]||(a[5]=c("span",null,"修改密码",-1))]),_:1}),i(N,{command:"logout",divided:""},{default:d(()=>[i(t,null,{default:d(()=>[i(m(I))]),_:1}),a[6]||(a[6]=c("span",null,"退出登录",-1))]),_:1})]),_:1})]),default:d(()=>[c("div",ke,[i(y,{size:32,icon:"User",class:"user-avatar"}),c("span",Ae,u(l.value.customerName),1)])]),_:1})])]),_:1}),i(A,{class:"merchant-layout-main"},{default:d(()=>[i(w,null,{default:d(()=>[(o(),_(x(p.value),{"merchant-info":l.value},null,8,["merchant-info"]))]),_:1})]),_:1})]),_:1})]),_:1})}}},[["__scopeId","data-v-f770a7c9"]]);export{Ee as M,Ie as R};
