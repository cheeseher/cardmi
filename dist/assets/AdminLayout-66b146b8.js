import{_ as ie,f as Y,g as p,h as be,r as a,o as O,c as ue,a as e,w as t,j as o,u as b,k as Qe,t as $,l as mt,m as Xe,n as Je,s as _e,p as n,q as re,v as f,x as Ae,y as Ve,z as De,A as ve,B as oe,C as pt,D as ft,F as we,G as Ge,H as Se,I as He,J as _t,K as gt,L as vt,M as fe,N as bt,O as je,P as yt,Q as wt,R as Vt,S as ht,T as Ct,U as kt,V as St}from"./_plugin-vue_export-helper-66886bb0.js";const xt={class:"dashboard"},Nt={class:"stat-content"},It={class:"stat-icon primary"},$t={class:"stat-info"},Pt={class:"stat-value"},Dt={class:"stat-content"},Ut={class:"stat-icon success"},Tt={class:"stat-info"},zt={class:"stat-value"},Rt={class:"stat-content"},Et={class:"stat-icon warning"},Mt={class:"stat-info"},Ft={class:"stat-value"},At={class:"stat-content"},Lt={class:"stat-icon danger"},Bt={class:"stat-info"},Yt={class:"stat-value"},Ot={__name:"Dashboard",setup(ce){const y=Y({totalUsers:1234,totalCards:5678,totalOrders:890,totalRevenue:123456}),k=Y({dateRange:[],dataType:""}),_=p(!1),D=async()=>{_.value=!0;try{await new Promise(w=>setTimeout(w,1e3)),f.success("数据查询成功")}catch{f.error("查询失败，请重试")}finally{_.value=!1}},z=()=>{k.dateRange=[],k.dataType="",f.info("筛选条件已重置")};return be(()=>{}),(w,r)=>{const g=a("el-icon"),h=a("el-card"),i=a("el-col"),v=a("el-row"),F=a("el-date-picker"),N=a("el-form-item"),K=a("el-option"),j=a("el-select"),q=a("el-button"),M=a("el-form");return O(),ue("div",xt,[e(v,{gutter:16,class:"stats-row"},{default:t(()=>[e(i,{xs:24,sm:12,lg:6},{default:t(()=>[e(h,{class:"stat-card",shadow:"hover"},{default:t(()=>[o("div",Nt,[o("div",It,[e(g,null,{default:t(()=>[e(b(Qe))]),_:1})]),o("div",$t,[o("div",Pt,$(y.totalUsers),1),r[2]||(r[2]=o("div",{class:"stat-label"},"总用户数",-1))])])]),_:1})]),_:1}),e(i,{xs:24,sm:12,lg:6},{default:t(()=>[e(h,{class:"stat-card",shadow:"hover"},{default:t(()=>[o("div",Dt,[o("div",Ut,[e(g,null,{default:t(()=>[e(b(mt))]),_:1})]),o("div",Tt,[o("div",zt,$(y.totalCards),1),r[3]||(r[3]=o("div",{class:"stat-label"},"总卡密数",-1))])])]),_:1})]),_:1}),e(i,{xs:24,sm:12,lg:6},{default:t(()=>[e(h,{class:"stat-card",shadow:"hover"},{default:t(()=>[o("div",Rt,[o("div",Et,[e(g,null,{default:t(()=>[e(b(Xe))]),_:1})]),o("div",Mt,[o("div",Ft,$(y.totalOrders),1),r[4]||(r[4]=o("div",{class:"stat-label"},"总订单数",-1))])])]),_:1})]),_:1}),e(i,{xs:24,sm:12,lg:6},{default:t(()=>[e(h,{class:"stat-card",shadow:"hover"},{default:t(()=>[o("div",At,[o("div",Lt,[e(g,null,{default:t(()=>[e(b(Je))]),_:1})]),o("div",Bt,[o("div",Yt,"¥"+$(y.totalRevenue),1),r[5]||(r[5]=o("div",{class:"stat-label"},"总收入",-1))])])]),_:1})]),_:1})]),_:1}),e(h,{shadow:"never",class:"filter-container"},{default:t(()=>[e(M,{model:k,inline:"",class:"filter-form"},{default:t(()=>[e(N,{label:"日期范围：",prop:"dateRange"},{default:t(()=>[e(F,{modelValue:k.dateRange,"onUpdate:modelValue":r[0]||(r[0]=J=>k.dateRange=J),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"240px"}},null,8,["modelValue"])]),_:1}),e(N,{label:"数据类型：",prop:"dataType"},{default:t(()=>[e(j,{modelValue:k.dataType,"onUpdate:modelValue":r[1]||(r[1]=J=>k.dataType=J),placeholder:"请选择数据类型",clearable:"",style:{width:"168px"}},{default:t(()=>[e(K,{label:"用户数据",value:"users"}),e(K,{label:"订单数据",value:"orders"}),e(K,{label:"收入数据",value:"revenue"}),e(K,{label:"卡密数据",value:"cards"})]),_:1},8,["modelValue"])]),_:1}),e(N,null,{default:t(()=>[e(q,{type:"primary",onClick:D,loading:_.value},{default:t(()=>[e(g,null,{default:t(()=>[e(b(_e))]),_:1}),r[6]||(r[6]=n(" 查询 ",-1))]),_:1},8,["loading"]),e(q,{plain:"",onClick:z},{default:t(()=>[e(g,null,{default:t(()=>[e(b(re))]),_:1}),r[7]||(r[7]=n(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}},qe=ie(Ot,[["__scopeId","data-v-0de2058d"]]);const Kt={class:"customer-management"},jt={class:"filter-line"},qt={class:"filter-line"},Qt={class:"filter-buttons"},Xt={class:"table-toolbar"},Jt={class:"left"},Gt={style:{display:"flex","align-items":"center",gap:"8px"}},Ht={style:{"font-family":"monospace","font-size":"12px"}},Wt={style:{color:"var(--el-color-primary)","font-weight":"500"}},Zt={class:"pagination-container"},el={class:"dialog-footer"},tl={class:"edit-customer-content"},ll={class:"dialog-footer"},al={class:"pagination-wrapper"},ol={class:"dialog-footer"},nl={class:"adjust-balance-form"},sl={class:"current-balance"},dl={class:"value"},rl={class:"adjust-type"},ul={class:"adjust-amount"},il={class:"result-balance"},cl={class:"value"},ml={class:"dialog-footer"},pl={class:"product-config-content"},fl={class:"customer-info"},_l={class:"product-config-section"},gl={class:"section-header"},vl={style:{color:"var(--el-color-primary)","font-weight":"500"}},bl={class:"drawer-footer"},yl={class:"product-select-content"},wl={class:"dialog-footer"},Vl={__name:"CustomerManagement",setup(ce){const y=p(!1);p(!1);const k=p([]),_=Y({customerId:"",merchantNo:"",customerName:"",customerEmail:"",status:"",dateRange:[]}),D=p([{customerId:"1001",merchantNo:"M17408123456",merchantKey:"test_key_1234567890abcdef1234567890abcdef",customerName:"asd",customerEmail:"123@qq.com",balance:"9.900",status:"active",registerTime:"2025-02-25 00:28:27"},{customerId:"1002",merchantNo:"M17408234567",merchantKey:"test_key_abcdef1234567890abcdef1234567890",customerName:"aaa",customerEmail:"888@gmail.com",balance:"0.000",status:"active",registerTime:"2025-02-25 17:55:35"},{customerId:"1003",merchantNo:"M17408345678",merchantKey:"test_key_9876543210fedcba9876543210fedcba",customerName:"bbb",customerEmail:"999@gmail.com",balance:"0.000",status:"disabled",registerTime:"2025-02-25 18:09:00"}]),z=Y({currentPage:1,pageSize:10,total:3}),w=p(!1),r=p(),g=Y({merchantNo:"",merchantKey:"",customerName:"",customerEmail:"",balance:""}),h={merchantNo:[{required:!0,message:"商户号不能为空",trigger:"blur"}],merchantKey:[{required:!0,message:"商户密钥不能为空",trigger:"blur"}],customerName:[{required:!0,message:"请输入客户昵称",trigger:"blur"}],customerEmail:[{required:!0,message:"请输入客户邮箱",trigger:"blur"}]},i=p(!1),v=p(),F=p(!1),N=Y({customerId:"",customerName:"",customerEmail:"",balance:"",merchantNo:"",merchantKey:"",status:"active"}),K={customerName:[{required:!0,message:"请输入客户昵称",trigger:"blur"}],customerEmail:[{required:!0,message:"请输入客户邮箱",trigger:"blur"}]},j=p(!1),q=p([{operator:"admin",editTime:"2025-02-25 14:32:33",amount:-.1,type:"余额增加或余额扣减"},{operator:"manager",editTime:"2025-02-25 00:28:27",amount:10,type:"新增客户：初始余额"}]),M=Y({currentPage:1,pageSize:10,total:2}),J=p(!1),I=p("9.900"),V=p("increase"),U=p(""),c=Ae(()=>{const u=parseFloat(I.value)||0,l=parseFloat(U.value)||0;return V.value==="increase"?(u+l).toFixed(3):(u-l).toFixed(3)}),T=p(!1),d=p(!1),A=p(!1),Z=p({}),G=p([{id:1,productCode:"CARD001",productName:"产品A-[100]",faceValue:"100.00",discountRate:.95},{id:2,productCode:"CARD002",productName:"产品B-[50]",faceValue:"50.00",discountRate:.9},{id:3,productCode:"CARD003",productName:"产品C-[200]",faceValue:"200.00",discountRate:.88}]),R=p(!1),L=p([]),S=p([]),m=p(!1),te=async()=>{y.value=!0;try{await new Promise(u=>setTimeout(u,500)),f.success("数据已刷新")}finally{y.value=!1}},C=u=>{k.value=u},ee=u=>{const l=new URLSearchParams({merchantNo:u.merchantNo,merchantKey:u.merchantKey,customerName:u.customerName,customerId:u.customerId});window.location.href=`/merchant?${l.toString()}`,f.success(`正在进入 ${u.customerName} 的商户后台系统`)},ne=()=>{const u=Date.now().toString(),l=Math.floor(Math.random()*1e3).toString().padStart(3,"0");g.merchantNo=`M${u.slice(-8)}${l}`},B=()=>{const u="merchant_key_",l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let Q=u;for(let H=0;H<32;H++)Q+=l.charAt(Math.floor(Math.random()*l.length));g.merchantKey=Q},se=async u=>{try{await navigator.clipboard.writeText(u),f.success("商户密钥已复制到剪贴板")}catch{f.error("复制失败，请手动复制")}},x=()=>{w.value=!0,Object.assign(g,{merchantNo:"",merchantKey:"",customerName:"",customerEmail:"",balance:""}),ne(),B()},me=async()=>{try{await r.value.validate(),f.success("新增客户成功"),w.value=!1}catch{}},E=u=>{i.value=!0,Object.assign(N,{customerId:u.customerId,customerName:u.customerName,customerEmail:u.customerEmail,balance:u.balance,merchantNo:u.merchantNo,merchantKey:u.merchantKey,status:u.status||"active"})},ge=async()=>{try{await v.value.validate(),F.value=!0,await new Promise(u=>setTimeout(u,1e3)),f.success("客户信息修改成功"),i.value=!1}catch(u){u!==!1&&f.error("修改失败，请重试")}finally{F.value=!1}},Ue=u=>{fe.confirm(`确认重置客户 "${u.customerName}" 的密钥吗？重置后原密钥将失效。`,"重置密钥确认",{confirmButtonText:"确认重置",cancelButtonText:"取消",type:"warning"}).then(()=>{const l=B();console.log("重置密钥:",{customerId:u.customerId,newKey:l}),fe.alert(`新密钥已生成，请妥善保管：
${l}`,"密钥重置成功",{confirmButtonText:"我已保存",type:"success",showClose:!1,closeOnClickModal:!1,closeOnPressEscape:!1}).then(()=>{te()}),f.success("密钥重置成功")}).catch(()=>{f.info("已取消重置")})},le=u=>{fe.confirm(`确定要删除客户 ${u.customerName} 吗？`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{f.success("删除成功")})},xe=(u,l)=>{switch(u){case"edit":E(l);break;case"productConfig":Te(l);break;case"balance":We();break;case"adjustBalance":Ze(l);break;case"resetKey":Ue(l);break;case"delete":le(l);break}},Te=u=>{Z.value={customerId:u.customerId,customerName:u.customerName,merchantNo:u.merchantNo,customerEmail:u.customerEmail},T.value=!0,ze(u.customerId)},ze=async u=>{d.value=!0;try{await new Promise(l=>setTimeout(l,500)),console.log("加载客户产品配置:",u)}catch{f.error("加载产品配置失败")}finally{d.value=!1}},Re=u=>{console.log("折扣变化:",u.productCode,u.discountRate)},he=async()=>{R.value=!0,await de(),L.value=[]},de=async()=>{m.value=!0;try{await new Promise(l=>setTimeout(l,500));const u=[{productId:"PD1001",productName:"产品A-[10]",faceValue:"10"},{productId:"PD1002",productName:"产品B-[20]",faceValue:"20"},{productId:"PD1003",productName:"产品C-[50]",faceValue:"50"},{productId:"PD1004",productName:"产品D-[20]",faceValue:"20"},{productId:"PD1005",productName:"产品E-[50]",faceValue:"50"}];S.value=u}catch{f.error("获取产品数据失败")}finally{m.value=!1}},Ee=u=>{if(G.value.length<=1){f.warning("至少需要保留一个产品配置");return}G.value.splice(u,1),f.success("产品配置已删除")},Ce=()=>{T.value=!1,Z.value={}},Ne=()=>{R.value=!1,L.value=[]},P=()=>{if(L.value.length===0){f.warning("请至少选择一个产品");return}L.value.forEach(u=>{const l=S.value.find(Q=>Q.productId===u);if(l){const Q={id:Date.now()+Math.random(),productCode:l.productId,productName:l.productName,faceValue:l.faceValue,discountRate:1};G.value.push(Q)}}),f.success(`成功添加 ${L.value.length} 个产品配置`),R.value=!1,L.value=[]},Ie=async()=>{A.value=!0;try{await new Promise(u=>setTimeout(u,1e3)),f.success("产品配置保存成功"),T.value=!1}catch{f.error("保存失败，请重试")}finally{A.value=!1}},We=u=>{j.value=!0},Ze=u=>{J.value=!0,I.value=u?u.balance:N.balance,V.value="increase",U.value=""},et=()=>{f.success("余额调整成功"),N.balance=c.value,J.value=!1},tt=u=>{z.pageSize=u},lt=u=>{z.currentPage=u};return be(()=>{}),(u,l)=>{const Q=a("el-input"),H=a("el-form-item"),Me=a("el-option"),Le=a("el-select"),at=a("el-date-picker"),ae=a("el-icon"),X=a("el-button"),$e=a("el-form"),Be=a("el-card"),W=a("el-table-column"),ot=a("el-tag"),ye=a("el-dropdown-item"),nt=a("el-dropdown-menu"),st=a("el-dropdown"),Fe=a("el-table"),Ye=a("el-pagination"),ke=a("el-dialog"),dt=a("el-switch"),Oe=a("el-radio"),rt=a("el-radio-group"),Pe=a("el-descriptions-item"),ut=a("el-descriptions"),it=a("el-input-number"),ct=a("el-drawer"),Ke=Ve("loading");return O(),ue("div",Kt,[e(Be,{shadow:"never",class:"filter-container"},{default:t(()=>[e($e,{model:_,class:"multi-line-filter-form"},{default:t(()=>[o("div",jt,[e(H,{label:"客户ID：",prop:"customerId"},{default:t(()=>[e(Q,{modelValue:_.customerId,"onUpdate:modelValue":l[0]||(l[0]=s=>_.customerId=s),placeholder:"请输入客户ID",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),e(H,{label:"商户号：",prop:"merchantNo"},{default:t(()=>[e(Q,{modelValue:_.merchantNo,"onUpdate:modelValue":l[1]||(l[1]=s=>_.merchantNo=s),placeholder:"请输入商户号",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),e(H,{label:"昵称：",prop:"customerName"},{default:t(()=>[e(Q,{modelValue:_.customerName,"onUpdate:modelValue":l[2]||(l[2]=s=>_.customerName=s),placeholder:"请输入客户昵称",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),e(H,{label:"邮箱：",prop:"customerEmail"},{default:t(()=>[e(Q,{modelValue:_.customerEmail,"onUpdate:modelValue":l[3]||(l[3]=s=>_.customerEmail=s),placeholder:"请输入客户邮箱",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1})]),o("div",qt,[e(H,{label:"状态：",prop:"status"},{default:t(()=>[e(Le,{modelValue:_.status,"onUpdate:modelValue":l[4]||(l[4]=s=>_.status=s),placeholder:"请选择状态",clearable:"",style:{width:"140px"}},{default:t(()=>[e(Me,{label:"启用",value:"active"}),e(Me,{label:"禁用",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),e(H,{label:"注册时间：",prop:"registerTimeRange"},{default:t(()=>[e(at,{modelValue:_.registerTimeRange,"onUpdate:modelValue":l[5]||(l[5]=s=>_.registerTimeRange=s),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"240px"}},null,8,["modelValue"])]),_:1}),o("div",Qt,[e(X,{type:"primary",onClick:u.handleFilter},{default:t(()=>[e(ae,null,{default:t(()=>[e(b(_e))]),_:1}),l[35]||(l[35]=n(" 查询 ",-1))]),_:1},8,["onClick"]),e(X,{plain:"",onClick:u.resetFilter},{default:t(()=>[e(ae,null,{default:t(()=>[e(b(re))]),_:1}),l[36]||(l[36]=n(" 重置 ",-1))]),_:1},8,["onClick"])])])]),_:1},8,["model"])]),_:1}),e(Be,null,{default:t(()=>[o("div",Xt,[o("div",Jt,[e(X,{type:"primary",onClick:x},{default:t(()=>[e(ae,null,{default:t(()=>[e(b(De))]),_:1}),l[37]||(l[37]=n(" 新增客户 ",-1))]),_:1})])]),ve((O(),oe(Fe,{data:D.value,border:"",stripe:"",onSelectionChange:C,style:{width:"100%"}},{default:t(()=>[e(W,{type:"selection",width:"55"}),e(W,{prop:"customerId",label:"客户ID",width:"100","show-overflow-tooltip":""}),e(W,{prop:"merchantNo",label:"商户号",width:"160","show-overflow-tooltip":""}),e(W,{prop:"merchantKey",label:"商户密钥",width:"240","show-overflow-tooltip":""},{default:t(({row:s})=>[o("div",Gt,[o("span",Ht,$(s.merchantKey),1),e(X,{type:"primary",link:"",size:"small",onClick:pe=>se(s.merchantKey)},{default:t(()=>[e(ae,null,{default:t(()=>[e(b(pt))]),_:1})]),_:2},1032,["onClick"])])]),_:1}),e(W,{prop:"customerName",label:"客户昵称",width:"140","show-overflow-tooltip":""}),e(W,{prop:"customerEmail",label:"客户邮箱",width:"200","show-overflow-tooltip":""}),e(W,{prop:"balance",label:"余额",width:"120",sortable:"",align:"right"},{default:t(({row:s})=>[o("span",Wt,"¥"+$(parseFloat(s.balance).toLocaleString()),1)]),_:1}),e(W,{prop:"status",label:"状态",width:"80",align:"center"},{default:t(({row:s})=>[e(ot,{type:s.status==="active"?"success":"danger"},{default:t(()=>[n($(s.status==="active"?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),e(W,{label:"商户后台",width:"110",align:"center"},{default:t(({row:s})=>[e(X,{link:"",type:"primary",onClick:pe=>ee(s)},{default:t(()=>[e(ae,null,{default:t(()=>[e(b(ft))]),_:1}),l[38]||(l[38]=n(" 进入后台 ",-1))]),_:2},1032,["onClick"])]),_:1}),e(W,{prop:"registerTime",label:"注册时间",width:"160",sortable:""}),e(W,{label:"操作",width:"120",fixed:"right",align:"center"},{default:t(({row:s})=>[e(st,{trigger:"click",onCommand:pe=>xe(pe,s)},{dropdown:t(()=>[e(nt,null,{default:t(()=>[e(ye,{command:"edit"},{default:t(()=>[e(ae,null,{default:t(()=>[e(b(we))]),_:1}),l[40]||(l[40]=n(" 编辑 ",-1))]),_:1}),e(ye,{command:"adjustBalance"},{default:t(()=>[e(ae,null,{default:t(()=>[e(b(we))]),_:1}),l[41]||(l[41]=n(" 余额操作 ",-1))]),_:1}),e(ye,{command:"balance"},{default:t(()=>[e(ae,null,{default:t(()=>[e(b(Je))]),_:1}),l[42]||(l[42]=n(" 余额详情 ",-1))]),_:1}),e(ye,{command:"productConfig"},{default:t(()=>[e(ae,null,{default:t(()=>[e(b(Ge))]),_:1}),l[43]||(l[43]=n(" 产品配置 ",-1))]),_:1}),e(ye,{command:"resetKey"},{default:t(()=>[e(ae,null,{default:t(()=>[e(b(re))]),_:1}),l[44]||(l[44]=n(" 重置密钥 ",-1))]),_:1}),e(ye,{command:"delete",divided:""},{default:t(()=>[e(ae,null,{default:t(()=>[e(b(Se))]),_:1}),l[45]||(l[45]=o("span",{style:{color:"var(--el-color-danger)"}},"删除",-1))]),_:1})]),_:1})]),default:t(()=>[e(X,{text:"",type:"primary",style:{"font-size":"14px"}},{default:t(()=>[l[39]||(l[39]=n(" 操作 ",-1)),e(ae,{class:"el-icon--right"},{default:t(()=>[e(b(He))]),_:1})]),_:1})]),_:2},1032,["onCommand"])]),_:1})]),_:1},8,["data"])),[[Ke,y.value]]),o("div",Zt,[e(Ye,{"current-page":z.currentPage,"onUpdate:currentPage":l[6]||(l[6]=s=>z.currentPage=s),"page-size":z.pageSize,"onUpdate:pageSize":l[7]||(l[7]=s=>z.pageSize=s),"page-sizes":[10,20,50,100],total:z.total,layout:"total, sizes, prev, pager, next",onSizeChange:tt,onCurrentChange:lt},null,8,["current-page","page-size","total"])])]),_:1}),e(ke,{modelValue:w.value,"onUpdate:modelValue":l[14]||(l[14]=s=>w.value=s),title:"新增客户",width:"500px"},{footer:t(()=>[o("div",el,[e(X,{onClick:l[13]||(l[13]=s=>w.value=!1)},{default:t(()=>[...l[47]||(l[47]=[n("取消",-1)])]),_:1}),e(X,{type:"primary",onClick:me},{default:t(()=>[...l[48]||(l[48]=[n("确定",-1)])]),_:1})])]),default:t(()=>[e($e,{ref_key:"addFormRef",ref:r,model:g,rules:h,"label-width":"100px","label-position":"right"},{default:t(()=>[e(H,{label:"商户号",prop:"merchantNo"},{default:t(()=>[e(Q,{modelValue:g.merchantNo,"onUpdate:modelValue":l[8]||(l[8]=s=>g.merchantNo=s),placeholder:"系统自动生成",readonly:"",style:{"background-color":"#ffffff"}},{append:t(()=>[e(X,{onClick:ne,icon:b(re)},null,8,["icon"])]),_:1},8,["modelValue"])]),_:1}),e(H,{label:"商户密钥",prop:"merchantKey"},{default:t(()=>[e(Q,{modelValue:g.merchantKey,"onUpdate:modelValue":l[9]||(l[9]=s=>g.merchantKey=s),placeholder:"系统自动生成",readonly:"",style:{"background-color":"#ffffff"}},{append:t(()=>[e(X,{onClick:B,icon:b(re)},null,8,["icon"])]),_:1},8,["modelValue"])]),_:1}),e(H,{label:"客户昵称",prop:"customerName"},{default:t(()=>[e(Q,{modelValue:g.customerName,"onUpdate:modelValue":l[10]||(l[10]=s=>g.customerName=s),placeholder:"请输入客户昵称",clearable:""},null,8,["modelValue"])]),_:1}),e(H,{label:"客户邮箱",prop:"customerEmail"},{default:t(()=>[e(Q,{modelValue:g.customerEmail,"onUpdate:modelValue":l[11]||(l[11]=s=>g.customerEmail=s),placeholder:"请输入客户邮箱",clearable:""},null,8,["modelValue"])]),_:1}),e(H,{label:"客户余额",prop:"balance"},{default:t(()=>[e(Q,{modelValue:g.balance,"onUpdate:modelValue":l[12]||(l[12]=s=>g.balance=s),placeholder:"请输入初始余额",clearable:""},{append:t(()=>[...l[46]||(l[46]=[n("元",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(ke,{modelValue:i.value,"onUpdate:modelValue":l[22]||(l[22]=s=>i.value=s),title:"编辑客户信息",width:"600px","close-on-click-modal":!1},{footer:t(()=>[o("div",ll,[e(X,{onClick:l[21]||(l[21]=s=>i.value=!1)},{default:t(()=>[...l[49]||(l[49]=[n("取消",-1)])]),_:1}),e(X,{type:"primary",onClick:ge,loading:F.value},{default:t(()=>[...l[50]||(l[50]=[n(" 保存修改 ",-1)])]),_:1},8,["loading"])])]),default:t(()=>[o("div",tl,[e($e,{ref_key:"editFormRef",ref:v,model:N,rules:K,"label-width":"100px","label-position":"right"},{default:t(()=>[e(H,{label:"客户ID"},{default:t(()=>[e(Q,{modelValue:N.customerId,"onUpdate:modelValue":l[15]||(l[15]=s=>N.customerId=s),disabled:"",style:{"background-color":"var(--el-fill-color-light)"}},null,8,["modelValue"])]),_:1}),e(H,{label:"商户号"},{default:t(()=>[e(Q,{modelValue:N.merchantNo,"onUpdate:modelValue":l[16]||(l[16]=s=>N.merchantNo=s),disabled:"",style:{"background-color":"var(--el-fill-color-light)"}},null,8,["modelValue"])]),_:1}),e(H,{label:"密钥"},{default:t(()=>[e(Q,{modelValue:N.merchantKey,"onUpdate:modelValue":l[17]||(l[17]=s=>N.merchantKey=s),disabled:"",style:{"background-color":"var(--el-fill-color-light)"},type:"password","show-password":""},null,8,["modelValue"])]),_:1}),e(H,{label:"客户昵称",prop:"customerName"},{default:t(()=>[e(Q,{modelValue:N.customerName,"onUpdate:modelValue":l[18]||(l[18]=s=>N.customerName=s),placeholder:"请输入客户昵称",clearable:"","prefix-icon":b(we)},null,8,["modelValue","prefix-icon"])]),_:1}),e(H,{label:"客户邮箱",prop:"customerEmail"},{default:t(()=>[e(Q,{modelValue:N.customerEmail,"onUpdate:modelValue":l[19]||(l[19]=s=>N.customerEmail=s),placeholder:"请输入客户邮箱",clearable:"",type:"email"},null,8,["modelValue"])]),_:1}),e(H,{label:"状态"},{default:t(()=>[e(dt,{modelValue:N.status,"onUpdate:modelValue":l[20]||(l[20]=s=>N.status=s),"active-text":"启用","inactive-text":"禁用","active-value":"active","inactive-value":"inactive",style:{"--el-switch-on-color":"var(--el-color-primary)","--el-switch-off-color":"var(--el-color-info)"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),e(ke,{modelValue:j.value,"onUpdate:modelValue":l[27]||(l[27]=s=>j.value=s),title:"余额详情",width:"900px"},{footer:t(()=>[o("div",ol,[e(X,{onClick:l[25]||(l[25]=s=>j.value=!1)},{default:t(()=>[...l[51]||(l[51]=[n("取消",-1)])]),_:1}),e(X,{type:"primary",onClick:l[26]||(l[26]=s=>j.value=!1)},{default:t(()=>[...l[52]||(l[52]=[n("确定",-1)])]),_:1})])]),default:t(()=>[e(Fe,{data:q.value,border:"",stripe:""},{default:t(()=>[e(W,{prop:"operator",label:"操作人",width:"120"}),e(W,{prop:"editTime",label:"编辑时间",width:"180"}),e(W,{prop:"amount",label:"数额",width:"120"},{default:t(({row:s})=>[o("span",{class:_t(s.amount>0?"amount-positive":"amount-negative")},$(s.amount>0?"+":"")+$(s.amount),3)]),_:1}),e(W,{prop:"type",label:"类型","min-width":"200"})]),_:1},8,["data"]),o("div",al,[e(Ye,{"current-page":M.currentPage,"onUpdate:currentPage":l[23]||(l[23]=s=>M.currentPage=s),"page-size":M.pageSize,"onUpdate:pageSize":l[24]||(l[24]=s=>M.pageSize=s),"page-sizes":[10,20,50],total:M.total,layout:"total, sizes, prev, pager, next"},null,8,["current-page","page-size","total"])])]),_:1},8,["modelValue"]),e(ke,{modelValue:J.value,"onUpdate:modelValue":l[31]||(l[31]=s=>J.value=s),title:"余额调整",width:"500px"},{footer:t(()=>[o("div",ml,[e(X,{onClick:l[30]||(l[30]=s=>J.value=!1)},{default:t(()=>[...l[60]||(l[60]=[n("取消",-1)])]),_:1}),e(X,{type:"primary",onClick:et},{default:t(()=>[...l[61]||(l[61]=[n("确定",-1)])]),_:1})])]),default:t(()=>[o("div",nl,[o("div",sl,[l[53]||(l[53]=o("span",{class:"label"},"当前余额:",-1)),o("span",dl,$(I.value)+"元",1)]),o("div",rl,[l[56]||(l[56]=o("span",{class:"label"},"余额增减:",-1)),e(rt,{modelValue:V.value,"onUpdate:modelValue":l[28]||(l[28]=s=>V.value=s)},{default:t(()=>[e(Oe,{value:"increase"},{default:t(()=>[...l[54]||(l[54]=[n("余额增加",-1)])]),_:1}),e(Oe,{value:"decrease"},{default:t(()=>[...l[55]||(l[55]=[n("余额减少",-1)])]),_:1})]),_:1},8,["modelValue"])]),o("div",ul,[l[58]||(l[58]=o("span",{class:"label"},"修改数额:",-1)),e(Q,{modelValue:U.value,"onUpdate:modelValue":l[29]||(l[29]=s=>U.value=s),placeholder:"请输入",style:{width:"200px"},clearable:""},{append:t(()=>[...l[57]||(l[57]=[n("元",-1)])]),_:1},8,["modelValue"])]),o("div",il,[l[59]||(l[59]=o("span",{class:"label"},"修改后余额:",-1)),o("span",cl,$(c.value)+"元",1)])])]),_:1},8,["modelValue"]),e(ct,{modelValue:T.value,"onUpdate:modelValue":l[32]||(l[32]=s=>T.value=s),title:"产品配置",direction:"rtl",size:"60%","before-close":Ce},{footer:t(()=>[o("div",bl,[e(X,{onClick:Ce},{default:t(()=>[...l[66]||(l[66]=[n("取消",-1)])]),_:1}),e(X,{type:"primary",onClick:Ie,loading:A.value},{default:t(()=>[...l[67]||(l[67]=[n(" 保存配置 ",-1)])]),_:1},8,["loading"])])]),default:t(()=>[o("div",pl,[o("div",fl,[l[62]||(l[62]=o("h4",null,"客户信息",-1)),e(ut,{column:2,border:""},{default:t(()=>[e(Pe,{label:"客户ID"},{default:t(()=>[n($(Z.value.customerId),1)]),_:1}),e(Pe,{label:"客户昵称"},{default:t(()=>[n($(Z.value.customerName),1)]),_:1}),e(Pe,{label:"商户号"},{default:t(()=>[n($(Z.value.merchantNo),1)]),_:1}),e(Pe,{label:"客户邮箱"},{default:t(()=>[n($(Z.value.customerEmail),1)]),_:1})]),_:1})]),o("div",_l,[o("div",gl,[l[64]||(l[64]=o("h4",null,"卡密产品配置",-1)),e(X,{type:"primary",icon:b(De),onClick:he},{default:t(()=>[...l[63]||(l[63]=[n(" 新增产品 ",-1)])]),_:1},8,["icon"])]),ve((O(),oe(Fe,{data:G.value,border:"",stripe:"",style:{width:"100%"}},{default:t(()=>[e(W,{prop:"productCode",label:"产品编码",width:"120"}),e(W,{prop:"productName",label:"产品名称","min-width":"150"}),e(W,{prop:"faceValue",label:"面值",width:"100",align:"right"},{default:t(({row:s})=>[o("span",null,"¥"+$(parseFloat(s.faceValue).toLocaleString()),1)]),_:1}),e(W,{label:"折扣比例",width:"150",align:"center"},{default:t(({row:s})=>[e(it,{modelValue:s.discountRate,"onUpdate:modelValue":pe=>s.discountRate=pe,min:0,max:1,step:.01,precision:2,size:"small",style:{width:"120px"},onChange:pe=>Re(s)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),e(W,{label:"扣款价格",width:"120",align:"right"},{default:t(({row:s})=>[o("span",vl," ¥"+$((parseFloat(s.faceValue)*s.discountRate).toFixed(2)),1)]),_:1}),e(W,{label:"操作",width:"80",align:"center"},{default:t(({row:s,$index:pe})=>[e(X,{type:"danger",link:"",icon:b(Se),onClick:Da=>Ee(pe),size:"small"},{default:t(()=>[...l[65]||(l[65]=[n(" 删除 ",-1)])]),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[Ke,d.value]])])])]),_:1},8,["modelValue"]),e(ke,{modelValue:R.value,"onUpdate:modelValue":l[34]||(l[34]=s=>R.value=s),title:"选择产品",width:"500px","before-close":Ne},{footer:t(()=>[o("div",wl,[e(X,{onClick:Ne},{default:t(()=>[...l[68]||(l[68]=[n("取消",-1)])]),_:1}),e(X,{type:"primary",onClick:P,disabled:L.value.length===0},{default:t(()=>[n(" 确认选择 ("+$(L.value.length)+") ",1)]),_:1},8,["disabled"])])]),default:t(()=>[o("div",yl,[e($e,{"label-width":"80px"},{default:t(()=>[e(H,{label:"选择产品："},{default:t(()=>[e(Le,{modelValue:L.value,"onUpdate:modelValue":l[33]||(l[33]=s=>L.value=s),multiple:"",filterable:"",placeholder:"请选择产品",style:{width:"100%"},loading:m.value},{default:t(()=>[(O(!0),ue(gt,null,vt(S.value,s=>(O(),oe(Me,{key:s.productId,label:`${s.productName} - ¥${s.faceValue}`,value:s.productId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1})]),_:1})])]),_:1},8,["modelValue"])])}}},hl=ie(Vl,[["__scopeId","data-v-27dc2f73"]]);const Cl={class:"product-management"},kl={class:"filter-line"},Sl={class:"filter-line"},xl={class:"filter-buttons"},Nl={class:"table-toolbar"},Il={class:"left"},$l={style:{color:"var(--el-color-primary)","font-weight":"500"}},Pl={class:"operation-buttons"},Dl={class:"pagination-container"},Ul={class:"dialog-footer"},Tl={class:"dialog-footer"},zl={__name:"CardManagement",setup(ce){const y=p(!1),k=p(!1),_=Y({productId:"",productName:""}),D=p([{productId:"PD1001",productName:"电话卡套餐A",faceValue:"10",productLink:"xxxxxx",soldCount:"1 / 1",createTime:"2025-02-25 14:32:33"},{productId:"PD1002",productName:"流量卡套餐B",faceValue:"20",productLink:"www.baidu.com",soldCount:"0 / 100",createTime:"2025-02-25 18:08:34"},{productId:"PD1003",productName:"游戏卡套餐C",faceValue:"50",productLink:"www",soldCount:"0 / 100",createTime:"2025-02-25 18:09:54"}]),z=Y({currentPage:1,pageSize:10,total:3}),w=p(!1),r=p(),g=Y({productName:"",faceValue:"10"}),h={productName:[{required:!0,message:"请输入产品名称",trigger:"blur"}],faceValue:[{required:!0,message:"请选择商品面值",trigger:"change"}]},i=p(!1),v=p(),F=Y({productId:"",productName:"",faceValue:"10"}),N={faceValue:[{required:!0,message:"请选择商品面值",trigger:"change"}]},K=()=>{},j=()=>{Object.assign(_,{productId:"",productName:""})},q=()=>{w.value=!0,Object.assign(g,{productName:"",faceValue:"10"})},M=async()=>{try{await r.value.validate(),f.success("新建产品成功"),w.value=!1}catch{}},J=T=>{i.value=!0,Object.assign(F,{productId:T.productId,productName:T.productName,faceValue:T.faceValue})},I=async()=>{try{await v.value.validate(),f.success("编辑产品成功"),i.value=!1}catch{}},V=T=>{f.success("删除成功")},U=T=>{z.pageSize=T},c=T=>{z.currentPage=T};return be(()=>{}),(T,d)=>{const A=a("el-input"),Z=a("el-form-item"),G=a("el-icon"),R=a("el-button"),L=a("el-form"),S=a("el-card"),m=a("el-table-column"),te=a("el-popconfirm"),C=a("el-table"),ee=a("el-pagination"),ne=a("el-divider"),B=a("el-radio"),se=a("el-radio-group"),x=a("el-dialog"),me=Ve("loading");return O(),ue("div",Cl,[e(S,{shadow:"never",class:"filter-container"},{default:t(()=>[e(L,{model:_,class:"multi-line-filter-form"},{default:t(()=>[o("div",kl,[e(Z,{label:"产品编码：",prop:"productId"},{default:t(()=>[e(A,{modelValue:_.productId,"onUpdate:modelValue":d[0]||(d[0]=E=>_.productId=E),placeholder:"请输入产品编码",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(Z,{label:"产品名称：",prop:"productName"},{default:t(()=>[e(A,{modelValue:_.productName,"onUpdate:modelValue":d[1]||(d[1]=E=>_.productName=E),placeholder:"请输入产品名称",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1})]),o("div",Sl,[o("div",xl,[e(R,{type:"primary",onClick:K,loading:k.value},{default:t(()=>[e(G,null,{default:t(()=>[e(b(_e))]),_:1}),d[12]||(d[12]=n(" 查询 ",-1))]),_:1},8,["loading"]),e(R,{plain:"",onClick:j},{default:t(()=>[e(G,null,{default:t(()=>[e(b(re))]),_:1}),d[13]||(d[13]=n(" 重置 ",-1))]),_:1})])])]),_:1},8,["model"])]),_:1}),e(S,null,{default:t(()=>[o("div",Nl,[o("div",Il,[e(R,{type:"primary",icon:b(De),onClick:q},{default:t(()=>[...d[14]||(d[14]=[n("新建产品",-1)])]),_:1},8,["icon"])])]),ve((O(),oe(C,{data:D.value,style:{width:"100%"}},{default:t(()=>[e(m,{prop:"productId",label:"产品编码",width:"120"}),e(m,{prop:"productName",label:"产品名称","min-width":"150"},{default:t(({row:E,$index:ge})=>[o("span",null,"产品"+$(String.fromCharCode(65+ge))+"-["+$(E.faceValue)+"]",1)]),_:1}),e(m,{prop:"faceValue",label:"面值",width:"100",align:"center"},{default:t(({row:E})=>[o("span",$l,$(E.faceValue)+"元",1)]),_:1}),e(m,{prop:"createTime",label:"创建时间",width:"160"}),e(m,{label:"操作",width:"160",fixed:"right"},{default:t(({row:E})=>[o("div",Pl,[e(R,{link:"",type:"primary",icon:b(we),onClick:ge=>J(E)},{default:t(()=>[...d[15]||(d[15]=[n("编辑",-1)])]),_:2},1032,["icon","onClick"]),e(te,{title:"请解绑所有关联此产品的商户后操作",onConfirm:ge=>V(E)},{reference:t(()=>[e(R,{link:"",type:"danger",icon:b(Se)},{default:t(()=>[...d[16]||(d[16]=[n("删除",-1)])]),_:1},8,["icon"])]),_:2},1032,["onConfirm"])])]),_:1})]),_:1},8,["data"])),[[me,y.value]]),o("div",Dl,[e(ee,{"current-page":z.currentPage,"onUpdate:currentPage":d[2]||(d[2]=E=>z.currentPage=E),"page-size":z.pageSize,"onUpdate:pageSize":d[3]||(d[3]=E=>z.pageSize=E),"page-sizes":[10,20,50,100],total:z.total,layout:"total, sizes, prev, pager, next",onSizeChange:U,onCurrentChange:c},null,8,["current-page","page-size","total"])])]),_:1}),e(x,{modelValue:w.value,"onUpdate:modelValue":d[7]||(d[7]=E=>w.value=E),title:"新建产品",width:"600px"},{footer:t(()=>[o("div",Ul,[e(R,{onClick:d[6]||(d[6]=E=>w.value=!1)},{default:t(()=>[...d[26]||(d[26]=[n("取消",-1)])]),_:1}),e(R,{type:"primary",onClick:M},{default:t(()=>[...d[27]||(d[27]=[n("确定",-1)])]),_:1})])]),default:t(()=>[e(L,{ref_key:"addFormRef",ref:r,model:g,rules:h,"label-width":"100px","label-position":"right"},{default:t(()=>[e(ne,{"content-position":"left"},{default:t(()=>[...d[17]||(d[17]=[n("产品信息",-1)])]),_:1}),e(Z,{label:"产品名称",prop:"productName"},{default:t(()=>[e(A,{modelValue:g.productName,"onUpdate:modelValue":d[4]||(d[4]=E=>g.productName=E),placeholder:"请输入产品名称",clearable:""},null,8,["modelValue"])]),_:1}),e(ne,{"content-position":"left"},{default:t(()=>[...d[18]||(d[18]=[n("商品面值",-1)])]),_:1}),e(Z,{label:"商品面值",prop:"faceValue"},{default:t(()=>[e(se,{modelValue:g.faceValue,"onUpdate:modelValue":d[5]||(d[5]=E=>g.faceValue=E)},{default:t(()=>[e(B,{value:"10"},{default:t(()=>[...d[19]||(d[19]=[n("10元",-1)])]),_:1}),e(B,{value:"20"},{default:t(()=>[...d[20]||(d[20]=[n("20元",-1)])]),_:1}),e(B,{value:"30"},{default:t(()=>[...d[21]||(d[21]=[n("30元",-1)])]),_:1}),e(B,{value:"50"},{default:t(()=>[...d[22]||(d[22]=[n("50元",-1)])]),_:1}),e(B,{value:"100"},{default:t(()=>[...d[23]||(d[23]=[n("100元",-1)])]),_:1}),e(B,{value:"200"},{default:t(()=>[...d[24]||(d[24]=[n("200元",-1)])]),_:1}),e(B,{value:"300"},{default:t(()=>[...d[25]||(d[25]=[n("300元",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(x,{modelValue:i.value,"onUpdate:modelValue":d[11]||(d[11]=E=>i.value=E),title:"编辑产品",width:"500px"},{footer:t(()=>[o("div",Tl,[e(R,{onClick:d[10]||(d[10]=E=>i.value=!1)},{default:t(()=>[...d[35]||(d[35]=[n("取消",-1)])]),_:1}),e(R,{type:"primary",onClick:I},{default:t(()=>[...d[36]||(d[36]=[n("确定",-1)])]),_:1})])]),default:t(()=>[e(L,{ref_key:"editFormRef",ref:v,model:F,rules:N,"label-width":"100px","label-position":"right"},{default:t(()=>[e(Z,{label:"产品编码",prop:"productId"},{default:t(()=>[e(A,{modelValue:F.productId,"onUpdate:modelValue":d[8]||(d[8]=E=>F.productId=E),placeholder:"产品编码",readonly:"",disabled:""},null,8,["modelValue"])]),_:1}),e(Z,{label:"产品面值",prop:"faceValue"},{default:t(()=>[e(se,{modelValue:F.faceValue,"onUpdate:modelValue":d[9]||(d[9]=E=>F.faceValue=E)},{default:t(()=>[e(B,{value:"10"},{default:t(()=>[...d[28]||(d[28]=[n("10元",-1)])]),_:1}),e(B,{value:"20"},{default:t(()=>[...d[29]||(d[29]=[n("20元",-1)])]),_:1}),e(B,{value:"30"},{default:t(()=>[...d[30]||(d[30]=[n("30元",-1)])]),_:1}),e(B,{value:"50"},{default:t(()=>[...d[31]||(d[31]=[n("50元",-1)])]),_:1}),e(B,{value:"100"},{default:t(()=>[...d[32]||(d[32]=[n("100元",-1)])]),_:1}),e(B,{value:"200"},{default:t(()=>[...d[33]||(d[33]=[n("200元",-1)])]),_:1}),e(B,{value:"300"},{default:t(()=>[...d[34]||(d[34]=[n("300元",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},Rl=ie(zl,[["__scopeId","data-v-96f18504"]]);const El={class:"order-management"},Ml={class:"filter-line"},Fl={class:"filter-line"},Al={class:"filter-buttons"},Ll={class:"table-toolbar"},Bl={class:"customer-info"},Yl={class:"customer-id"},Ol={class:"customer-email"},Kl={style:{color:"var(--el-color-primary)","font-weight":"500"}},jl={class:"pagination-container"},ql={key:0},Ql={class:"dialog-footer"},Xl={class:"dialog-footer"},Jl={__name:"OrderManagement",setup(ce){const y=p(!1),k=p(!1),_=p(!1),D=p(!1),z=p(!1),w=p(null),r=p(null),g=p([]),h=Y({orderNumber:"",customerId:"",customerEmail:"",orderStatus:"",orderValue:"",cardNumber:"",dateRange:[]}),i=Y({currentPage:1,pageSize:10,total:3}),v=Y({orderNumber:"",orderStatus:"",remark:""}),F={orderStatus:[{required:!0,message:"请选择订单状态",trigger:"change"}]},N=p([{orderId:"1001",orderNumber:"ORD202502251001",customerId:"1001",customerEmail:"user1@example.com",productName:"电话卡",orderAmount:"10.00",orderStatus:"completed",cardPackage:"test",createTime:"2025-02-25 18:30:15"},{orderId:"1002",orderNumber:"ORD202502251002",customerId:"1002",customerEmail:"user2@example.com",productName:"电话卡",orderAmount:"20.00",orderStatus:"paid",cardPackage:"test2",createTime:"2025-02-25 18:25:30"},{orderId:"1003",orderNumber:"ORD202502251003",customerId:"1003",customerEmail:"user3@example.com",productName:"电话卡",orderAmount:"50.00",orderStatus:"pending",cardPackage:"test3",createTime:"2025-02-25 18:20:45"}]);i.total=N.value.length;const K=S=>({pending:"warning",paid:"info",completed:"success",cancelled:"danger"})[S]||"info",j=S=>({pending:"待支付",paid:"已支付",completed:"已完成",cancelled:"已取消"})[S]||"未知",q=async()=>{k.value=!0;try{await new Promise(S=>setTimeout(S,800)),f.success("查询成功")}catch{f.error("查询失败，请重试")}finally{k.value=!1}},M=()=>{Object.keys(h).forEach(S=>{S==="dateRange"?h[S]=[]:h[S]=""}),f.info("筛选条件已重置")},J=()=>{Object.assign(v,{orderNumber:"",orderStatus:"",remark:""}),D.value=!0},I=async()=>{y.value=!0;try{await new Promise(S=>setTimeout(S,500)),f.success("数据已刷新")}finally{y.value=!1}},V=S=>{g.value=S},U=S=>{w.value={...S},_.value=!0},c=S=>{w.value={...S},v.orderNumber=S.orderNumber,v.orderStatus=S.orderStatus,v.remark="",D.value=!0},T=()=>{w.value&&(Object.assign(v,{orderNumber:w.value.orderNumber,orderStatus:w.value.orderStatus,remark:""}),_.value=!1,D.value=!0)},d=async S=>{try{f.success("订单删除成功")}catch{f.error("删除失败，请重试")}},A=()=>{_.value=!1,w.value=null},Z=()=>{D.value=!1,w.value=null,r.value&&r.value.resetFields()},G=async()=>{if(r.value)try{await r.value.validate(),z.value=!0,await new Promise(m=>setTimeout(m,1e3)),D.value=!1;const S=v.orderNumber?"更新":"创建";f.success(`订单${S}成功`),r.value&&r.value.resetFields()}catch{}finally{z.value=!1}},R=S=>{i.pageSize=S,i.currentPage=1,q()},L=S=>{i.currentPage=S,q()};return be(()=>{q()}),(S,m)=>{const te=a("el-input"),C=a("el-form-item"),ee=a("el-option"),ne=a("el-select"),B=a("el-date-picker"),se=a("el-icon"),x=a("el-button"),me=a("el-form"),E=a("el-card"),ge=a("el-space"),Ue=a("el-tooltip"),le=a("el-table-column"),xe=a("el-tag"),Te=a("el-popconfirm"),ze=a("el-table"),Re=a("el-pagination"),he=a("el-text"),de=a("el-descriptions-item"),Ee=a("el-descriptions"),Ce=a("el-dialog"),Ne=Ve("loading");return O(),ue("div",El,[e(E,{shadow:"never",class:"filter-container"},{default:t(()=>[e(me,{model:h,inline:"",class:"multi-line-filter-form"},{default:t(()=>[o("div",Ml,[e(C,{label:"订单编号：",prop:"orderNumber"},{default:t(()=>[e(te,{modelValue:h.orderNumber,"onUpdate:modelValue":m[0]||(m[0]=P=>h.orderNumber=P),placeholder:"请输入订单编号",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(C,{label:"客户ID：",prop:"customerId"},{default:t(()=>[e(te,{modelValue:h.customerId,"onUpdate:modelValue":m[1]||(m[1]=P=>h.customerId=P),placeholder:"请输入客户ID",clearable:"",style:{width:"168px"}},null,8,["modelValue"])]),_:1}),e(C,{label:"客户邮箱：",prop:"customerEmail"},{default:t(()=>[e(te,{modelValue:h.customerEmail,"onUpdate:modelValue":m[2]||(m[2]=P=>h.customerEmail=P),placeholder:"请输入客户邮箱",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1})]),o("div",Fl,[e(C,{label:"订单状态：",prop:"orderStatus"},{default:t(()=>[e(ne,{modelValue:h.orderStatus,"onUpdate:modelValue":m[3]||(m[3]=P=>h.orderStatus=P),placeholder:"请选择状态",clearable:"",style:{width:"168px"}},{default:t(()=>[e(ee,{label:"全部",value:""}),e(ee,{label:"待支付",value:"pending"}),e(ee,{label:"已支付",value:"paid"}),e(ee,{label:"已完成",value:"completed"}),e(ee,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),e(C,{label:"创建时间：",prop:"dateRange"},{default:t(()=>[e(B,{modelValue:h.dateRange,"onUpdate:modelValue":m[4]||(m[4]=P=>h.dateRange=P),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"240px"}},null,8,["modelValue"])]),_:1}),o("div",Al,[e(x,{type:"primary",onClick:q,loading:k.value},{default:t(()=>[e(se,null,{default:t(()=>[e(b(_e))]),_:1}),m[12]||(m[12]=n(" 查询 ",-1))]),_:1},8,["loading"]),e(x,{plain:"",onClick:M},{default:t(()=>[e(se,null,{default:t(()=>[e(b(re))]),_:1}),m[13]||(m[13]=n(" 重置 ",-1))]),_:1})])])]),_:1},8,["model"])]),_:1}),e(E,null,{default:t(()=>[o("div",Ll,[e(ge,null,{default:t(()=>[e(x,{type:"primary",onClick:J},{default:t(()=>[e(se,null,{default:t(()=>[e(b(De))]),_:1}),m[14]||(m[14]=n(" 新增订单 ",-1))]),_:1})]),_:1}),e(Ue,{content:"刷新数据"},{default:t(()=>[e(x,{circle:"",onClick:I,loading:y.value},{default:t(()=>[e(se,null,{default:t(()=>[e(b(re))]),_:1})]),_:1},8,["loading"])]),_:1})]),ve((O(),oe(ze,{data:N.value,border:"",stripe:"",onSelectionChange:V,style:{width:"100%"}},{default:t(()=>[e(le,{type:"selection",width:"55"}),e(le,{prop:"orderId",label:"订单ID",width:"90","show-overflow-tooltip":""}),e(le,{prop:"orderNumber",label:"订单编号",width:"160","show-overflow-tooltip":""}),e(le,{prop:"customerInfo",label:"客户信息",width:"180"},{default:t(({row:P})=>[o("div",Bl,[o("div",Yl,"ID: "+$(P.customerId),1),o("div",Ol,$(P.customerEmail),1)])]),_:1}),e(le,{prop:"productName",label:"商品名称",width:"120","show-overflow-tooltip":""}),e(le,{prop:"orderAmount",label:"订单金额",width:"110",sortable:"",align:"right"},{default:t(({row:P})=>[o("span",Kl,"¥"+$(parseFloat(P.orderAmount).toLocaleString()),1)]),_:1}),e(le,{prop:"orderStatus",label:"订单状态",width:"90",align:"center"},{default:t(({row:P})=>[e(xe,{type:K(P.orderStatus)},{default:t(()=>[n($(j(P.orderStatus)),1)]),_:2},1032,["type"])]),_:1}),e(le,{prop:"cardPackage",label:"卡包信息",width:"120","show-overflow-tooltip":""}),e(le,{prop:"createTime",label:"下单时间",width:"160",sortable:""}),e(le,{label:"操作",width:"220",fixed:"right"},{default:t(({row:P})=>[e(x,{link:"",icon:b(bt),onClick:Ie=>U(P)},{default:t(()=>[...m[15]||(m[15]=[n("查看",-1)])]),_:2},1032,["icon","onClick"]),e(x,{link:"",type:"primary",icon:b(we),onClick:Ie=>c(P)},{default:t(()=>[...m[16]||(m[16]=[n("编辑",-1)])]),_:2},1032,["icon","onClick"]),e(Te,{title:"确认删除该订单？",onConfirm:Ie=>d(P),"confirm-button-text":"确定","cancel-button-text":"取消"},{reference:t(()=>[e(x,{link:"",type:"danger",icon:b(Se)},{default:t(()=>[...m[17]||(m[17]=[n("删除",-1)])]),_:1},8,["icon"])]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[Ne,y.value]]),o("div",jl,[e(Re,{"current-page":i.currentPage,"onUpdate:currentPage":m[5]||(m[5]=P=>i.currentPage=P),"page-size":i.pageSize,"onUpdate:pageSize":m[6]||(m[6]=P=>i.pageSize=P),"page-sizes":[10,20,50,100],total:i.total,layout:"total, sizes, prev, pager, next",onSizeChange:R,onCurrentChange:L},null,8,["current-page","page-size","total"])])]),_:1}),e(Ce,{modelValue:_.value,"onUpdate:modelValue":m[7]||(m[7]=P=>_.value=P),title:"订单详情",width:"700px","before-close":A,"destroy-on-close":""},{footer:t(()=>[o("div",Ql,[e(x,{onClick:A},{default:t(()=>[...m[18]||(m[18]=[n("关闭",-1)])]),_:1}),e(x,{type:"primary",onClick:T},{default:t(()=>[...m[19]||(m[19]=[n("编辑订单",-1)])]),_:1})])]),default:t(()=>[w.value?(O(),ue("div",ql,[e(Ee,{column:2,border:""},{default:t(()=>[e(de,{label:"订单ID"},{default:t(()=>[e(he,{tag:"b"},{default:t(()=>[n($(w.value.orderId),1)]),_:1})]),_:1}),e(de,{label:"订单编号"},{default:t(()=>[e(he,{tag:"b"},{default:t(()=>[n($(w.value.orderNumber),1)]),_:1})]),_:1}),e(de,{label:"客户ID"},{default:t(()=>[n($(w.value.customerId),1)]),_:1}),e(de,{label:"客户邮箱"},{default:t(()=>[n($(w.value.customerEmail),1)]),_:1}),e(de,{label:"商品名称"},{default:t(()=>[n($(w.value.productName),1)]),_:1}),e(de,{label:"订单金额"},{default:t(()=>[e(he,{type:"primary",size:"large",tag:"b"},{default:t(()=>[n("¥"+$(parseFloat(w.value.orderAmount).toLocaleString()),1)]),_:1})]),_:1}),e(de,{label:"订单状态"},{default:t(()=>[e(xe,{type:K(w.value.orderStatus),size:"large"},{default:t(()=>[n($(j(w.value.orderStatus)),1)]),_:1},8,["type"])]),_:1}),e(de,{label:"卡包信息"},{default:t(()=>[n($(w.value.cardPackage),1)]),_:1}),e(de,{label:"下单时间",span:2},{default:t(()=>[n($(w.value.createTime),1)]),_:1})]),_:1})])):je("",!0)]),_:1},8,["modelValue"]),e(Ce,{modelValue:D.value,"onUpdate:modelValue":m[11]||(m[11]=P=>D.value=P),title:v.orderNumber?"编辑订单":"新增订单",width:"600px","before-close":Z,"destroy-on-close":""},{footer:t(()=>[o("div",Xl,[e(x,{onClick:Z},{default:t(()=>[...m[20]||(m[20]=[n("取消",-1)])]),_:1}),e(x,{type:"primary",onClick:G,loading:z.value},{default:t(()=>[n($(v.orderNumber?"保存":"创建"),1)]),_:1},8,["loading"])])]),default:t(()=>[e(me,{ref_key:"editFormRef",ref:r,model:v,rules:F,"label-width":"100px","label-position":"right"},{default:t(()=>[v.orderNumber?(O(),oe(C,{key:0,label:"订单编号",prop:"orderNumber"},{default:t(()=>[e(te,{modelValue:v.orderNumber,"onUpdate:modelValue":m[8]||(m[8]=P=>v.orderNumber=P),disabled:""},null,8,["modelValue"])]),_:1})):je("",!0),e(C,{label:"订单状态",prop:"orderStatus",required:""},{default:t(()=>[e(ne,{modelValue:v.orderStatus,"onUpdate:modelValue":m[9]||(m[9]=P=>v.orderStatus=P),placeholder:"请选择状态",style:{width:"100%"}},{default:t(()=>[e(ee,{label:"待支付",value:"pending"}),e(ee,{label:"已支付",value:"paid"}),e(ee,{label:"已完成",value:"completed"}),e(ee,{label:"已取消",value:"cancelled"})]),_:1},8,["modelValue"])]),_:1}),e(C,{label:"备注",prop:"remark"},{default:t(()=>[e(te,{modelValue:v.remark,"onUpdate:modelValue":m[10]||(m[10]=P=>v.remark=P),type:"textarea",rows:4,placeholder:"请输入备注信息",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},Gl=ie(Jl,[["__scopeId","data-v-04b8a695"]]);const Hl={class:"card-query"},Wl={class:"filter-line"},Zl={class:"filter-line"},ea={class:"filter-buttons"},ta={class:"table-toolbar"},la={class:"left"},aa={class:"right"},oa={class:"selected-info"},na={style:{color:"var(--el-color-warning)","font-weight":"500"}},sa={class:"pagination-container"},da={__name:"CardQuery",setup(ce){const y=Y({cardSecret:"",cardId:"",status:"",verificationStatus:"",lockStatus:""}),k=p([]),_=Ae(()=>k.value.some(I=>I.lockStatus==="正常")),D=Ae(()=>k.value.some(I=>I.lockStatus==="已锁定")),z=p([{cardNumber:"939684006576672442",password:"p60wXO8T",orderNumber:"sf174047748858929",customerId:"1001",status:"已使用",verificationStatus:"已核销",lockStatus:"正常",productValue:"10",createTime:"2025-02-25 17:59:20"},{cardNumber:"736779794793920531",password:"pXSi3Y20",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"正常",productValue:"10",createTime:"2025-02-25 17:58:15"},{cardNumber:"679706886397601293",password:"ASXKK8D7",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"已锁定",productValue:"10",createTime:"2025-02-25 17:57:42"},{cardNumber:"762829251215552704",password:"XmJUg6eO",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"正常",productValue:"10",createTime:"2025-02-25 17:57:18"},{cardNumber:"332906932136546258",password:"jzWOEfI",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"正常",productValue:"10",createTime:"2025-02-25 17:56:54"},{cardNumber:"613038240784082504",password:"E8ca7Mpw",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"已锁定",productValue:"10",createTime:"2025-02-25 17:56:31"},{cardNumber:"550864709398981014",password:"jMSMZj2",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"正常",productValue:"10",createTime:"2025-02-25 17:56:08"},{cardNumber:"752222246573346743",password:"DXE7gTt8",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"正常",productValue:"10",createTime:"2025-02-25 17:55:44"},{cardNumber:"688099941296756970",password:"Mre8h3Mc",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"正常",productValue:"10",createTime:"2025-02-25 17:55:21"}]),w=p(!1),r=Y({currentPage:1,pageSize:10,total:201}),g=()=>{w.value=!0,setTimeout(()=>{w.value=!1},1e3)},h=()=>{Object.keys(y).forEach(I=>{y[I]=""}),g()},i=I=>{r.pageSize=I,r.currentPage=1,g()},v=I=>{r.currentPage=I,g()},F=I=>{k.value=I},N=()=>{const I=k.value.filter(V=>V.lockStatus==="正常");if(I.length===0){f.warning("请选择未锁定的卡密");return}fe.confirm(`确认锁定选中的 ${I.length} 张卡密？`,"批量锁卡",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{I.forEach(V=>{V.lockStatus="已锁定"}),f.success(`成功锁定 ${I.length} 张卡密`)}).catch(()=>{f.info("已取消操作")})},K=()=>{const I=k.value.filter(V=>V.lockStatus==="已锁定");if(I.length===0){f.warning("请选择已锁定的卡密");return}fe.confirm(`确认解锁选中的 ${I.length} 张卡密？`,"批量解锁",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{I.forEach(V=>{V.lockStatus="正常"}),f.success(`成功解锁 ${I.length} 张卡密`)}).catch(()=>{f.info("已取消操作")})},j=()=>{if(k.value.length===0){f.warning("请选择要导出的数据");return}f.success(`正在导出 ${k.value.length} 条数据...`)},q=I=>{f.info(`查看卡号 ${I.cardNumber} 的详情`)},M=I=>{fe.confirm(`确认锁定卡号 ${I.cardNumber}？`,"锁卡确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{I.lockStatus="已锁定",f.success("锁卡成功")}).catch(()=>{f.info("已取消操作")})},J=I=>{fe.confirm(`确认解锁卡号 ${I.cardNumber}？`,"解锁确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{I.lockStatus="正常",f.success("解锁成功")}).catch(()=>{f.info("已取消操作")})};return be(()=>{g()}),(I,V)=>{const U=a("el-input"),c=a("el-form-item"),T=a("el-option"),d=a("el-select"),A=a("el-button"),Z=a("el-form"),G=a("el-card"),R=a("el-table-column"),L=a("el-tag"),S=a("el-table"),m=a("el-pagination"),te=Ve("loading");return O(),ue("div",Hl,[e(G,{shadow:"never",class:"filter-container"},{default:t(()=>[e(Z,{model:y,class:"multi-line-filter-form"},{default:t(()=>[o("div",Wl,[e(c,{label:"卡密：",prop:"cardSecret"},{default:t(()=>[e(U,{modelValue:y.cardSecret,"onUpdate:modelValue":V[0]||(V[0]=C=>y.cardSecret=C),placeholder:"请输入卡密",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(c,{label:"卡包ID：",prop:"cardId"},{default:t(()=>[e(U,{modelValue:y.cardId,"onUpdate:modelValue":V[1]||(V[1]=C=>y.cardId=C),placeholder:"请输入卡包ID",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(c,{label:"使用状态：",prop:"status"},{default:t(()=>[e(d,{modelValue:y.status,"onUpdate:modelValue":V[2]||(V[2]=C=>y.status=C),placeholder:"请选择使用状态",clearable:"",style:{width:"168px"}},{default:t(()=>[e(T,{label:"未使用",value:"0"}),e(T,{label:"已使用",value:"1"})]),_:1},8,["modelValue"])]),_:1}),e(c,{label:"核销状态：",prop:"verificationStatus"},{default:t(()=>[e(d,{modelValue:y.verificationStatus,"onUpdate:modelValue":V[3]||(V[3]=C=>y.verificationStatus=C),placeholder:"请选择核销状态",clearable:"",style:{width:"168px"}},{default:t(()=>[e(T,{label:"未核销",value:"0"}),e(T,{label:"已核销",value:"1"})]),_:1},8,["modelValue"])]),_:1})]),o("div",Zl,[e(c,{label:"锁卡状态：",prop:"lockStatus"},{default:t(()=>[e(d,{modelValue:y.lockStatus,"onUpdate:modelValue":V[4]||(V[4]=C=>y.lockStatus=C),placeholder:"请选择锁卡状态",clearable:"",style:{width:"168px"}},{default:t(()=>[e(T,{label:"正常",value:"0"}),e(T,{label:"已锁定",value:"1"})]),_:1},8,["modelValue"])]),_:1}),o("div",ea,[e(A,{type:"primary",icon:b(_e),onClick:g},{default:t(()=>[...V[7]||(V[7]=[n("查询",-1)])]),_:1},8,["icon"]),e(A,{plain:"",icon:b(re),onClick:h},{default:t(()=>[...V[8]||(V[8]=[n("重置",-1)])]),_:1},8,["icon"])])])]),_:1},8,["model"])]),_:1}),e(G,null,{default:t(()=>[o("div",ta,[o("div",la,[e(A,{type:"warning",disabled:k.value.length===0||!_.value,onClick:N},{default:t(()=>[...V[9]||(V[9]=[n(" 批量锁卡 ",-1)])]),_:1},8,["disabled"]),e(A,{type:"success",disabled:k.value.length===0||!D.value,onClick:K},{default:t(()=>[...V[10]||(V[10]=[n(" 批量解锁 ",-1)])]),_:1},8,["disabled"]),e(A,{type:"primary",disabled:k.value.length===0,onClick:j},{default:t(()=>[...V[11]||(V[11]=[n(" 批量导出 ",-1)])]),_:1},8,["disabled"])]),o("div",aa,[o("span",oa,"已选择 "+$(k.value.length)+" 项",1)])]),ve((O(),oe(S,{data:z.value,style:{width:"100%"},onSelectionChange:F},{default:t(()=>[e(R,{type:"selection",width:"55"}),e(R,{prop:"cardNumber",label:"卡号",width:"180","show-overflow-tooltip":""}),e(R,{prop:"password",label:"密码",width:"120",align:"center"}),e(R,{prop:"orderNumber",label:"订单编号","min-width":"160","show-overflow-tooltip":""}),e(R,{prop:"customerId",label:"客户ID",width:"100",align:"center"}),e(R,{prop:"status",label:"使用状态",width:"100",align:"center"},{default:t(({row:C})=>[e(L,{type:C.status==="已使用"?"success":C.status==="未使用"?"":"warning"},{default:t(()=>[n($(C.status),1)]),_:2},1032,["type"])]),_:1}),e(R,{prop:"verificationStatus",label:"核销状态",width:"100",align:"center"},{default:t(({row:C})=>[e(L,{type:C.verificationStatus==="已核销"?"success":"warning"},{default:t(()=>[n($(C.verificationStatus),1)]),_:2},1032,["type"])]),_:1}),e(R,{prop:"lockStatus",label:"锁卡状态",width:"100",align:"center"},{default:t(({row:C})=>[e(L,{type:C.lockStatus==="已锁定"?"danger":"success"},{default:t(()=>[n($(C.lockStatus),1)]),_:2},1032,["type"])]),_:1}),e(R,{prop:"productValue",label:"商品面值",width:"120",align:"center"},{default:t(({row:C})=>[o("span",na,$(C.productValue)+"元",1)]),_:1}),e(R,{prop:"createTime",label:"创建时间",width:"160"}),e(R,{label:"操作",width:"150",fixed:"right"},{default:t(({row:C})=>[e(A,{link:"",type:"primary",onClick:ee=>q(C)},{default:t(()=>[...V[12]||(V[12]=[n(" 查看详情 ",-1)])]),_:2},1032,["onClick"]),C.lockStatus==="正常"?(O(),oe(A,{key:0,link:"",type:"warning",onClick:ee=>M(C)},{default:t(()=>[...V[13]||(V[13]=[n(" 锁卡 ",-1)])]),_:2},1032,["onClick"])):(O(),oe(A,{key:1,link:"",type:"success",onClick:ee=>J(C)},{default:t(()=>[...V[14]||(V[14]=[n(" 解锁 ",-1)])]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"])),[[te,w.value]]),o("div",sa,[e(m,{"current-page":r.currentPage,"onUpdate:currentPage":V[5]||(V[5]=C=>r.currentPage=C),"page-size":r.pageSize,"onUpdate:pageSize":V[6]||(V[6]=C=>r.pageSize=C),"page-sizes":[10,20,50,100],total:r.total,layout:"total, sizes, prev, pager, next",onSizeChange:i,onCurrentChange:v},null,8,["current-page","page-size","total"])])]),_:1})])}}},ra=ie(da,[["__scopeId","data-v-f58be2ed"]]);const ua={class:"sub-account-management"},ia={class:"filter-line"},ca={class:"filter-buttons"},ma={class:"pagination-container"},pa={class:"dialog-footer"},fa={class:"dialog-footer"},_a={__name:"SubAccountManagement",setup(ce){const y=Y({username:"",status:""}),k=p([{accountId:1,username:"admin",status:"enabled",createTime:"1970-01-01 00:00:00"},{accountId:2,username:"user001",status:"disabled",createTime:"2024-01-15 10:30:00"},{accountId:3,username:"manager",status:"enabled",createTime:"2024-02-20 14:20:00"}]),_=p(!1),D=Y({currentPage:1,pageSize:10,total:3}),z=p(!1),w=p(),r=Y({username:"",status:"enabled"}),g={username:[{required:!0,message:"请输入用户名",trigger:"blur"}]},h=p(!1),i=p(),v=Y({accountId:null,username:"",status:"enabled"}),F={username:[{required:!0,message:"请输入用户名",trigger:"blur"}]};function N(){_.value=!0,setTimeout(()=>{_.value=!1,f.success("搜索完成")},1e3)}function K(){Object.assign(y,{username:"",status:""}),f.info("筛选条件已重置")}function j(U){Object.assign(v,{accountId:U.accountId,username:U.username,status:U.status}),h.value=!0}function q(U){fe.confirm(`确定要删除账户 "${U.username}" 吗？`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const c=k.value.findIndex(T=>T.accountId===U.accountId);c>-1&&(k.value.splice(c,1),D.total--,f.success("删除成功"))}).catch(()=>{f.info("已取消删除")})}function M(U){D.pageSize=U}function J(U){D.currentPage=U}function I(){w.value.validate(U=>{if(U){const c={accountId:Date.now(),username:r.username,status:r.status,createTime:new Date().toLocaleString("zh-CN")};k.value.unshift(c),D.total++,z.value=!1,f.success("新增成功")}})}function V(){i.value.validate(U=>{if(U){const c=k.value.findIndex(T=>T.accountId===v.accountId);c>-1&&(k.value[c].username=v.username,k.value[c].status=v.status,h.value=!1,f.success("编辑成功"))}})}return be(()=>{}),(U,c)=>{const T=a("el-input"),d=a("el-form-item"),A=a("el-option"),Z=a("el-select"),G=a("el-button"),R=a("el-form"),L=a("el-card"),S=a("el-table-column"),m=a("el-tag"),te=a("el-popconfirm"),C=a("el-table"),ee=a("el-pagination"),ne=a("el-switch"),B=a("el-dialog"),se=Ve("loading");return O(),ue("div",ua,[e(L,{shadow:"never",class:"filter-container"},{default:t(()=>[e(R,{model:y,class:"multi-line-filter-form"},{default:t(()=>[o("div",ia,[e(d,{label:"用户名：",prop:"username"},{default:t(()=>[e(T,{modelValue:y.username,"onUpdate:modelValue":c[0]||(c[0]=x=>y.username=x),placeholder:"请输入用户名",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(d,{label:"启用状态：",prop:"status"},{default:t(()=>[e(Z,{modelValue:y.status,"onUpdate:modelValue":c[1]||(c[1]=x=>y.status=x),placeholder:"请选择状态",clearable:"",style:{width:"168px"}},{default:t(()=>[e(A,{label:"启用",value:"1"}),e(A,{label:"禁用",value:"0"})]),_:1},8,["modelValue"])]),_:1}),o("div",ca,[e(G,{type:"primary",icon:b(_e),onClick:N},{default:t(()=>[...c[12]||(c[12]=[n("查询",-1)])]),_:1},8,["icon"]),e(G,{plain:"",icon:b(re),onClick:K},{default:t(()=>[...c[13]||(c[13]=[n("重置",-1)])]),_:1},8,["icon"])])])]),_:1},8,["model"])]),_:1}),e(L,{shadow:"never",class:"table-card"},{default:t(()=>[ve((O(),oe(C,{data:k.value,border:"",stripe:"",style:{width:"100%",height:"calc(100vh - 280px)"},height:"calc(100vh - 280px)"},{default:t(()=>[e(S,{prop:"accountId",label:"账户ID",width:"100"}),e(S,{prop:"username",label:"用户名",width:"180"}),e(S,{prop:"status",label:"状态",width:"120",align:"center"},{default:t(({row:x})=>[e(m,{type:x.status==="enabled"?"success":"danger"},{default:t(()=>[n($(x.status==="enabled"?"已启用":"已禁用"),1)]),_:2},1032,["type"])]),_:1}),e(S,{prop:"createTime",label:"创建时间","min-width":"200"}),e(S,{label:"操作",width:"180",fixed:"right"},{default:t(({row:x})=>[e(G,{link:"",type:"primary",icon:b(we),onClick:me=>j(x)},{default:t(()=>[...c[14]||(c[14]=[n("编辑",-1)])]),_:2},1032,["icon","onClick"]),e(te,{title:"确认删除该账户？",onConfirm:me=>q(x)},{reference:t(()=>[e(G,{link:"",type:"danger",icon:b(Se)},{default:t(()=>[...c[15]||(c[15]=[n("删除",-1)])]),_:1},8,["icon"])]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[se,_.value]]),o("div",ma,[e(ee,{"current-page":D.currentPage,"onUpdate:currentPage":c[2]||(c[2]=x=>D.currentPage=x),"page-size":D.pageSize,"onUpdate:pageSize":c[3]||(c[3]=x=>D.pageSize=x),"page-sizes":[10,20,50,100],total:D.total,layout:"total, sizes, prev, pager, next",onSizeChange:M,onCurrentChange:J},null,8,["current-page","page-size","total"])])]),_:1}),e(B,{modelValue:z.value,"onUpdate:modelValue":c[7]||(c[7]=x=>z.value=x),title:"新增账户",width:"500px"},{footer:t(()=>[o("div",pa,[e(G,{onClick:c[6]||(c[6]=x=>z.value=!1)},{default:t(()=>[...c[16]||(c[16]=[n("取消",-1)])]),_:1}),e(G,{type:"primary",onClick:I},{default:t(()=>[...c[17]||(c[17]=[n("确定",-1)])]),_:1})])]),default:t(()=>[e(R,{ref_key:"addFormRef",ref:w,model:r,rules:g,"label-width":"100px","label-position":"right"},{default:t(()=>[e(d,{label:"用户名",prop:"username"},{default:t(()=>[e(T,{modelValue:r.username,"onUpdate:modelValue":c[4]||(c[4]=x=>r.username=x),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),e(d,{label:"启用状态"},{default:t(()=>[e(ne,{modelValue:r.status,"onUpdate:modelValue":c[5]||(c[5]=x=>r.status=x),"active-value":"enabled","inactive-value":"disabled"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(B,{modelValue:h.value,"onUpdate:modelValue":c[11]||(c[11]=x=>h.value=x),title:"编辑账户",width:"500px"},{footer:t(()=>[o("div",fa,[e(G,{onClick:c[10]||(c[10]=x=>h.value=!1)},{default:t(()=>[...c[18]||(c[18]=[n("取消",-1)])]),_:1}),e(G,{type:"primary",onClick:V},{default:t(()=>[...c[19]||(c[19]=[n("确定",-1)])]),_:1})])]),default:t(()=>[e(R,{ref_key:"editFormRef",ref:i,model:v,rules:F,"label-width":"100px","label-position":"right"},{default:t(()=>[e(d,{label:"用户名",prop:"username"},{default:t(()=>[e(T,{modelValue:v.username,"onUpdate:modelValue":c[8]||(c[8]=x=>v.username=x),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),e(d,{label:"启用状态"},{default:t(()=>[e(ne,{modelValue:v.status,"onUpdate:modelValue":c[9]||(c[9]=x=>v.status=x),"active-value":"enabled","inactive-value":"disabled"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},ga=ie(_a,[["__scopeId","data-v-f847edc8"]]);const va={class:"operation-log"},ba={class:"filter-line"},ya={class:"filter-buttons"},wa={class:"pagination-container"},Va={__name:"OperationLog",setup(ce){const y=Y({username:"",timeRange:[]}),k=p([{accountId:1,username:"admin",operationType:"登录系统",operationTime:"2025-08-21 09:30:15",ipAddress:"192.168.1.100",description:"管理员登录后台管理系统"},{accountId:2,username:"user001",operationType:"查看订单",operationTime:"2025-08-21 10:15:22",ipAddress:"192.168.1.101",description:"查看订单列表，筛选条件：状态为已完成"},{accountId:1,username:"admin",operationType:"创建卡密",operationTime:"2025-08-21 11:20:45",ipAddress:"192.168.1.100",description:"批量创建卡密，数量：100张"},{accountId:3,username:"manager",operationType:"编辑用户",operationTime:"2025-08-21 14:35:18",ipAddress:"192.168.1.102",description:"修改用户权限，用户ID：12345"},{accountId:2,username:"user001",operationType:"导出数据",operationTime:"2025-08-21 15:42:33",ipAddress:"192.168.1.101",description:"导出订单数据，时间范围：2025-08-01至2025-08-21"}]),_=p(!1),D=Y({currentPage:1,pageSize:10,total:5});function z(){_.value=!0,setTimeout(()=>{_.value=!1,f.success("搜索完成")},1e3)}function w(){Object.assign(y,{username:"",timeRange:[]}),f.info("筛选条件已重置")}function r(h){D.pageSize=h}function g(h){D.currentPage=h}return be(()=>{}),(h,i)=>{const v=a("el-input"),F=a("el-form-item"),N=a("el-date-picker"),K=a("el-button"),j=a("el-form"),q=a("el-card"),M=a("el-table-column"),J=a("el-table"),I=a("el-pagination"),V=Ve("loading");return O(),ue("div",va,[e(q,{shadow:"never",class:"filter-container"},{default:t(()=>[e(j,{model:y,class:"multi-line-filter-form"},{default:t(()=>[o("div",ba,[e(F,{label:"用户名：",prop:"username"},{default:t(()=>[e(v,{modelValue:y.username,"onUpdate:modelValue":i[0]||(i[0]=U=>y.username=U),placeholder:"请输入用户名",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),e(F,{label:"时间范围：",prop:"timeRange"},{default:t(()=>[e(N,{modelValue:y.timeRange,"onUpdate:modelValue":i[1]||(i[1]=U=>y.timeRange=U),type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),o("div",ya,[e(K,{type:"primary",icon:b(_e),onClick:z},{default:t(()=>[...i[4]||(i[4]=[n("查询",-1)])]),_:1},8,["icon"]),e(K,{plain:"",icon:b(re),onClick:w},{default:t(()=>[...i[5]||(i[5]=[n("重置",-1)])]),_:1},8,["icon"])])])]),_:1},8,["model"])]),_:1}),e(q,null,{default:t(()=>[ve((O(),oe(J,{data:k.value,border:"",stripe:"",style:{width:"100%"}},{default:t(()=>[e(M,{prop:"accountId",label:"账户ID",width:"100",align:"center"}),e(M,{prop:"username",label:"用户名",width:"120"}),e(M,{prop:"operationType",label:"操作类型",width:"120"}),e(M,{prop:"operationTime",label:"操作时间",width:"180"}),e(M,{prop:"ipAddress",label:"IP地址",width:"140",align:"center"}),e(M,{prop:"description",label:"操作描述","min-width":"250","show-overflow-tooltip":""})]),_:1},8,["data"])),[[V,_.value]]),o("div",wa,[e(I,{"current-page":D.currentPage,"onUpdate:currentPage":i[2]||(i[2]=U=>D.currentPage=U),"page-size":D.pageSize,"onUpdate:pageSize":i[3]||(i[3]=U=>D.pageSize=U),"page-sizes":[10,20,50,100],total:D.total,layout:"total, sizes, prev, pager, next",onSizeChange:r,onCurrentChange:g},null,8,["current-page","page-size","total"])])]),_:1})])}}},ha=ie(Va,[["__scopeId","data-v-7a303fc9"]]);const Ca={class:"reset-password"},ka={class:"form-container"},Sa={__name:"ResetPassword",setup(ce){const y=p(),k=p(!1),_=Y({currentPassword:"",newPassword:"",confirmPassword:""}),w={currentPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"}],newPassword:[{required:!0,validator:(h,i,v)=>{i===""?v(new Error("请输入新密码")):i.length<6?v(new Error("密码长度不能少于6位")):i===_.currentPassword?v(new Error("新密码不能与当前密码相同")):(_.confirmPassword!==""&&y.value.validateField("confirmPassword"),v())},trigger:"blur"}],confirmPassword:[{required:!0,validator:(h,i,v)=>{i===""?v(new Error("请再次输入新密码")):i!==_.newPassword?v(new Error("两次输入密码不一致")):v()},trigger:"blur"}]},r=async()=>{try{await y.value.validate(),k.value=!0,await new Promise(h=>setTimeout(h,1e3)),f.success("密码修改成功"),g()}catch{}finally{k.value=!1}},g=()=>{var h;(h=y.value)==null||h.resetFields(),Object.assign(_,{currentPassword:"",newPassword:"",confirmPassword:""})};return(h,i)=>{const v=a("el-input"),F=a("el-form-item"),N=a("el-button"),K=a("el-space"),j=a("el-form"),q=a("el-card");return O(),ue("div",Ca,[o("div",ka,[e(q,{class:"form-card"},{default:t(()=>[e(j,{ref_key:"passwordFormRef",ref:y,model:_,rules:w,"label-width":"100px"},{default:t(()=>[e(F,{label:"当前密码",prop:"currentPassword"},{default:t(()=>[e(v,{modelValue:_.currentPassword,"onUpdate:modelValue":i[0]||(i[0]=M=>_.currentPassword=M),type:"password",placeholder:"请输入当前密码","show-password":""},null,8,["modelValue"])]),_:1}),e(F,{label:"新密码",prop:"newPassword"},{default:t(()=>[e(v,{modelValue:_.newPassword,"onUpdate:modelValue":i[1]||(i[1]=M=>_.newPassword=M),type:"password",placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),e(F,{label:"确认新密码",prop:"confirmPassword"},{default:t(()=>[e(v,{modelValue:_.confirmPassword,"onUpdate:modelValue":i[2]||(i[2]=M=>_.confirmPassword=M),type:"password",placeholder:"请再次输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),e(F,null,{default:t(()=>[e(K,null,{default:t(()=>[e(N,{type:"primary",loading:k.value,onClick:r},{default:t(()=>[...i[3]||(i[3]=[n(" 保存 ",-1)])]),_:1},8,["loading"]),e(N,{onClick:g},{default:t(()=>[...i[4]||(i[4]=[n("重置",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])])}}},xa=ie(Sa,[["__scopeId","data-v-4a638ec1"]]);const Na={class:"admin-layout"},Ia={class:"header-right"},$a={class:"el-dropdown-link"},Pa={__name:"AdminLayout",setup(ce){const y=p("dashboard"),k=yt(qe),_={dashboard:qe,"customer-management":hl,"card-management":Rl,"order-management":Gl,"card-query":ra,"subaccount-management":ga,"operation-log":ha,"reset-password":xa},D=w=>{y.value=w,k.value=_[w]},z=w=>{switch(w){case"logout":f.success("退出登录成功");break}};return(w,r)=>{const g=a("el-icon"),h=a("el-dropdown-item"),i=a("el-dropdown-menu"),v=a("el-dropdown"),F=a("el-header"),N=a("el-menu-item"),K=a("el-sub-menu"),j=a("el-menu"),q=a("el-aside"),M=a("el-main"),J=a("el-container");return O(),ue("div",Na,[e(F,{class:"header"},{default:t(()=>[r[2]||(r[2]=o("div",{class:"header-left"},[o("h2",null,"卡密核销系统")],-1)),o("div",Ia,[e(v,{onCommand:z},{dropdown:t(()=>[e(i,null,{default:t(()=>[e(h,{command:"logout"},{default:t(()=>[...r[1]||(r[1]=[n("退出登录",-1)])]),_:1})]),_:1})]),default:t(()=>[o("span",$a,[r[0]||(r[0]=n(" admin ",-1)),e(g,{class:"el-icon--right"},{default:t(()=>[e(b(He))]),_:1})])]),_:1})])]),_:1}),e(J,null,{default:t(()=>[e(q,{width:"200px",class:"sidebar"},{default:t(()=>[e(j,{"default-active":y.value,class:"el-menu-vertical",onSelect:D},{default:t(()=>[e(N,{index:"dashboard"},{default:t(()=>[e(g,null,{default:t(()=>[e(b(wt))]),_:1}),r[3]||(r[3]=o("span",null,"仪表盘",-1))]),_:1}),e(N,{index:"customer-management"},{default:t(()=>[e(g,null,{default:t(()=>[e(b(Qe))]),_:1}),r[4]||(r[4]=o("span",null,"客户管理",-1))]),_:1}),e(N,{index:"card-management"},{default:t(()=>[e(g,null,{default:t(()=>[e(b(Vt))]),_:1}),r[5]||(r[5]=o("span",null,"卡密产品管理",-1))]),_:1}),e(N,{index:"order-management"},{default:t(()=>[e(g,null,{default:t(()=>[e(b(Xe))]),_:1}),r[6]||(r[6]=o("span",null,"订单管理",-1))]),_:1}),e(N,{index:"card-query"},{default:t(()=>[e(g,null,{default:t(()=>[e(b(_e))]),_:1}),r[7]||(r[7]=o("span",null,"卡密查询",-1))]),_:1}),e(K,{index:"system-settings"},{title:t(()=>[e(g,null,{default:t(()=>[e(b(Ge))]),_:1}),r[8]||(r[8]=o("span",null,"系统设置",-1))]),default:t(()=>[e(N,{index:"subaccount-management"},{default:t(()=>[e(g,null,{default:t(()=>[e(b(ht))]),_:1}),r[9]||(r[9]=o("span",null,"子账户管理",-1))]),_:1}),e(N,{index:"operation-log"},{default:t(()=>[e(g,null,{default:t(()=>[e(b(Ct))]),_:1}),r[10]||(r[10]=o("span",null,"操作日志",-1))]),_:1}),e(N,{index:"reset-password"},{default:t(()=>[e(g,null,{default:t(()=>[e(b(kt))]),_:1}),r[11]||(r[11]=o("span",null,"重置密码",-1))]),_:1})]),_:1})]),_:1},8,["default-active"])]),_:1}),e(M,{class:"main-content"},{default:t(()=>[(O(),oe(St(k.value)))]),_:1})]),_:1})])}}},Ta=ie(Pa,[["__scopeId","data-v-091fdcbd"]]);export{Ta as A};
