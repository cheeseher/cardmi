import{_ as e,f as a,r as l,o as t,c as o,a as r,w as d,g as n,u,m as i,h as s,j as c,k as m,l as p,s as f,n as v,p as h,q as g,t as b,v as w,x as y,y as _,z as V,A as N,B as C,C as S,D as k,F as x,G as T,H as I,I as P,J as z,K as U,L as D,M as A,N as M,O as E,P as O,Q as Y,R as K,S as R,T as $}from"./_plugin-vue_export-helper-18a4c639.js";const F={class:"dashboard"},B={class:"stat-content"},j={class:"stat-icon primary"},H=e({__name:"Dashboard",setup:e=>(a(()=>{}),(e,a)=>{const s=l("el-icon"),c=l("el-card"),m=l("el-col"),p=l("el-row");return t(),o("div",F,[r(p,{gutter:16,class:"stats-row"},{default:d(()=>[r(m,{xs:24,sm:12,lg:6},{default:d(()=>[r(c,{class:"stat-card",shadow:"hover"},{default:d(()=>[n("div",B,[n("div",j,[r(s,null,{default:d(()=>[r(u(i))]),_:1})]),a[0]||(a[0]=n("div",{class:"stat-info"},[n("div",{class:"stat-value"},"¥888,888.88"),n("div",{class:"stat-label"},"总用户余额")],-1))])]),_:1})]),_:1})]),_:1})])})},[["__scopeId","data-v-13894abe"]]),q={class:"customer-management"},L={class:"filter-line"},Q={class:"filter-line"},G={class:"filter-buttons"},J={class:"table-toolbar"},X={class:"left"},Z={style:{display:"flex","align-items":"center",gap:"8px"}},W={style:{"font-family":"monospace","font-size":"12px"}},ee={style:{display:"flex","align-items":"center",gap:"8px"}},ae={style:{"font-family":"monospace","font-size":"12px"}},le={style:{"line-height":"1.4"}},te={style:{"font-weight":"500",color:"var(--el-text-color-primary)"}},oe={style:{"font-size":"12px",color:"var(--el-text-color-regular)","margin-top":"2px"}},re={style:{color:"var(--el-color-primary)","font-weight":"500"}},de={class:"pagination-container"},ne={class:"dialog-footer"},ue={class:"edit-customer-content"},ie={class:"dialog-footer"},se={class:"amount-text"},ce={class:"amount-text"},me={class:"pagination-wrapper"},pe={class:"dialog-footer"},fe={class:"adjust-balance-form"},ve={class:"current-balance"},he={class:"value"},ge={class:"adjust-type"},be={class:"adjust-amount"},we={class:"result-balance"},ye={class:"value"},_e={class:"dialog-footer"},Ve={class:"product-config-content"},Ne={class:"customer-info"},Ce={class:"product-config-section"},Se={class:"section-header"},ke={class:"drawer-footer"},xe={class:"product-select-content"},Te={key:0,class:"selection-summary"},Ie={class:"selected-items"},Pe={class:"dialog-footer"},ze=e({__name:"CustomerManagement",setup(e){const D=s(!1);s(!1);const A=s([]),M=c({customerId:"",merchantNo:"",customerName:"",customerEmail:"",status:"",dateRange:[]}),E=s([{customerId:"1001",merchantNo:"M17408123456",merchantKey:"test_key_1234567890abcdef1234567890abcdef",aesKey:"aes_key_1234567890abcdef1234567890abcdef",customerName:"asd",customerEmail:"123@qq.com",balance:"9.900",status:"active",registerTime:"2025-02-25 00:28:27"},{customerId:"1002",merchantNo:"M17408234567",merchantKey:"test_key_abcdef1234567890abcdef1234567890",aesKey:"aes_key_fedcba0987654321fedcba0987654321",customerName:"aaa",customerEmail:"888@gmail.com",balance:"0.000",status:"active",registerTime:"2025-02-25 17:55:35"},{customerId:"1003",merchantNo:"M17408345678",merchantKey:"test_key_9876543210fedcba9876543210fedcba",aesKey:"aes_key_abcd1234efgh5678ijkl9012mnop3456",customerName:"bbb",customerEmail:"999@gmail.com",balance:"0.000",status:"disabled",registerTime:"2025-02-25 18:09:00"}]),O=c({currentPage:1,pageSize:10,total:3}),Y=s(!1),K=s(),R=c({merchantNo:"",merchantKey:"",aesKey:"",customerName:"",customerEmail:"",balance:""}),$={merchantNo:[{required:!0,message:"商户号不能为空",trigger:"blur"}],merchantKey:[{required:!0,message:"商户密钥不能为空",trigger:"blur"}],customerName:[{required:!0,message:"请输入客户昵称",trigger:"blur"}],customerEmail:[{required:!0,message:"请输入客户邮箱",trigger:"blur"}]},F=s(!1),B=s(),j=s(!1),H=c({customerId:"",customerName:"",customerEmail:"",balance:"",merchantNo:"",merchantKey:"",aesKey:"",status:"active"}),ze={customerName:[{required:!0,message:"请输入客户昵称",trigger:"blur"}],customerEmail:[{required:!0,message:"请输入客户邮箱",trigger:"blur"}]},Ue=s(!1),De=s([{operator:"admin",editTime:"2025-02-25 14:32:33",amount:-.1,beforeAmount:10,afterAmount:9.9,flowType:"交易增减",type:"TK202502251432001"},{operator:"manager",editTime:"2025-02-25 00:28:27",amount:10,beforeAmount:0,afterAmount:10,flowType:"人工修改",type:""},{operator:"admin",editTime:"2025-02-24 16:45:12",amount:50,beforeAmount:25,afterAmount:75,flowType:"人工修改",type:""},{operator:"",editTime:"2025-02-24 10:20:15",amount:-25,beforeAmount:50,afterAmount:25,flowType:"交易增减",type:"TK202502241020002"},{operator:"",editTime:"2025-02-23 15:30:45",amount:15,beforeAmount:35,afterAmount:50,flowType:"交易增减",type:"SK202502231530001"}]),Ae=s({flowType:""}),Me=m(()=>Ae.value.flowType?De.value.filter(e=>e.flowType===Ae.value.flowType):De.value),Ee=()=>{},Oe=c({currentPage:1,pageSize:10,total:2}),Ye=s(!1),Ke=s("9.900"),Re=s("increase"),$e=s(""),Fe=m(()=>{const e=parseFloat(Ke.value)||0,a=parseFloat($e.value)||0;return"increase"===Re.value?(e+a).toFixed(3):(e-a).toFixed(3)}),Be=s(!1),je=s(!1),He=s(!1),qe=s({});s([10,20,50,100,200,300]);const Le=s([]),Qe=s(!1),Ge=s([]),Je=s([]),Xe=s([]),Ze=s(!1),We=s([]),ea={multiple:!0,checkStrictly:!1,value:"value",label:"label",children:"children"},aa=e=>{A.value=e},la=()=>{Y.value=!0,Object.assign(R,{merchantNo:"",merchantKey:"",aesKey:"",customerName:"",customerEmail:"",balance:""}),(()=>{const e=Date.now().toString(),a=Math.floor(1e3*Math.random()).toString().padStart(3,"0");R.merchantNo=`M${e.slice(-8)}${a}`})(),(()=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let a="merchant_key_";for(let l=0;l<32;l++)a+=e.charAt(Math.floor(62*Math.random()));R.merchantKey=a})(),(()=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let a="aes_key_";for(let l=0;l<32;l++)a+=e.charAt(Math.floor(62*Math.random()));R.aesKey=a})()},ta=async()=>{try{await K.value.validate(),z.success("新增客户成功"),Y.value=!1}catch(e){}},oa=async()=>{try{await B.value.validate(),j.value=!0,await new Promise(e=>setTimeout(e,1e3)),z.success("客户信息修改成功"),F.value=!1}catch(e){!1!==e&&z.error("修改失败，请重试")}finally{j.value=!1}},ra=e=>{U.confirm(`确认重置客户 "${e.customerName}" 的商户密钥和AES密钥吗？重置后原密钥将失效。`,"重置密钥确认",{confirmButtonText:"确认重置",cancelButtonText:"取消",type:"warning"}).then(()=>{const a="merchant_key_"+Math.random().toString(36).substr(2,32),l="aes_key_"+Math.random().toString(36).substr(2,32),t=E.value.findIndex(a=>a.customerId===e.customerId);-1!==t&&(E.value[t].merchantKey=a,E.value[t].aesKey=l),U.alert(`新密钥已生成，请妥善保管：\n商户密钥：${a}\nAES密钥：${l}`,"密钥重置成功",{confirmButtonText:"我已保存",type:"success",showClose:!1,closeOnClickModal:!1,closeOnPressEscape:!1}).then(()=>{(async()=>{D.value=!0;try{await new Promise(e=>setTimeout(e,500)),z.success("数据已刷新")}finally{D.value=!1}})()}),z.success("商户密钥和AES密钥重置成功")}).catch(()=>{z.info("已取消重置")})},da=(e,a)=>{switch(e){case"edit":(e=>{F.value=!0,Object.assign(H,{customerId:e.customerId,customerName:e.customerName,customerEmail:e.customerEmail,balance:e.balance,merchantNo:e.merchantNo,merchantKey:e.merchantKey,aesKey:e.aesKey,status:e.status||"active"})})(a);break;case"productConfig":na(a);break;case"balance":va();break;case"adjustBalance":ha(a);break;case"resetKey":ra(a);break;case"delete":(e=>{U.confirm(`确定要删除客户 ${e.customerName} 吗？`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{z.success("删除成功")})})(a)}},na=e=>{qe.value={customerId:e.customerId,customerName:e.customerName,merchantNo:e.merchantNo,customerEmail:e.customerEmail},Be.value=!0,ua(e.customerId)},ua=async e=>{je.value=!0;try{await new Promise(e=>setTimeout(e,500))}catch(a){z.error("加载产品配置失败")}finally{je.value=!1}},ia=async()=>{Qe.value=!0,await sa(),Ge.value=[]},sa=async()=>{Ze.value=!0;try{await new Promise(e=>setTimeout(e,500));const e=[{productId:"PD1001",productName:"产品A",faceValue:"10"},{productId:"PD1002",productName:"产品B",faceValue:"20"},{productId:"PD1003",productName:"产品C",faceValue:"50"},{productId:"PD1004",productName:"产品D",faceValue:"20"},{productId:"PD1005",productName:"产品E",faceValue:"50"}];Xe.value=e;const a=[10,20,50,100,200,300];We.value=e.map(e=>({value:e.productId,label:e.productName,children:a.map(a=>({value:`${e.productId}-${a}`,label:`${a}元`,productId:e.productId,productName:e.productName,faceValue:a}))}))}catch(e){z.error("获取产品数据失败")}finally{Ze.value=!1}},ca=()=>{Be.value=!1,qe.value={}},ma=()=>{Qe.value=!1,Ge.value=[],Je.value=[]},pa=()=>{0!==Je.value.length?(Je.value.forEach(e=>{if(2===e.length){const[a,l]=e,t=Xe.value.find(e=>e.productId===a),o=l.split("-")[1];if(t){const e={id:Date.now()+Math.random(),productCode:t.productId,productName:t.productName,faceValue:o,discountRate:"",enabled:!0};Le.value.push(e)}}}),z.success(`已添加 ${Je.value.length} 个产品配置，请设置折扣比例`),Qe.value=!1,Ge.value=[],Je.value=[]):z.warning("请选择至少一个产品配置")},fa=async()=>{for(let a=0;a<Le.value.length;a++){const e=Le.value[a];if(!e.faceValue||""===e.faceValue)return void z.error(`${e.productName} 请选择面值`);if(!e.discountRate||""===e.discountRate)return void z.error(`${e.productName} 请输入折扣比例`)}He.value=!0;try{await new Promise(e=>setTimeout(e,1e3)),z.success("产品配置保存成功"),Be.value=!1}catch(e){z.error("保存失败，请重试")}finally{He.value=!1}},va=e=>{Ue.value=!0},ha=e=>{Ye.value=!0,Ke.value=e?e.balance:H.balance,Re.value="increase",$e.value=""},ga=()=>{z.success("余额调整成功"),H.balance=Fe.value,Ye.value=!1},ba=e=>{O.pageSize=e},wa=e=>{O.currentPage=e};return a(()=>{}),(e,a)=>{const s=l("el-input"),c=l("el-form-item"),m=l("el-option"),U=l("el-select"),A=l("el-date-picker"),De=l("el-icon"),Ge=l("el-button"),ra=l("el-form"),na=l("el-card"),ua=l("el-table-column"),sa=l("el-tag"),va=l("el-dropdown-item"),ha=l("el-dropdown-menu"),ya=l("el-dropdown"),_a=l("el-table"),Va=l("el-pagination"),Na=l("el-dialog"),Ca=l("el-switch"),Sa=l("el-radio"),ka=l("el-radio-group"),xa=l("el-descriptions-item"),Ta=l("el-descriptions"),Ia=l("el-input-number"),Pa=l("el-drawer"),za=l("el-cascader"),Ua=p("loading");return t(),o("div",q,[r(na,{shadow:"never",class:"filter-container"},{default:d(()=>[r(ra,{model:M,class:"multi-line-filter-form"},{default:d(()=>[n("div",L,[r(c,{label:"客户ID：",prop:"customerId"},{default:d(()=>[r(s,{modelValue:M.customerId,"onUpdate:modelValue":a[0]||(a[0]=e=>M.customerId=e),placeholder:"请输入客户ID",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),r(c,{label:"商户号：",prop:"merchantNo"},{default:d(()=>[r(s,{modelValue:M.merchantNo,"onUpdate:modelValue":a[1]||(a[1]=e=>M.merchantNo=e),placeholder:"请输入商户号",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),r(c,{label:"昵称：",prop:"customerName"},{default:d(()=>[r(s,{modelValue:M.customerName,"onUpdate:modelValue":a[2]||(a[2]=e=>M.customerName=e),placeholder:"请输入客户昵称",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),r(c,{label:"邮箱：",prop:"customerEmail"},{default:d(()=>[r(s,{modelValue:M.customerEmail,"onUpdate:modelValue":a[3]||(a[3]=e=>M.customerEmail=e),placeholder:"请输入客户邮箱",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1})]),n("div",Q,[r(c,{label:"状态：",prop:"status"},{default:d(()=>[r(U,{modelValue:M.status,"onUpdate:modelValue":a[4]||(a[4]=e=>M.status=e),placeholder:"请选择状态",clearable:"",style:{width:"140px"}},{default:d(()=>[r(m,{label:"启用",value:"active"}),r(m,{label:"禁用",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),r(c,{label:"注册时间：",prop:"registerTimeRange"},{default:d(()=>[r(A,{modelValue:M.registerTimeRange,"onUpdate:modelValue":a[5]||(a[5]=e=>M.registerTimeRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"240px"}},null,8,["modelValue"])]),_:1}),n("div",G,[r(Ge,{type:"primary",onClick:e.handleFilter},{default:d(()=>[r(De,null,{default:d(()=>[r(u(f))]),_:1}),a[38]||(a[38]=v(" 查询 ",-1))]),_:1},8,["onClick"]),r(Ge,{plain:"",onClick:e.resetFilter},{default:d(()=>[r(De,null,{default:d(()=>[r(u(h))]),_:1}),a[39]||(a[39]=v(" 重置 ",-1))]),_:1},8,["onClick"])])])]),_:1},8,["model"])]),_:1}),r(na,null,{default:d(()=>[n("div",J,[n("div",X,[r(Ge,{type:"primary",onClick:la},{default:d(()=>[r(De,null,{default:d(()=>[r(u(g))]),_:1}),a[40]||(a[40]=v(" 新增客户 ",-1))]),_:1})])]),b((t(),w(_a,{data:E.value,border:"",stripe:"",onSelectionChange:aa,style:{width:"100%"}},{default:d(()=>[r(ua,{type:"selection",width:"55"}),r(ua,{prop:"customerId",label:"客户ID",width:"100","show-overflow-tooltip":""}),r(ua,{prop:"merchantNo",label:"商户号",width:"160","show-overflow-tooltip":""}),r(ua,{prop:"merchantKey",label:"商户密钥",width:"240","show-overflow-tooltip":""},{default:d(({row:e})=>[n("div",Z,[n("span",W,y(e.merchantKey),1),r(Ge,{type:"primary",link:"",size:"small",onClick:a=>(async e=>{try{await navigator.clipboard.writeText(e),z.success("商户密钥已复制到剪贴板")}catch(a){z.error("复制失败，请手动复制")}})(e.merchantKey)},{default:d(()=>[r(De,null,{default:d(()=>[r(u(_))]),_:1})]),_:2},1032,["onClick"])])]),_:1}),r(ua,{prop:"aesKey",label:"AES密钥",width:"240","show-overflow-tooltip":""},{default:d(({row:e})=>[n("div",ee,[n("span",ae,y(e.aesKey),1),r(Ge,{type:"primary",link:"",size:"small",onClick:a=>(async e=>{try{await navigator.clipboard.writeText(e),z.success("AES密钥已复制到剪贴板")}catch(a){z.error("复制失败，请手动复制")}})(e.aesKey)},{default:d(()=>[r(De,null,{default:d(()=>[r(u(_))]),_:1})]),_:2},1032,["onClick"])])]),_:1}),r(ua,{label:"客户信息",width:"220","show-overflow-tooltip":""},{default:d(({row:e})=>[n("div",le,[n("div",te,y(e.customerName),1),n("div",oe,y(e.customerEmail),1)])]),_:1}),r(ua,{prop:"balance",label:"余额",width:"120",sortable:"",align:"right"},{default:d(({row:e})=>[n("span",re,"¥"+y(parseFloat(e.balance).toLocaleString()),1)]),_:1}),r(ua,{prop:"status",label:"状态",width:"80",align:"center"},{default:d(({row:e})=>[r(sa,{type:"active"===e.status?"success":"danger"},{default:d(()=>[v(y("active"===e.status?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),r(ua,{label:"商户后台",width:"110",align:"center"},{default:d(({row:e})=>[r(Ge,{link:"",type:"primary",onClick:a=>(e=>{const a=new URLSearchParams({merchantNo:e.merchantNo,merchantKey:e.merchantKey,customerName:e.customerName,customerId:e.customerId});window.open(`/merchant?${a.toString()}`,"_blank"),z.success(`正在进入 ${e.customerName} 的商户后台系统`)})(e)},{default:d(()=>[r(De,null,{default:d(()=>[r(u(V))]),_:1}),a[41]||(a[41]=v(" 进入后台 ",-1))]),_:2},1032,["onClick"])]),_:1}),r(ua,{prop:"registerTime",label:"注册时间",width:"160",sortable:""}),r(ua,{label:"操作",width:"120",fixed:"right",align:"center"},{default:d(({row:e})=>[r(ya,{trigger:"click",onCommand:a=>da(a,e)},{dropdown:d(()=>[r(ha,null,{default:d(()=>[r(va,{command:"edit"},{default:d(()=>[r(De,null,{default:d(()=>[r(u(N))]),_:1}),a[43]||(a[43]=v(" 编辑 ",-1))]),_:1}),r(va,{command:"adjustBalance"},{default:d(()=>[r(De,null,{default:d(()=>[r(u(N))]),_:1}),a[44]||(a[44]=v(" 余额操作 ",-1))]),_:1}),r(va,{command:"balance"},{default:d(()=>[r(De,null,{default:d(()=>[r(u(i))]),_:1}),a[45]||(a[45]=v(" 余额详情 ",-1))]),_:1}),r(va,{command:"productConfig"},{default:d(()=>[r(De,null,{default:d(()=>[r(u(C))]),_:1}),a[46]||(a[46]=v(" 产品配置 ",-1))]),_:1}),r(va,{command:"resetKey"},{default:d(()=>[r(De,null,{default:d(()=>[r(u(h))]),_:1}),a[47]||(a[47]=v(" 重置密钥 ",-1))]),_:1}),r(va,{command:"delete",divided:""},{default:d(()=>[r(De,null,{default:d(()=>[r(u(S))]),_:1}),a[48]||(a[48]=n("span",{style:{color:"var(--el-color-danger)"}},"删除",-1))]),_:1})]),_:1})]),default:d(()=>[r(Ge,{text:"",type:"primary",style:{"font-size":"14px"}},{default:d(()=>[a[42]||(a[42]=v(" 操作 ",-1)),r(De,{class:"el-icon--right"},{default:d(()=>[r(u(k))]),_:1})]),_:1})]),_:2},1032,["onCommand"])]),_:1})]),_:1},8,["data"])),[[Ua,D.value]]),n("div",de,[r(Va,{"current-page":O.currentPage,"onUpdate:currentPage":a[6]||(a[6]=e=>O.currentPage=e),"page-size":O.pageSize,"onUpdate:pageSize":a[7]||(a[7]=e=>O.pageSize=e),"page-sizes":[10,20,50,100],total:O.total,layout:"total, sizes, prev, pager, next",onSizeChange:ba,onCurrentChange:wa},null,8,["current-page","page-size","total"])])]),_:1}),r(Na,{modelValue:Y.value,"onUpdate:modelValue":a[15]||(a[15]=e=>Y.value=e),title:"新增客户",width:"500px"},{footer:d(()=>[n("div",ne,[r(Ge,{onClick:a[14]||(a[14]=e=>Y.value=!1)},{default:d(()=>[...a[50]||(a[50]=[v("取消",-1)])]),_:1}),r(Ge,{type:"primary",onClick:ta},{default:d(()=>[...a[51]||(a[51]=[v("确定",-1)])]),_:1})])]),default:d(()=>[r(ra,{ref_key:"addFormRef",ref:K,model:R,rules:$,"label-width":"100px","label-position":"right"},{default:d(()=>[r(c,{label:"商户号",prop:"merchantNo"},{default:d(()=>[r(s,{modelValue:R.merchantNo,"onUpdate:modelValue":a[8]||(a[8]=e=>R.merchantNo=e),placeholder:"系统自动生成",readonly:"",disabled:"",style:{"background-color":"var(--el-fill-color-light)"}},null,8,["modelValue"])]),_:1}),r(c,{label:"商户密钥",prop:"merchantKey"},{default:d(()=>[r(s,{modelValue:R.merchantKey,"onUpdate:modelValue":a[9]||(a[9]=e=>R.merchantKey=e),placeholder:"系统自动生成",readonly:"",disabled:"",style:{"background-color":"var(--el-fill-color-light)"}},null,8,["modelValue"])]),_:1}),r(c,{label:"AES密钥",prop:"aesKey"},{default:d(()=>[r(s,{modelValue:R.aesKey,"onUpdate:modelValue":a[10]||(a[10]=e=>R.aesKey=e),placeholder:"系统自动生成",readonly:"",disabled:"",style:{"background-color":"var(--el-fill-color-light)"}},null,8,["modelValue"])]),_:1}),r(c,{label:"客户昵称",prop:"customerName"},{default:d(()=>[r(s,{modelValue:R.customerName,"onUpdate:modelValue":a[11]||(a[11]=e=>R.customerName=e),placeholder:"请输入客户昵称",clearable:""},null,8,["modelValue"])]),_:1}),r(c,{label:"客户邮箱",prop:"customerEmail"},{default:d(()=>[r(s,{modelValue:R.customerEmail,"onUpdate:modelValue":a[12]||(a[12]=e=>R.customerEmail=e),placeholder:"请输入客户邮箱",clearable:""},null,8,["modelValue"])]),_:1}),r(c,{label:"客户余额",prop:"balance"},{default:d(()=>[r(s,{modelValue:R.balance,"onUpdate:modelValue":a[13]||(a[13]=e=>R.balance=e),placeholder:"请输入初始余额",clearable:""},{append:d(()=>[...a[49]||(a[49]=[v("元",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),r(Na,{modelValue:F.value,"onUpdate:modelValue":a[24]||(a[24]=e=>F.value=e),title:"编辑客户信息",width:"600px","close-on-click-modal":!1},{footer:d(()=>[n("div",ie,[r(Ge,{onClick:a[23]||(a[23]=e=>F.value=!1)},{default:d(()=>[...a[52]||(a[52]=[v("取消",-1)])]),_:1}),r(Ge,{type:"primary",onClick:oa,loading:j.value},{default:d(()=>[...a[53]||(a[53]=[v(" 保存修改 ",-1)])]),_:1},8,["loading"])])]),default:d(()=>[n("div",ue,[r(ra,{ref_key:"editFormRef",ref:B,model:H,rules:ze,"label-width":"100px","label-position":"right"},{default:d(()=>[r(c,{label:"客户ID"},{default:d(()=>[r(s,{modelValue:H.customerId,"onUpdate:modelValue":a[16]||(a[16]=e=>H.customerId=e),disabled:"",style:{"background-color":"var(--el-fill-color-light)"}},null,8,["modelValue"])]),_:1}),r(c,{label:"商户号"},{default:d(()=>[r(s,{modelValue:H.merchantNo,"onUpdate:modelValue":a[17]||(a[17]=e=>H.merchantNo=e),disabled:"",style:{"background-color":"var(--el-fill-color-light)"}},null,8,["modelValue"])]),_:1}),r(c,{label:"商户密钥"},{default:d(()=>[r(s,{modelValue:H.merchantKey,"onUpdate:modelValue":a[18]||(a[18]=e=>H.merchantKey=e),disabled:"",style:{"background-color":"var(--el-fill-color-light)"},type:"password","show-password":""},null,8,["modelValue"])]),_:1}),r(c,{label:"AES密钥"},{default:d(()=>[r(s,{modelValue:H.aesKey,"onUpdate:modelValue":a[19]||(a[19]=e=>H.aesKey=e),disabled:"",style:{"background-color":"var(--el-fill-color-light)"},type:"password","show-password":""},null,8,["modelValue"])]),_:1}),r(c,{label:"客户昵称",prop:"customerName"},{default:d(()=>[r(s,{modelValue:H.customerName,"onUpdate:modelValue":a[20]||(a[20]=e=>H.customerName=e),placeholder:"请输入客户昵称",clearable:"","prefix-icon":u(N)},null,8,["modelValue","prefix-icon"])]),_:1}),r(c,{label:"客户邮箱",prop:"customerEmail"},{default:d(()=>[r(s,{modelValue:H.customerEmail,"onUpdate:modelValue":a[21]||(a[21]=e=>H.customerEmail=e),placeholder:"请输入客户邮箱",clearable:"",type:"email"},null,8,["modelValue"])]),_:1}),r(c,{label:"状态"},{default:d(()=>[r(Ca,{modelValue:H.status,"onUpdate:modelValue":a[22]||(a[22]=e=>H.status=e),"active-text":"启用","inactive-text":"禁用","active-value":"active","inactive-value":"inactive",style:{"--el-switch-on-color":"var(--el-color-primary)","--el-switch-off-color":"var(--el-color-info)"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),r(Na,{modelValue:Ue.value,"onUpdate:modelValue":a[30]||(a[30]=e=>Ue.value=e),title:"余额详情",width:"900px"},{footer:d(()=>[n("div",pe,[r(Ge,{onClick:a[28]||(a[28]=e=>Ue.value=!1)},{default:d(()=>[...a[54]||(a[54]=[v("取消",-1)])]),_:1}),r(Ge,{type:"primary",onClick:a[29]||(a[29]=e=>Ue.value=!1)},{default:d(()=>[...a[55]||(a[55]=[v("确定",-1)])]),_:1})])]),default:d(()=>[r(na,{shadow:"never",class:"balance-filter-container"},{default:d(()=>[r(ra,{model:Ae.value,inline:""},{default:d(()=>[r(c,{label:"流水类型：",prop:"flowType"},{default:d(()=>[r(U,{modelValue:Ae.value.flowType,"onUpdate:modelValue":a[25]||(a[25]=e=>Ae.value.flowType=e),placeholder:"请选择流水类型",clearable:"",style:{width:"150px"},onChange:Ee},{default:d(()=>[r(m,{label:"全部",value:""}),r(m,{label:"人工修改",value:"人工修改"}),r(m,{label:"交易增减",value:"交易增减"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1}),r(_a,{data:Me.value,border:"",stripe:""},{default:d(()=>[r(ua,{prop:"flowType",label:"流水类型",width:"120"},{default:d(({row:e})=>[r(sa,{type:"人工修改"===e.flowType?"primary":"warning"},{default:d(()=>[v(y(e.flowType),1)]),_:2},1032,["type"])]),_:1}),r(ua,{prop:"beforeAmount",label:"交易前金额",width:"120"},{default:d(({row:e})=>[n("span",se,y(e.beforeAmount),1)]),_:1}),r(ua,{prop:"amount",label:"变动金额",width:"120"},{default:d(({row:e})=>[n("span",{class:x(e.amount>0?"amount-positive":"amount-negative")},y(e.amount>0?"+":"")+y(e.amount),3)]),_:1}),r(ua,{prop:"afterAmount",label:"变动后金额",width:"120"},{default:d(({row:e})=>[n("span",ce,y(e.afterAmount),1)]),_:1}),r(ua,{prop:"operator",label:"操作人",width:"120"},{default:d(({row:e})=>[n("span",null,y("交易增减"===e.flowType?"":e.operator),1)]),_:1}),r(ua,{prop:"type",label:"备注","min-width":"200"},{default:d(({row:e})=>[n("span",null,y("人工修改"===e.flowType?"":"交易增减"===e.flowType?e.amount>0?`锁卡返还余额，单号：${e.type}`:`提卡单号：${e.type}`:e.type),1)]),_:1}),r(ua,{prop:"editTime",label:"修改时间",width:"180"})]),_:1},8,["data"]),n("div",me,[r(Va,{"current-page":Oe.currentPage,"onUpdate:currentPage":a[26]||(a[26]=e=>Oe.currentPage=e),"page-size":Oe.pageSize,"onUpdate:pageSize":a[27]||(a[27]=e=>Oe.pageSize=e),"page-sizes":[10,20,50],total:Oe.total,layout:"total, sizes, prev, pager, next"},null,8,["current-page","page-size","total"])])]),_:1},8,["modelValue"]),r(Na,{modelValue:Ye.value,"onUpdate:modelValue":a[34]||(a[34]=e=>Ye.value=e),title:"余额调整",width:"500px"},{footer:d(()=>[n("div",_e,[r(Ge,{onClick:a[33]||(a[33]=e=>Ye.value=!1)},{default:d(()=>[...a[63]||(a[63]=[v("取消",-1)])]),_:1}),r(Ge,{type:"primary",onClick:ga},{default:d(()=>[...a[64]||(a[64]=[v("确定",-1)])]),_:1})])]),default:d(()=>[n("div",fe,[n("div",ve,[a[56]||(a[56]=n("span",{class:"label"},"当前余额:",-1)),n("span",he,y(Ke.value)+"元",1)]),n("div",ge,[a[59]||(a[59]=n("span",{class:"label"},"余额增减:",-1)),r(ka,{modelValue:Re.value,"onUpdate:modelValue":a[31]||(a[31]=e=>Re.value=e)},{default:d(()=>[r(Sa,{value:"increase"},{default:d(()=>[...a[57]||(a[57]=[v("余额增加",-1)])]),_:1}),r(Sa,{value:"decrease"},{default:d(()=>[...a[58]||(a[58]=[v("余额减少",-1)])]),_:1})]),_:1},8,["modelValue"])]),n("div",be,[a[61]||(a[61]=n("span",{class:"label"},"修改数额:",-1)),r(s,{modelValue:$e.value,"onUpdate:modelValue":a[32]||(a[32]=e=>$e.value=e),placeholder:"请输入",style:{width:"200px"},clearable:""},{append:d(()=>[...a[60]||(a[60]=[v("元",-1)])]),_:1},8,["modelValue"])]),n("div",we,[a[62]||(a[62]=n("span",{class:"label"},"修改后余额:",-1)),n("span",ye,y(Fe.value)+"元",1)])])]),_:1},8,["modelValue"]),r(Pa,{modelValue:Be.value,"onUpdate:modelValue":a[35]||(a[35]=e=>Be.value=e),title:"产品配置",direction:"rtl",size:"60%","before-close":ca},{footer:d(()=>[n("div",ke,[r(Ge,{onClick:ca},{default:d(()=>[...a[69]||(a[69]=[v("取消",-1)])]),_:1}),r(Ge,{type:"primary",onClick:fa,loading:He.value},{default:d(()=>[...a[70]||(a[70]=[v(" 保存配置 ",-1)])]),_:1},8,["loading"])])]),default:d(()=>[n("div",Ve,[n("div",Ne,[a[65]||(a[65]=n("h4",null,"客户信息",-1)),r(Ta,{column:2,border:""},{default:d(()=>[r(xa,{label:"客户ID"},{default:d(()=>[v(y(qe.value.customerId),1)]),_:1}),r(xa,{label:"客户昵称"},{default:d(()=>[v(y(qe.value.customerName),1)]),_:1}),r(xa,{label:"商户号"},{default:d(()=>[v(y(qe.value.merchantNo),1)]),_:1}),r(xa,{label:"客户邮箱"},{default:d(()=>[v(y(qe.value.customerEmail),1)]),_:1})]),_:1})]),n("div",Ce,[n("div",Se,[a[67]||(a[67]=n("h4",null,"卡密产品配置",-1)),r(Ge,{type:"primary",icon:u(g),onClick:ia},{default:d(()=>[...a[66]||(a[66]=[v(" 新增产品 ",-1)])]),_:1},8,["icon"])]),b((t(),w(_a,{data:Le.value,border:"",stripe:""},{default:d(()=>[r(ua,{prop:"productCode",label:"产品编码",width:"120"}),r(ua,{label:"产品名称","min-width":"150"},{default:d(({row:e})=>[n("span",null,y(e.productName),1)]),_:1}),r(ua,{label:"面值",width:"160",align:"center"},{default:d(({row:e})=>[n("span",null,"¥"+y(e.faceValue),1)]),_:1}),r(ua,{label:"折扣比例",width:"180",align:"center"},{default:d(({row:e})=>[r(Ia,{modelValue:e.discountRate,"onUpdate:modelValue":a=>e.discountRate=a,min:0,step:.01,precision:2,placeholder:"请输入",size:"small",style:{width:"120px"},onChange:e=>{}},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),r(ua,{label:"启用状态",width:"100",align:"center"},{default:d(({row:e})=>[r(Ca,{modelValue:e.enabled,"onUpdate:modelValue":a=>e.enabled=a,onChange:a=>(e=>{z.success(`${e.productName} ${e.enabled?"已启用":"已禁用"}`)})(e)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),r(ua,{label:"操作",width:"100",align:"center"},{default:d(({row:e,$index:l})=>[r(Ge,{type:"danger",link:"",icon:u(S),onClick:e=>{return a=l,void(Le.value.length<=1?z.warning("至少需要保留一个产品配置"):(Le.value.splice(a,1),z.success("产品配置已删除")));var a},size:"small"},{default:d(()=>[...a[68]||(a[68]=[v(" 删除 ",-1)])]),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[Ua,je.value]])])])]),_:1},8,["modelValue"]),r(Na,{modelValue:Qe.value,"onUpdate:modelValue":a[37]||(a[37]=e=>Qe.value=e),title:"选择产品配置",width:"600px","before-close":ma},{footer:d(()=>[n("div",Pe,[r(Ge,{onClick:ma},{default:d(()=>[...a[72]||(a[72]=[v("取消",-1)])]),_:1}),r(Ge,{type:"primary",onClick:pa,disabled:0===Je.value.length},{default:d(()=>[v(" 确认选择 ("+y(Je.value.length)+") ",1)]),_:1},8,["disabled"])])]),default:d(()=>[n("div",xe,[r(ra,{"label-width":"100px"},{default:d(()=>[r(c,{label:"产品配置："},{default:d(()=>[r(za,{modelValue:Je.value,"onUpdate:modelValue":a[36]||(a[36]=e=>Je.value=e),options:We.value,props:ea,multiple:"",filterable:"",placeholder:"请选择产品和面值",style:{width:"100%"},loading:Ze.value,clearable:""},null,8,["modelValue","options","loading"])]),_:1}),Je.value.length>0?(t(),o("div",Te,[a[71]||(a[71]=n("div",{class:"summary-title"},"已选择的配置：",-1)),n("div",Ie,[(t(!0),o(T,null,I(Je.value.map(e=>{if(2===e.length){const[a,l]=e,t=Xe.value.find(e=>e.productId===a),o=l.split("-")[1];return`${(null==t?void 0:t.productName)||a} - ${o}元`}return e.join(" - ")}),(e,a)=>(t(),w(sa,{key:a,type:"info",size:"small",style:{margin:"2px 4px 2px 0"}},{default:d(()=>[v(y(e),1)]),_:2},1024))),128))])])):P("",!0)]),_:1})])]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-58915041"]]),Ue={class:"product-management"},De={class:"filter-line"},Ae={class:"filter-line"},Me={class:"filter-buttons"},Ee={class:"table-toolbar"},Oe={class:"left"},Ye={class:"operation-buttons"},Ke={class:"pagination-container"},Re={class:"dialog-footer"},$e={class:"dialog-footer"},Fe=e({__name:"CardManagement",setup(e){const i=s(!1),m=s(!1),_=c({productId:"",productName:""}),V=s([{productId:"PD1001",productName:"电话卡套餐A",faceValue:"10",productLink:"xxxxxx",soldCount:"1 / 1",createTime:"2025-02-25 14:32:33"},{productId:"PD1002",productName:"流量卡套餐B",faceValue:"20",productLink:"www.baidu.com",soldCount:"0 / 100",createTime:"2025-02-25 18:08:34"},{productId:"PD1003",productName:"游戏卡套餐C",faceValue:"50",productLink:"www",soldCount:"0 / 100",createTime:"2025-02-25 18:09:54"}]),C=c({currentPage:1,pageSize:10,total:3}),k=s(!1),x=s(),T=c({productName:""}),I={productName:[{required:!0,message:"请输入产品名称",trigger:"blur"}]},P=s(!1),U=s(),D=c({productId:"",productName:""}),A={productName:[{required:!0,message:"请输入产品名称",trigger:"blur"}]},M=()=>{},E=()=>{Object.assign(_,{productId:"",productName:""})},O=()=>{k.value=!0,Object.assign(T,{productName:""})},Y=async()=>{try{await x.value.validate(),z.success("新建产品成功"),k.value=!1}catch(e){}},K=async()=>{try{await U.value.validate(),z.success("编辑产品成功"),P.value=!1}catch(e){}},R=e=>{C.pageSize=e},$=e=>{C.currentPage=e};return a(()=>{}),(e,a)=>{const s=l("el-input"),c=l("el-form-item"),F=l("el-icon"),B=l("el-button"),j=l("el-form"),H=l("el-card"),q=l("el-table-column"),L=l("el-popconfirm"),Q=l("el-table"),G=l("el-pagination"),J=l("el-divider"),X=l("el-dialog"),Z=p("loading");return t(),o("div",Ue,[r(H,{shadow:"never",class:"filter-container"},{default:d(()=>[r(j,{model:_,class:"multi-line-filter-form"},{default:d(()=>[n("div",De,[r(c,{label:"产品编码：",prop:"productId"},{default:d(()=>[r(s,{modelValue:_.productId,"onUpdate:modelValue":a[0]||(a[0]=e=>_.productId=e),placeholder:"请输入产品编码",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),r(c,{label:"产品名称：",prop:"productName"},{default:d(()=>[r(s,{modelValue:_.productName,"onUpdate:modelValue":a[1]||(a[1]=e=>_.productName=e),placeholder:"请输入产品名称",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1})]),n("div",Ae,[n("div",Me,[r(B,{type:"primary",onClick:M,loading:m.value},{default:d(()=>[r(F,null,{default:d(()=>[r(u(f))]),_:1}),a[11]||(a[11]=v(" 查询 ",-1))]),_:1},8,["loading"]),r(B,{plain:"",onClick:E},{default:d(()=>[r(F,null,{default:d(()=>[r(u(h))]),_:1}),a[12]||(a[12]=v(" 重置 ",-1))]),_:1})])])]),_:1},8,["model"])]),_:1}),r(H,null,{default:d(()=>[n("div",Ee,[n("div",Oe,[r(B,{type:"primary",icon:u(g),onClick:O},{default:d(()=>[...a[13]||(a[13]=[v("新建产品",-1)])]),_:1},8,["icon"])])]),b((t(),w(Q,{data:V.value,style:{width:"100%"}},{default:d(()=>[r(q,{prop:"productId",label:"产品编码",width:"120"}),r(q,{prop:"productName",label:"产品名称","min-width":"150"},{default:d(({row:e,$index:a})=>[n("span",null,"产品"+y(String.fromCharCode(65+a)),1)]),_:1}),r(q,{prop:"createTime",label:"创建时间",width:"160"}),r(q,{label:"操作",width:"160",fixed:"right"},{default:d(({row:e})=>[n("div",Ye,[r(B,{link:"",type:"primary",icon:u(N),onClick:a=>(e=>{P.value=!0,Object.assign(D,{productId:e.productId,productName:e.productName})})(e)},{default:d(()=>[...a[14]||(a[14]=[v("编辑",-1)])]),_:2},1032,["icon","onClick"]),r(L,{title:"请解绑所有关联此产品的商户后操作",onConfirm:e=>{z.success("删除成功")}},{reference:d(()=>[r(B,{link:"",type:"danger",icon:u(S)},{default:d(()=>[...a[15]||(a[15]=[v("删除",-1)])]),_:1},8,["icon"])]),_:2},1032,["onConfirm"])])]),_:1})]),_:1},8,["data"])),[[Z,i.value]]),n("div",Ke,[r(G,{"current-page":C.currentPage,"onUpdate:currentPage":a[2]||(a[2]=e=>C.currentPage=e),"page-size":C.pageSize,"onUpdate:pageSize":a[3]||(a[3]=e=>C.pageSize=e),"page-sizes":[10,20,50,100],total:C.total,layout:"total, sizes, prev, pager, next",onSizeChange:R,onCurrentChange:$},null,8,["current-page","page-size","total"])])]),_:1}),r(X,{modelValue:k.value,"onUpdate:modelValue":a[6]||(a[6]=e=>k.value=e),title:"新建产品",width:"600px"},{footer:d(()=>[n("div",Re,[r(B,{onClick:a[5]||(a[5]=e=>k.value=!1)},{default:d(()=>[...a[17]||(a[17]=[v("取消",-1)])]),_:1}),r(B,{type:"primary",onClick:Y},{default:d(()=>[...a[18]||(a[18]=[v("确定",-1)])]),_:1})])]),default:d(()=>[r(j,{ref_key:"addFormRef",ref:x,model:T,rules:I,"label-width":"100px","label-position":"right"},{default:d(()=>[r(J,{"content-position":"left"},{default:d(()=>[...a[16]||(a[16]=[v("产品信息",-1)])]),_:1}),r(c,{label:"产品名称",prop:"productName"},{default:d(()=>[r(s,{modelValue:T.productName,"onUpdate:modelValue":a[4]||(a[4]=e=>T.productName=e),placeholder:"请输入产品名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),r(X,{modelValue:P.value,"onUpdate:modelValue":a[10]||(a[10]=e=>P.value=e),title:"编辑产品",width:"500px"},{footer:d(()=>[n("div",$e,[r(B,{onClick:a[9]||(a[9]=e=>P.value=!1)},{default:d(()=>[...a[19]||(a[19]=[v("取消",-1)])]),_:1}),r(B,{type:"primary",onClick:K},{default:d(()=>[...a[20]||(a[20]=[v("确定",-1)])]),_:1})])]),default:d(()=>[r(j,{ref_key:"editFormRef",ref:U,model:D,rules:A,"label-width":"100px","label-position":"right"},{default:d(()=>[r(c,{label:"产品编码",prop:"productId"},{default:d(()=>[r(s,{modelValue:D.productId,"onUpdate:modelValue":a[7]||(a[7]=e=>D.productId=e),placeholder:"产品编码",readonly:"",disabled:""},null,8,["modelValue"])]),_:1}),r(c,{label:"产品名称",prop:"productName"},{default:d(()=>[r(s,{modelValue:D.productName,"onUpdate:modelValue":a[8]||(a[8]=e=>D.productName=e),placeholder:"请输入产品名称",clearable:""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-4888b87b"]]),Be={class:"page-container"},je={class:"filter-line"},He={class:"filter-line"},qe={class:"filter-line"},Le={class:"filter-line"},Qe={class:"filter-buttons"},Ge={class:"table-toolbar"},Je={class:"toolbar-left"},Xe={class:"toolbar-right"},Ze={class:"order-info"},We={class:"order-id"},ea={class:"system-id"},aa={class:"merchant-info"},la={class:"merchant-id"},ta={class:"merchant-code"},oa={class:"merchant-name"},ra={class:"card-info"},da={class:"card-number"},na={class:"card-password"},ua={class:"pagination-container"},ia=e({__name:"OrderManagement",setup(e){const i=s(!1),f=s(!1),g=s([]),_=c({orderNo:"",productName:"",transactionStatus:"",verificationStatus:"",withdrawalTime:[],merchantOrderNo:"",systemOrderNo:"",faceValue:"",cardNo:"",merchantCode:"",merchantName:""}),V=c({currentPage:1,pageSize:20,total:0}),N=m(()=>g.value.some(e=>"verified"!==e.verificationStatus&&"locked"!==e.verificationStatus)),C=m(()=>g.value.some(e=>"locked"===e.verificationStatus)),S=m(()=>g.value.filter(e=>"verified"!==e.verificationStatus&&"locked"!==e.verificationStatus).length),k=m(()=>g.value.filter(e=>"locked"===e.verificationStatus).length),x=s([{label:"产品A",value:"产品A"},{label:"产品B",value:"产品B"},{label:"产品C",value:"产品C"},{label:"产品D",value:"产品D"}]),P=s([]);V.total=P.value.length;const D=e=>({success:"处理成功",processing:"处理中",failed:"处理失败"}[e]||"未知状态"),A=e=>({verified:"已核销",unverified:"未核销",locked:"已锁定"}[e]||"未知状态"),M=async()=>{try{i.value=!0,await new Promise(e=>setTimeout(e,500));let e=j;if(_.cardNo&&_.cardNo.trim()){const a=_.cardNo.split("\n").map(e=>e.trim()).filter(e=>e.length>0);a.length>0&&(e=e.filter(e=>a.some(a=>e.cardNumber&&e.cardNumber.includes(a))))}_.orderNo&&(e=e.filter(e=>e.orderNo&&e.orderNo.includes(_.orderNo))),_.productName&&(e=e.filter(e=>e.productName&&e.productName.includes(_.productName))),_.transactionStatus&&(e=e.filter(e=>e.transactionStatus===_.transactionStatus)),_.verificationStatus&&(e=e.filter(e=>e.verificationStatus===_.verificationStatus)),_.merchantOrderNo&&(e=e.filter(e=>e.merchantOrderNo&&e.merchantOrderNo.includes(_.merchantOrderNo))),_.systemOrderNo&&(e=e.filter(e=>e.systemId&&e.systemId.includes(_.systemOrderNo))),_.faceValue&&(e=e.filter(e=>e.faceValue&&e.faceValue.toString().includes(_.faceValue))),_.merchantCode&&(e=e.filter(e=>e.merchantCode&&e.merchantCode.includes(_.merchantCode))),_.merchantName&&(e=e.filter(e=>e.merchantName&&e.merchantName.includes(_.merchantName))),V.total=e.length;const a=(V.currentPage-1)*V.pageSize,l=a+V.pageSize;P.value=e.slice(a,l)}catch(e){z.error("加载数据失败")}finally{i.value=!1}},E=async()=>{V.currentPage=1,await M()},O=()=>{Object.assign(_,{orderNo:"",productName:"",transactionStatus:"",verificationStatus:"",withdrawalTime:[],merchantOrderNo:"",systemOrderNo:"",faceValue:"",cardNo:""}),V.currentPage=1,M()},Y=async()=>{await M()},K=e=>{g.value=e},R=async()=>{if(0===g.value.length)return void z.warning("请选择要锁卡的记录");const e=g.value.filter(e=>"verified"!==e.verificationStatus&&"locked"!==e.verificationStatus);if(0!==e.length)try{await U.confirm(`确定要锁定选中的 ${e.length} 张卡吗？`,"批量锁卡确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await new Promise(e=>setTimeout(e,1e3)),e.forEach(e=>{e.verificationStatus="locked"}),z.success(`成功锁定 ${e.length} 张卡`),g.value=[]}catch(a){"cancel"!==a&&z.error("批量锁卡失败")}else z.warning("选中的记录中没有可锁卡的项目")},$=async()=>{if(0===g.value.length)return void z.warning("请选择要解锁的记录");const e=g.value.filter(e=>"locked"===e.verificationStatus);if(0!==e.length)try{await U.confirm(`确定要解锁选中的 ${e.length} 张卡吗？`,"批量解锁确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await new Promise(e=>setTimeout(e,1e3)),e.forEach(e=>{e.verificationStatus="unverified"}),z.success(`成功解锁 ${e.length} 张卡`),g.value=[]}catch(a){"cancel"!==a&&z.error("批量解锁失败")}else z.warning("选中的记录中没有可解锁的项目")},F=e=>{V.pageSize=e,V.currentPage=1,M()},B=e=>{V.currentPage=e,M()},j=[{id:1,orderNo:"ORD20241201001",systemId:"SYS001",productName:"产品A",cardNumber:"1234-5678-9012-3456",cardPassword:"ABC123DEF456",transactionAmount:100,transactionQuantity:1,transactionStatus:"success",withdrawalTime:"2024-12-01 10:30:00",verificationStatus:"verified",withdrawalTimestamp:1733025e3,faceValue:100,merchantOrderNo:"MERCH001",systemOrderNo:"SYS001",merchantId:"M001",merchantCode:"MC001",merchantName:"阿里巴巴"},{id:2,orderNo:"ORD20241201002",systemId:"SYS002",productName:"产品B",cardNumber:"9876-5432-1098-7654",cardPassword:"XYZ789GHI012",transactionAmount:50,transactionQuantity:1,transactionStatus:"processing",withdrawalTime:"2024-12-01 11:15:00",verificationStatus:"unverified",withdrawalTimestamp:1733027700,faceValue:50,merchantOrderNo:"MERCH002",systemOrderNo:"SYS002",merchantId:"M002",merchantCode:"MC002",merchantName:"腾讯科技"},{id:3,orderNo:"ORD20241201003",systemId:"SYS003",productName:"产品C",cardNumber:"1111-2222-3333-4444",cardPassword:"DEF456GHI789",transactionAmount:30,transactionQuantity:1,transactionStatus:"success",withdrawalTime:"2024-12-01 12:00:00",verificationStatus:"locked",withdrawalTimestamp:1733030400,faceValue:30,merchantOrderNo:"MERCH003",systemOrderNo:"SYS003",merchantId:"M003",merchantCode:"MC003",merchantName:"字节跳动"},{id:4,orderNo:"ORD20241201004",systemId:"SYS004",productName:"产品D",cardNumber:"5555-6666-7777-8888",cardPassword:"JKL012MNO345",transactionAmount:20,transactionQuantity:1,transactionStatus:"success",withdrawalTime:"2024-12-01 13:30:00",verificationStatus:"unverified",withdrawalTimestamp:1733035800,faceValue:20,merchantOrderNo:"MERCH004",systemOrderNo:"SYS004",merchantId:"M004",merchantCode:"MC004",merchantName:"美团科技"}];return a(()=>{M()}),(e,a)=>{const s=l("el-input"),c=l("el-form-item"),m=l("el-option"),g=l("el-select"),U=l("el-date-picker"),M=l("el-button"),j=l("el-form"),H=l("el-card"),q=l("el-table-column"),L=l("el-tag"),Q=l("el-switch"),G=l("el-table"),J=l("el-pagination"),X=p("loading");return t(),o("div",Be,[r(H,{shadow:"never",class:"filter-container"},{default:d(()=>[r(j,{model:_,inline:"",class:"multi-line-filter-form"},{default:d(()=>[n("div",je,[r(c,{label:"订单号：",prop:"orderNo"},{default:d(()=>[r(s,{modelValue:_.orderNo,"onUpdate:modelValue":a[0]||(a[0]=e=>_.orderNo=e),placeholder:"请输入订单号",clearable:"",style:{width:"220px"}},null,8,["modelValue"])]),_:1}),r(c,{label:"产品：",prop:"productName"},{default:d(()=>[r(g,{modelValue:_.productName,"onUpdate:modelValue":a[1]||(a[1]=e=>_.productName=e),placeholder:"请选择产品",clearable:"",style:{width:"168px"}},{default:d(()=>[(t(!0),o(T,null,I(x.value,e=>(t(),w(m,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),r(c,{label:"交易状态：",prop:"transactionStatus"},{default:d(()=>[r(g,{modelValue:_.transactionStatus,"onUpdate:modelValue":a[2]||(a[2]=e=>_.transactionStatus=e),placeholder:"请选择交易状态",clearable:"",style:{width:"168px"}},{default:d(()=>[r(m,{label:"处理成功",value:"success"}),r(m,{label:"处理中",value:"processing"}),r(m,{label:"处理失败",value:"failed"})]),_:1},8,["modelValue"])]),_:1}),r(c,{label:"核销状态：",prop:"verificationStatus"},{default:d(()=>[r(g,{modelValue:_.verificationStatus,"onUpdate:modelValue":a[3]||(a[3]=e=>_.verificationStatus=e),placeholder:"请选择核销状态",clearable:"",style:{width:"168px"}},{default:d(()=>[r(m,{label:"已核销",value:"verified"}),r(m,{label:"未核销",value:"unverified"}),r(m,{label:"已锁定",value:"locked"})]),_:1},8,["modelValue"])]),_:1}),r(c,{label:"商户号：",prop:"merchantCode"},{default:d(()=>[r(s,{modelValue:_.merchantCode,"onUpdate:modelValue":a[4]||(a[4]=e=>_.merchantCode=e),placeholder:"请输入商户号",clearable:"",style:{width:"168px"}},null,8,["modelValue"])]),_:1})]),n("div",He,[r(c,{label:"提卡时间：",prop:"withdrawalTime"},{default:d(()=>[r(U,{modelValue:_.withdrawalTime,"onUpdate:modelValue":a[5]||(a[5]=e=>_.withdrawalTime=e),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",style:{width:"350px"}},null,8,["modelValue"])]),_:1}),r(c,{label:"商户单号：",prop:"merchantOrderNo"},{default:d(()=>[r(s,{modelValue:_.merchantOrderNo,"onUpdate:modelValue":a[6]||(a[6]=e=>_.merchantOrderNo=e),placeholder:"请输入商户单号",clearable:"",style:{width:"220px"}},null,8,["modelValue"])]),_:1}),r(c,{label:"系统单号：",prop:"systemOrderNo"},{default:d(()=>[r(s,{modelValue:_.systemOrderNo,"onUpdate:modelValue":a[7]||(a[7]=e=>_.systemOrderNo=e),placeholder:"请输入系统单号",clearable:"",style:{width:"220px"}},null,8,["modelValue"])]),_:1}),r(c,{label:"商户名称：",prop:"merchantName"},{default:d(()=>[r(s,{modelValue:_.merchantName,"onUpdate:modelValue":a[8]||(a[8]=e=>_.merchantName=e),placeholder:"请输入商户名称",clearable:"",style:{width:"168px"}},null,8,["modelValue"])]),_:1})]),n("div",qe,[r(c,{label:"面值：",prop:"faceValue"},{default:d(()=>[r(g,{modelValue:_.faceValue,"onUpdate:modelValue":a[9]||(a[9]=e=>_.faceValue=e),placeholder:"请选择面值",clearable:"",style:{width:"168px"}},{default:d(()=>[r(m,{label:"10元",value:"10"}),r(m,{label:"20元",value:"20"}),r(m,{label:"30元",value:"30"}),r(m,{label:"50元",value:"50"}),r(m,{label:"100元",value:"100"})]),_:1},8,["modelValue"])]),_:1})]),n("div",Le,[r(c,{label:"卡号：",prop:"cardNo"},{default:d(()=>[r(s,{modelValue:_.cardNo,"onUpdate:modelValue":a[10]||(a[10]=e=>_.cardNo=e),type:"textarea",placeholder:"请输入卡号，多个卡号请换行分隔",rows:3,autosize:{minRows:3,maxRows:6},style:{width:"300px"}},null,8,["modelValue"])]),_:1}),n("div",Qe,[r(M,{type:"primary",onClick:E,loading:f.value},{default:d(()=>[...a[13]||(a[13]=[v("查询",-1)])]),_:1},8,["loading"]),r(M,{plain:"",onClick:O},{default:d(()=>[...a[14]||(a[14]=[v("重置",-1)])]),_:1})])])]),_:1},8,["model"])]),_:1}),r(H,null,{default:d(()=>[n("div",Ge,[n("div",Je,[r(M,{type:"primary",disabled:!N.value,onClick:R},{default:d(()=>[v(" 锁卡 ("+y(S.value)+") ",1)]),_:1},8,["disabled"]),r(M,{type:"warning",disabled:!C.value,onClick:$},{default:d(()=>[v(" 解锁 ("+y(k.value)+") ",1)]),_:1},8,["disabled"])]),n("div",Xe,[r(M,{icon:u(h),onClick:Y},{default:d(()=>[...a[15]||(a[15]=[v("刷新",-1)])]),_:1},8,["icon"])])]),b((t(),w(G,{data:P.value,border:"",stripe:"",style:{"margin-top":"16px",width:"100%"},onSelectionChange:K},{default:d(()=>[r(q,{type:"selection",width:"55"}),r(q,{prop:"orderNo",label:"订单号","min-width":"180"},{default:d(({row:e})=>[n("div",Ze,[n("div",We,y(e.orderNo),1),n("div",ea,y(e.systemId),1)])]),_:1}),r(q,{prop:"merchantInfo",label:"商户信息","min-width":"200"},{default:d(({row:e})=>[n("div",aa,[n("div",la,y(e.merchantId),1),n("div",ta,y(e.merchantCode),1),n("div",oa,y(e.merchantName),1)])]),_:1}),r(q,{prop:"productName",label:"产品","min-width":"150"},{default:d(({row:e,$index:a})=>[n("span",null,"产品"+y(String.fromCharCode(65+a))+"-["+y(e.faceValue)+"]",1)]),_:1}),r(q,{prop:"cardInfo",label:"卡密","min-width":"200"},{default:d(({row:e})=>[n("div",ra,[n("div",da,y(e.cardNumber),1),n("div",na,y(e.cardPassword),1)])]),_:1}),r(q,{prop:"transactionAmount",label:"交易金额","min-width":"100"},{default:d(({row:e})=>[v(" ¥"+y(e.transactionAmount),1)]),_:1}),r(q,{prop:"transactionQuantity",label:"交易数量","min-width":"100"}),r(q,{prop:"transactionStatus",label:"交易状态","min-width":"120"},{default:d(({row:e})=>{return[r(L,{type:(a=e.transactionStatus,{success:"success",processing:"warning",failed:"danger"}[a]||"info"),size:"small"},{default:d(()=>[v(y(D(e.transactionStatus)),1)]),_:2},1032,["type"])];var a}),_:1}),r(q,{prop:"withdrawalTime",label:"提卡时间","min-width":"160"}),r(q,{prop:"verificationStatus",label:"核销状态","min-width":"120"},{default:d(({row:e})=>{return[r(L,{type:(a=e.verificationStatus,{verified:"success",unverified:"warning",locked:"danger"}[a]||"info"),size:"small"},{default:d(()=>[v(y(A(e.verificationStatus)),1)]),_:2},1032,["type"])];var a}),_:1}),r(q,{label:"锁卡开关","min-width":"100",align:"center",fixed:"right"},{default:d(({row:e})=>[r(Q,{"model-value":"locked"===e.verificationStatus,disabled:"verified"===e.verificationStatus,onChange:a=>(async(e,a)=>{try{await new Promise(e=>setTimeout(e,300)),e.verificationStatus=a?"locked":"unverified",z.success(a?"锁卡成功":"解锁成功")}catch(l){z.error(a?"锁卡失败":"解锁失败")}})(e,a),"active-text":"","inactive-text":"","active-color":"verified"===e.verificationStatus?"#C0C4CC":"#13CE66","inactive-color":"verified"===e.verificationStatus?"#C0C4CC":"#DCDFE6"},null,8,["model-value","disabled","onChange","active-color","inactive-color"])]),_:1}),r(q,{prop:"withdrawalTimestamp",label:"核销时间","min-width":"180"},{default:d(({row:e})=>{return[v(y((a=e.withdrawalTimestamp,a?new Date(a).toLocaleString("zh-CN"):"-")),1)];var a}),_:1})]),_:1},8,["data"])),[[X,i.value]]),n("div",ua,[r(J,{"current-page":V.currentPage,"onUpdate:currentPage":a[11]||(a[11]=e=>V.currentPage=e),"page-size":V.pageSize,"onUpdate:pageSize":a[12]||(a[12]=e=>V.pageSize=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:V.total,onSizeChange:F,onCurrentChange:B},null,8,["current-page","page-size","total"])])]),_:1})])}}},[["__scopeId","data-v-85087fd3"]]),sa={class:"page-container"},ca={class:"filter-line"},ma={class:"filter-line"},pa={class:"filter-line"},fa={class:"filter-buttons"},va={class:"table-toolbar"},ha={class:"toolbar-right"},ga={class:"product-info"},ba={class:"product-name"},wa={class:"product-code"},ya={class:"card-info"},_a={class:"card-number"},Va={class:"card-password"},Na={class:"time-info"},Ca={class:"order-time"},Sa={class:"verification-time"},ka={class:"pagination-container"},xa=e({__name:"VerificationOrderManagement",setup(e){const i=s(!1),m=s(!1),f=c({orderNo:"",product:"",orderValue:"",cardNo:"",orderTime:[],verificationTime:[]}),g=c({currentPage:1,pageSize:20,total:0}),_=s([{id:1,orderNo:"SF20241201001",productName:"产品A-[100]",productCode:"PROD_A_100",orderValue:100,cardNumber:"1234-5678-9012-3456",cardPassword:"ABC123DEF456",orderTime:"2024-12-01 10:30:00",verificationTime:"2024-12-01 11:00:00",verificationStatus:"verified"},{id:2,orderNo:"SF20241201002",productName:"产品A-[50]",productCode:"PROD_A_50",orderValue:50,cardNumber:"9876-5432-1098-7654",cardPassword:"XYZ789GHI012",orderTime:"2024-12-01 11:15:00",verificationTime:null,verificationStatus:"unverified"},{id:3,orderNo:"SF20241201003",productName:"产品A-[20]",productCode:"PROD_A_20",orderValue:20,cardNumber:"5555-4444-3333-2222",cardPassword:"DEF456GHI789",orderTime:"2024-12-01 12:00:00",verificationTime:null,verificationStatus:"locked"},{id:4,orderNo:"SF20241201004",productName:"产品A-[200]",productCode:"PROD_A_200",orderValue:200,cardNumber:"1111-2222-3333-4444",cardPassword:"MNO345PQR678",orderTime:"2024-12-01 13:00:00",verificationTime:"2024-12-01 13:45:00",verificationStatus:"verified"}]);g.total=_.value.length;const V=()=>{m.value=!0,setTimeout(()=>{m.value=!1,z.success("查询完成")},1e3)},N=[{label:"产品A",value:"产品A"},{label:"产品B",value:"产品B"},{label:"产品C",value:"产品C"},{label:"产品D",value:"产品D"}],C=()=>{Object.keys(f).forEach(e=>{Array.isArray(f[e])?f[e]=[]:f[e]=""}),z.info("筛选条件已重置")},S=()=>{i.value=!0,setTimeout(()=>{i.value=!1,z.success("数据已刷新")},1e3)},k=e=>{g.pageSize=e,g.currentPage=1},x=e=>{g.currentPage=e},D=e=>({verified:"已核销",unverified:"未核销",locked:"已锁定"}[e]||"未知状态"),A=e=>"unverified"===e.verificationStatus||"locked"===e.verificationStatus?"":e.verificationTime||"";return a(()=>{}),(e,a)=>{const s=l("el-input"),c=l("el-form-item"),M=l("el-option"),E=l("el-select"),O=l("el-date-picker"),Y=l("el-button"),K=l("el-form"),R=l("el-card"),$=l("el-table-column"),F=l("el-tag"),B=l("el-table"),j=l("el-pagination"),H=p("loading");return t(),o("div",sa,[r(R,{shadow:"never",class:"filter-container"},{default:d(()=>[r(K,{model:f,inline:"",class:"multi-line-filter-form"},{default:d(()=>[n("div",ca,[r(c,{label:"订单号：",prop:"orderNo"},{default:d(()=>[r(s,{modelValue:f.orderNo,"onUpdate:modelValue":a[0]||(a[0]=e=>f.orderNo=e),placeholder:"请输入订单号",clearable:"",style:{width:"220px"}},null,8,["modelValue"])]),_:1}),r(c,{label:"产品：",prop:"product"},{default:d(()=>[r(E,{modelValue:f.product,"onUpdate:modelValue":a[1]||(a[1]=e=>f.product=e),placeholder:"请选择产品",clearable:"",style:{width:"168px"}},{default:d(()=>[(t(),o(T,null,I(N,e=>r(M,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),n("div",ma,[r(c,{label:"订单面值：",prop:"orderValue"},{default:d(()=>[r(E,{modelValue:f.orderValue,"onUpdate:modelValue":a[2]||(a[2]=e=>f.orderValue=e),placeholder:"请选择订单面值",clearable:"",style:{width:"168px"}},{default:d(()=>[r(M,{label:"10元",value:"10"}),r(M,{label:"20元",value:"20"}),r(M,{label:"50元",value:"50"}),r(M,{label:"100元",value:"100"})]),_:1},8,["modelValue"])]),_:1}),r(c,{label:"卡号：",prop:"cardNo"},{default:d(()=>[r(s,{modelValue:f.cardNo,"onUpdate:modelValue":a[3]||(a[3]=e=>f.cardNo=e),placeholder:"请输入卡号",clearable:"",style:{width:"220px"}},null,8,["modelValue"])]),_:1})]),n("div",pa,[r(c,{label:"下单时间：",prop:"orderTime"},{default:d(()=>[r(O,{modelValue:f.orderTime,"onUpdate:modelValue":a[4]||(a[4]=e=>f.orderTime=e),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",style:{width:"350px"}},null,8,["modelValue"])]),_:1}),r(c,{label:"核销时间：",prop:"verificationTime"},{default:d(()=>[r(O,{modelValue:f.verificationTime,"onUpdate:modelValue":a[5]||(a[5]=e=>f.verificationTime=e),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",style:{width:"350px"}},null,8,["modelValue"])]),_:1}),n("div",fa,[r(Y,{type:"primary",onClick:V,loading:m.value},{default:d(()=>[...a[8]||(a[8]=[v("查询",-1)])]),_:1},8,["loading"]),r(Y,{plain:"",onClick:C},{default:d(()=>[...a[9]||(a[9]=[v("重置",-1)])]),_:1})])])]),_:1},8,["model"])]),_:1}),r(R,null,{default:d(()=>[n("div",va,[n("div",ha,[r(Y,{icon:u(h),onClick:S},{default:d(()=>[...a[10]||(a[10]=[v("刷新",-1)])]),_:1},8,["icon"])])]),b((t(),w(B,{data:_.value,border:"",stripe:"",style:{"margin-top":"16px",width:"100%"}},{default:d(()=>[r($,{prop:"orderNo",label:"订单号","min-width":"180"},{default:d(({row:e})=>[v(y(e.orderNo),1)]),_:1}),r($,{prop:"productName",label:"产品","min-width":"200"},{default:d(({row:e})=>[n("div",ga,[n("div",ba,y(e.productName),1),n("div",wa,"编码："+y(e.productCode),1)])]),_:1}),r($,{prop:"orderValue",label:"订单面值","min-width":"100"},{default:d(({row:e})=>[v(" ¥"+y(e.orderValue),1)]),_:1}),r($,{prop:"verificationStatus",label:"核销状态","min-width":"100"},{default:d(({row:e})=>{return[r(F,{type:(a=e.verificationStatus,{verified:"success",unverified:"warning",locked:"danger"}[a]||"info")},{default:d(()=>[v(y(D(e.verificationStatus)),1)]),_:2},1032,["type"])];var a}),_:1}),r($,{prop:"cardInfo",label:"卡密信息","min-width":"200"},{default:d(({row:e})=>[n("div",ya,[n("div",_a,y(e.cardNumber),1),n("div",Va,y(e.cardPassword),1)])]),_:1}),r($,{prop:"timeInfo",label:"时间","min-width":"200"},{default:d(({row:e})=>[n("div",Na,[n("div",Ca,"下单："+y(e.orderTime),1),n("div",Sa,"核销："+y(A(e)),1)])]),_:1}),r($,{label:"操作",width:"120",fixed:"right"},{default:d(({row:e})=>["unverified"===e.verificationStatus?(t(),w(Y,{key:0,link:"",type:"primary",onClick:a=>(async e=>{try{await U.confirm("是否人工确定核销此卡密？","核销确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const a=_.value.findIndex(a=>a.id===e.id);-1!==a&&(_.value[a].verificationStatus="verified",_.value[a].verificationTime=(new Date).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(/\//g,"-")),z.success("核销成功")}catch(a){"cancel"!==a&&z.error("核销失败")}})(e)},{default:d(()=>[...a[11]||(a[11]=[v(" 核销 ",-1)])]),_:2},1032,["onClick"])):"verified"===e.verificationStatus?(t(),w(Y,{key:1,link:"",type:"info",onClick:a=>(e=>{z.info(`查看核销日志：${e.orderNo}`)})(e)},{default:d(()=>[...a[12]||(a[12]=[v(" 核销日志 ",-1)])]),_:2},1032,["onClick"])):P("",!0)]),_:1})]),_:1},8,["data"])),[[H,i.value]]),n("div",ka,[r(j,{"current-page":g.currentPage,"onUpdate:currentPage":a[6]||(a[6]=e=>g.currentPage=e),"page-size":g.pageSize,"onUpdate:pageSize":a[7]||(a[7]=e=>g.pageSize=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:g.total,onSizeChange:k,onCurrentChange:x},null,8,["current-page","page-size","total"])])]),_:1})])}}},[["__scopeId","data-v-f9b4a805"]]),Ta={class:"sub-account-management"},Ia={class:"filter-line"},Pa={class:"filter-buttons"},za={class:"pagination-container"},Ua={class:"dialog-footer"},Da={class:"dialog-footer"},Aa=e({__name:"SubAccountManagement",setup(e){const i=c({username:"",status:""}),m=s([{accountId:1,username:"admin",status:"enabled",createTime:"1970-01-01 00:00:00"},{accountId:2,username:"user001",status:"disabled",createTime:"2024-01-15 10:30:00"},{accountId:3,username:"manager",status:"enabled",createTime:"2024-02-20 14:20:00"}]),g=s(!1),_=c({currentPage:1,pageSize:10,total:3}),V=s(!1),C=s(),k=c({username:"",status:"enabled"}),x={username:[{required:!0,message:"请输入用户名",trigger:"blur"}]},T=s(!1),I=s(),P=c({accountId:null,username:"",status:"enabled"}),D={username:[{required:!0,message:"请输入用户名",trigger:"blur"}]};function A(){g.value=!0,setTimeout(()=>{g.value=!1,z.success("搜索完成")},1e3)}function M(){Object.assign(i,{username:"",status:""}),z.info("筛选条件已重置")}function E(e){_.pageSize=e}function O(e){_.currentPage=e}function Y(){C.value.validate(e=>{if(e){const e={accountId:Date.now(),username:k.username,status:k.status,createTime:(new Date).toLocaleString("zh-CN")};m.value.unshift(e),_.total++,V.value=!1,z.success("新增成功")}})}function K(){I.value.validate(e=>{if(e){const e=m.value.findIndex(e=>e.accountId===P.accountId);e>-1&&(m.value[e].username=P.username,m.value[e].status=P.status,T.value=!1,z.success("编辑成功"))}})}return a(()=>{}),(e,a)=>{const s=l("el-input"),c=l("el-form-item"),R=l("el-option"),$=l("el-select"),F=l("el-button"),B=l("el-form"),j=l("el-card"),H=l("el-table-column"),q=l("el-tag"),L=l("el-popconfirm"),Q=l("el-table"),G=l("el-pagination"),J=l("el-switch"),X=l("el-dialog"),Z=p("loading");return t(),o("div",Ta,[r(j,{shadow:"never",class:"filter-container"},{default:d(()=>[r(B,{model:i,class:"multi-line-filter-form"},{default:d(()=>[n("div",Ia,[r(c,{label:"用户名：",prop:"username"},{default:d(()=>[r(s,{modelValue:i.username,"onUpdate:modelValue":a[0]||(a[0]=e=>i.username=e),placeholder:"请输入用户名",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),r(c,{label:"启用状态：",prop:"status"},{default:d(()=>[r($,{modelValue:i.status,"onUpdate:modelValue":a[1]||(a[1]=e=>i.status=e),placeholder:"请选择状态",clearable:"",style:{width:"168px"}},{default:d(()=>[r(R,{label:"启用",value:"1"}),r(R,{label:"禁用",value:"0"})]),_:1},8,["modelValue"])]),_:1}),n("div",Pa,[r(F,{type:"primary",icon:u(f),onClick:A},{default:d(()=>[...a[12]||(a[12]=[v("查询",-1)])]),_:1},8,["icon"]),r(F,{plain:"",icon:u(h),onClick:M},{default:d(()=>[...a[13]||(a[13]=[v("重置",-1)])]),_:1},8,["icon"])])])]),_:1},8,["model"])]),_:1}),r(j,{shadow:"never",class:"table-card"},{default:d(()=>[b((t(),w(Q,{data:m.value,border:"",stripe:"",style:{width:"100%",height:"calc(100vh - 280px)"},height:"calc(100vh - 280px)"},{default:d(()=>[r(H,{prop:"accountId",label:"账户ID",width:"100"}),r(H,{prop:"username",label:"用户名",width:"180"}),r(H,{prop:"status",label:"状态",width:"120",align:"center"},{default:d(({row:e})=>[r(q,{type:"enabled"===e.status?"success":"danger"},{default:d(()=>[v(y("enabled"===e.status?"已启用":"已禁用"),1)]),_:2},1032,["type"])]),_:1}),r(H,{prop:"createTime",label:"创建时间","min-width":"200"}),r(H,{label:"操作",width:"180",fixed:"right"},{default:d(({row:e})=>[r(F,{link:"",type:"primary",icon:u(N),onClick:a=>function(e){Object.assign(P,{accountId:e.accountId,username:e.username,status:e.status}),T.value=!0}(e)},{default:d(()=>[...a[14]||(a[14]=[v("编辑",-1)])]),_:2},1032,["icon","onClick"]),r(L,{title:"确认删除该账户？",onConfirm:a=>function(e){U.confirm(`确定要删除账户 "${e.username}" 吗？`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const a=m.value.findIndex(a=>a.accountId===e.accountId);a>-1&&(m.value.splice(a,1),_.total--,z.success("删除成功"))}).catch(()=>{z.info("已取消删除")})}(e)},{reference:d(()=>[r(F,{link:"",type:"danger",icon:u(S)},{default:d(()=>[...a[15]||(a[15]=[v("删除",-1)])]),_:1},8,["icon"])]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[Z,g.value]]),n("div",za,[r(G,{"current-page":_.currentPage,"onUpdate:currentPage":a[2]||(a[2]=e=>_.currentPage=e),"page-size":_.pageSize,"onUpdate:pageSize":a[3]||(a[3]=e=>_.pageSize=e),"page-sizes":[10,20,50,100],total:_.total,layout:"total, sizes, prev, pager, next",onSizeChange:E,onCurrentChange:O},null,8,["current-page","page-size","total"])])]),_:1}),r(X,{modelValue:V.value,"onUpdate:modelValue":a[7]||(a[7]=e=>V.value=e),title:"新增账户",width:"500px"},{footer:d(()=>[n("div",Ua,[r(F,{onClick:a[6]||(a[6]=e=>V.value=!1)},{default:d(()=>[...a[16]||(a[16]=[v("取消",-1)])]),_:1}),r(F,{type:"primary",onClick:Y},{default:d(()=>[...a[17]||(a[17]=[v("确定",-1)])]),_:1})])]),default:d(()=>[r(B,{ref_key:"addFormRef",ref:C,model:k,rules:x,"label-width":"100px","label-position":"right"},{default:d(()=>[r(c,{label:"用户名",prop:"username"},{default:d(()=>[r(s,{modelValue:k.username,"onUpdate:modelValue":a[4]||(a[4]=e=>k.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),r(c,{label:"启用状态"},{default:d(()=>[r(J,{modelValue:k.status,"onUpdate:modelValue":a[5]||(a[5]=e=>k.status=e),"active-value":"enabled","inactive-value":"disabled"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),r(X,{modelValue:T.value,"onUpdate:modelValue":a[11]||(a[11]=e=>T.value=e),title:"编辑账户",width:"500px"},{footer:d(()=>[n("div",Da,[r(F,{onClick:a[10]||(a[10]=e=>T.value=!1)},{default:d(()=>[...a[18]||(a[18]=[v("取消",-1)])]),_:1}),r(F,{type:"primary",onClick:K},{default:d(()=>[...a[19]||(a[19]=[v("确定",-1)])]),_:1})])]),default:d(()=>[r(B,{ref_key:"editFormRef",ref:I,model:P,rules:D,"label-width":"100px","label-position":"right"},{default:d(()=>[r(c,{label:"用户名",prop:"username"},{default:d(()=>[r(s,{modelValue:P.username,"onUpdate:modelValue":a[8]||(a[8]=e=>P.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),r(c,{label:"启用状态"},{default:d(()=>[r(J,{modelValue:P.status,"onUpdate:modelValue":a[9]||(a[9]=e=>P.status=e),"active-value":"enabled","inactive-value":"disabled"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-f847edc8"]]),Ma={class:"operation-log"},Ea={class:"filter-line"},Oa={class:"filter-buttons"},Ya={class:"pagination-container"},Ka=e({__name:"OperationLog",setup(e){const i=c({username:"",timeRange:[]}),m=s([{accountId:1,username:"admin",operationType:"登录系统",operationTime:"2025-08-21 09:30:15",ipAddress:"192.168.1.100",description:"管理员登录后台管理系统"},{accountId:2,username:"user001",operationType:"查看订单",operationTime:"2025-08-21 10:15:22",ipAddress:"192.168.1.101",description:"查看订单列表，筛选条件：状态为已完成"},{accountId:1,username:"admin",operationType:"创建卡密",operationTime:"2025-08-21 11:20:45",ipAddress:"192.168.1.100",description:"批量创建卡密，数量：100张"},{accountId:3,username:"manager",operationType:"编辑用户",operationTime:"2025-08-21 14:35:18",ipAddress:"192.168.1.102",description:"修改用户权限，用户ID：12345"},{accountId:2,username:"user001",operationType:"导出数据",operationTime:"2025-08-21 15:42:33",ipAddress:"192.168.1.101",description:"导出订单数据，时间范围：2025-08-01至2025-08-21"}]),g=s(!1),y=c({currentPage:1,pageSize:10,total:5});function _(){g.value=!0,setTimeout(()=>{g.value=!1,z.success("搜索完成")},1e3)}function V(){Object.assign(i,{username:"",timeRange:[]}),z.info("筛选条件已重置")}function N(e){y.pageSize=e}function C(e){y.currentPage=e}return a(()=>{}),(e,a)=>{const s=l("el-input"),c=l("el-form-item"),S=l("el-date-picker"),k=l("el-button"),x=l("el-form"),T=l("el-card"),I=l("el-table-column"),P=l("el-table"),z=l("el-pagination"),U=p("loading");return t(),o("div",Ma,[r(T,{shadow:"never",class:"filter-container"},{default:d(()=>[r(x,{model:i,class:"multi-line-filter-form"},{default:d(()=>[n("div",Ea,[r(c,{label:"用户名：",prop:"username"},{default:d(()=>[r(s,{modelValue:i.username,"onUpdate:modelValue":a[0]||(a[0]=e=>i.username=e),placeholder:"请输入用户名",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),r(c,{label:"时间范围：",prop:"timeRange"},{default:d(()=>[r(S,{modelValue:i.timeRange,"onUpdate:modelValue":a[1]||(a[1]=e=>i.timeRange=e),type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),n("div",Oa,[r(k,{type:"primary",icon:u(f),onClick:_},{default:d(()=>[...a[4]||(a[4]=[v("查询",-1)])]),_:1},8,["icon"]),r(k,{plain:"",icon:u(h),onClick:V},{default:d(()=>[...a[5]||(a[5]=[v("重置",-1)])]),_:1},8,["icon"])])])]),_:1},8,["model"])]),_:1}),r(T,null,{default:d(()=>[b((t(),w(P,{data:m.value,border:"",stripe:"",style:{width:"100%"}},{default:d(()=>[r(I,{prop:"accountId",label:"账户ID",width:"100",align:"center"}),r(I,{prop:"username",label:"用户名",width:"120"}),r(I,{prop:"operationType",label:"操作类型",width:"120"}),r(I,{prop:"operationTime",label:"操作时间",width:"180"}),r(I,{prop:"ipAddress",label:"IP地址",width:"140",align:"center"}),r(I,{prop:"description",label:"操作描述","min-width":"250","show-overflow-tooltip":""})]),_:1},8,["data"])),[[U,g.value]]),n("div",Ya,[r(z,{"current-page":y.currentPage,"onUpdate:currentPage":a[2]||(a[2]=e=>y.currentPage=e),"page-size":y.pageSize,"onUpdate:pageSize":a[3]||(a[3]=e=>y.pageSize=e),"page-sizes":[10,20,50,100],total:y.total,layout:"total, sizes, prev, pager, next",onSizeChange:N,onCurrentChange:C},null,8,["current-page","page-size","total"])])]),_:1})])}}},[["__scopeId","data-v-7a303fc9"]]),Ra={class:"reset-password"},$a={class:"form-container"},Fa=e({__name:"ResetPassword",setup(e){const a=s(),u=s(!1),i=c({currentPassword:"",newPassword:"",confirmPassword:""}),m={currentPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"}],newPassword:[{required:!0,validator:(e,l,t)=>{""===l?t(new Error("请输入新密码")):l.length<6?t(new Error("密码长度不能少于6位")):l===i.currentPassword?t(new Error("新密码不能与当前密码相同")):(""!==i.confirmPassword&&a.value.validateField("confirmPassword"),t())},trigger:"blur"}],confirmPassword:[{required:!0,validator:(e,a,l)=>{""===a?l(new Error("请再次输入新密码")):a!==i.newPassword?l(new Error("两次输入密码不一致")):l()},trigger:"blur"}]},p=async()=>{try{await a.value.validate(),u.value=!0,await new Promise(e=>setTimeout(e,1e3)),z.success("密码修改成功"),f()}catch(e){}finally{u.value=!1}},f=()=>{var e;null==(e=a.value)||e.resetFields(),Object.assign(i,{currentPassword:"",newPassword:"",confirmPassword:""})};return(e,s)=>{const c=l("el-input"),h=l("el-form-item"),g=l("el-button"),b=l("el-space"),w=l("el-form"),y=l("el-card");return t(),o("div",Ra,[n("div",$a,[r(y,{class:"form-card"},{default:d(()=>[r(w,{ref_key:"passwordFormRef",ref:a,model:i,rules:m,"label-width":"100px"},{default:d(()=>[r(h,{label:"当前密码",prop:"currentPassword"},{default:d(()=>[r(c,{modelValue:i.currentPassword,"onUpdate:modelValue":s[0]||(s[0]=e=>i.currentPassword=e),type:"password",placeholder:"请输入当前密码","show-password":""},null,8,["modelValue"])]),_:1}),r(h,{label:"新密码",prop:"newPassword"},{default:d(()=>[r(c,{modelValue:i.newPassword,"onUpdate:modelValue":s[1]||(s[1]=e=>i.newPassword=e),type:"password",placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),r(h,{label:"确认新密码",prop:"confirmPassword"},{default:d(()=>[r(c,{modelValue:i.confirmPassword,"onUpdate:modelValue":s[2]||(s[2]=e=>i.confirmPassword=e),type:"password",placeholder:"请再次输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),r(h,null,{default:d(()=>[r(b,null,{default:d(()=>[r(g,{type:"primary",loading:u.value,onClick:p},{default:d(()=>[...s[3]||(s[3]=[v(" 保存 ",-1)])]),_:1},8,["loading"]),r(g,{onClick:f},{default:d(()=>[...s[4]||(s[4]=[v("重置",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])])}}},[["__scopeId","data-v-4a638ec1"]]),Ba={class:"admin-layout"},ja={class:"header-right"},Ha={class:"el-dropdown-link"},qa=e({__name:"AdminLayout",setup(e){const a=s("dashboard"),i=D(H),c={dashboard:H,"customer-management":ze,"card-management":Fe,"order-management":ia,"verification-order-management":xa,"subaccount-management":Aa,"operation-log":Ka,"reset-password":Fa},m=e=>{a.value=e,i.value=c[e]},p=e=>{if("logout"===e)z.success("退出登录成功")};return(e,s)=>{const c=l("el-icon"),f=l("el-dropdown-item"),h=l("el-dropdown-menu"),g=l("el-dropdown"),b=l("el-header"),y=l("el-menu-item"),_=l("el-sub-menu"),V=l("el-menu"),N=l("el-aside"),S=l("el-main"),x=l("el-container");return t(),o("div",Ba,[r(b,{class:"header"},{default:d(()=>[s[2]||(s[2]=n("div",{class:"header-left"},[n("h2",null,"卡密核销系统")],-1)),n("div",ja,[r(g,{onCommand:p},{dropdown:d(()=>[r(h,null,{default:d(()=>[r(f,{command:"logout"},{default:d(()=>[...s[1]||(s[1]=[v("退出登录",-1)])]),_:1})]),_:1})]),default:d(()=>[n("span",Ha,[s[0]||(s[0]=v(" admin ",-1)),r(c,{class:"el-icon--right"},{default:d(()=>[r(u(k))]),_:1})])]),_:1})])]),_:1}),r(x,null,{default:d(()=>[r(N,{width:"200px",class:"sidebar"},{default:d(()=>[r(V,{"default-active":a.value,class:"el-menu-vertical",onSelect:m},{default:d(()=>[r(y,{index:"dashboard"},{default:d(()=>[r(c,null,{default:d(()=>[r(u(A))]),_:1}),s[3]||(s[3]=n("span",null,"仪表盘",-1))]),_:1}),r(y,{index:"customer-management"},{default:d(()=>[r(c,null,{default:d(()=>[r(u(M))]),_:1}),s[4]||(s[4]=n("span",null,"客户管理",-1))]),_:1}),r(y,{index:"card-management"},{default:d(()=>[r(c,null,{default:d(()=>[r(u(E))]),_:1}),s[5]||(s[5]=n("span",null,"产品管理",-1))]),_:1}),r(y,{index:"order-management"},{default:d(()=>[r(c,null,{default:d(()=>[r(u(O))]),_:1}),s[6]||(s[6]=n("span",null,"提卡订单",-1))]),_:1}),r(y,{index:"verification-order-management"},{default:d(()=>[r(c,null,{default:d(()=>[r(u(O))]),_:1}),s[7]||(s[7]=n("span",null,"核销订单",-1))]),_:1}),r(_,{index:"system-settings"},{title:d(()=>[r(c,null,{default:d(()=>[r(u(C))]),_:1}),s[8]||(s[8]=n("span",null,"系统设置",-1))]),default:d(()=>[r(y,{index:"subaccount-management"},{default:d(()=>[r(c,null,{default:d(()=>[r(u(Y))]),_:1}),s[9]||(s[9]=n("span",null,"子账户管理",-1))]),_:1}),r(y,{index:"operation-log"},{default:d(()=>[r(c,null,{default:d(()=>[r(u(K))]),_:1}),s[10]||(s[10]=n("span",null,"操作日志",-1))]),_:1}),r(y,{index:"reset-password"},{default:d(()=>[r(c,null,{default:d(()=>[r(u(R))]),_:1}),s[11]||(s[11]=n("span",null,"重置密码",-1))]),_:1})]),_:1})]),_:1},8,["default-active"])]),_:1}),r(S,{class:"main-content"},{default:d(()=>[(t(),w($(i.value)))]),_:1})]),_:1})])}}},[["__scopeId","data-v-fbdb4f10"]]);export{qa as A};
