import{_ as e,f as a,r as l,o as t,c as o,a as r,w as u,g as d,u as n,m as i,h as c,j as s,k as m,l as p,s as f,n as v,p as h,q as g,t as b,v as w,x as _,y,z as V,A as N,B as S,C,D as k,F as x,G as I,H as T,I as P,J as z,K as U,L as D,M as E,N as O,O as M,P as R,Q as Y,R as A,S as B}from"./_plugin-vue_export-helper-6ff18c06.js";const K={class:"dashboard"},$={class:"stat-content"},F={class:"stat-icon primary"},j=e({__name:"Dashboard",setup:e=>(a(()=>{}),(e,a)=>{const c=l("el-icon"),s=l("el-card"),m=l("el-col"),p=l("el-row");return t(),o("div",K,[r(p,{gutter:16,class:"stats-row"},{default:u(()=>[r(m,{xs:24,sm:12,lg:6},{default:u(()=>[r(s,{class:"stat-card",shadow:"hover"},{default:u(()=>[d("div",$,[d("div",F,[r(c,null,{default:u(()=>[r(n(i))]),_:1})]),a[0]||(a[0]=d("div",{class:"stat-info"},[d("div",{class:"stat-value"},"¥888,888.88"),d("div",{class:"stat-label"},"总用户余额")],-1))])]),_:1})]),_:1})]),_:1})])})},[["__scopeId","data-v-13894abe"]]),q={class:"customer-management"},H={class:"filter-line"},L={class:"filter-line"},Q={class:"filter-buttons"},X={class:"table-toolbar"},G={class:"left"},Z={style:{display:"flex","align-items":"center",gap:"8px"}},J={style:{"font-family":"monospace","font-size":"12px"}},W={style:{color:"var(--el-color-primary)","font-weight":"500"}},ee={class:"pagination-container"},ae={class:"dialog-footer"},le={class:"edit-customer-content"},te={class:"dialog-footer"},oe={class:"pagination-wrapper"},re={class:"dialog-footer"},ue={class:"adjust-balance-form"},de={class:"current-balance"},ne={class:"value"},ie={class:"adjust-type"},ce={class:"adjust-amount"},se={class:"result-balance"},me={class:"value"},pe={class:"dialog-footer"},fe={class:"product-config-content"},ve={class:"customer-info"},he={class:"product-config-section"},ge={class:"section-header"},be={style:{color:"var(--el-color-primary)","font-weight":"500"}},we={class:"drawer-footer"},_e={class:"product-select-content"},ye={class:"dialog-footer"},Ve=e({__name:"CustomerManagement",setup(e){const U=c(!1);c(!1);const D=c([]),E=s({customerId:"",merchantNo:"",customerName:"",customerEmail:"",status:"",dateRange:[]}),O=c([{customerId:"1001",merchantNo:"M17408123456",merchantKey:"test_key_1234567890abcdef1234567890abcdef",customerName:"asd",customerEmail:"123@qq.com",balance:"9.900",status:"active",registerTime:"2025-02-25 00:28:27"},{customerId:"1002",merchantNo:"M17408234567",merchantKey:"test_key_abcdef1234567890abcdef1234567890",customerName:"aaa",customerEmail:"888@gmail.com",balance:"0.000",status:"active",registerTime:"2025-02-25 17:55:35"},{customerId:"1003",merchantNo:"M17408345678",merchantKey:"test_key_9876543210fedcba9876543210fedcba",customerName:"bbb",customerEmail:"999@gmail.com",balance:"0.000",status:"disabled",registerTime:"2025-02-25 18:09:00"}]),M=s({currentPage:1,pageSize:10,total:3}),R=c(!1),Y=c(),A=s({merchantNo:"",merchantKey:"",customerName:"",customerEmail:"",balance:""}),B={merchantNo:[{required:!0,message:"商户号不能为空",trigger:"blur"}],merchantKey:[{required:!0,message:"商户密钥不能为空",trigger:"blur"}],customerName:[{required:!0,message:"请输入客户昵称",trigger:"blur"}],customerEmail:[{required:!0,message:"请输入客户邮箱",trigger:"blur"}]},K=c(!1),$=c(),F=c(!1),j=s({customerId:"",customerName:"",customerEmail:"",balance:"",merchantNo:"",merchantKey:"",status:"active"}),Ve={customerName:[{required:!0,message:"请输入客户昵称",trigger:"blur"}],customerEmail:[{required:!0,message:"请输入客户邮箱",trigger:"blur"}]},Ne=c(!1),Se=c([{operator:"admin",editTime:"2025-02-25 14:32:33",amount:-.1,type:"余额增加或余额扣减"},{operator:"manager",editTime:"2025-02-25 00:28:27",amount:10,type:"新增客户：初始余额"}]),Ce=s({currentPage:1,pageSize:10,total:2}),ke=c(!1),xe=c("9.900"),Ie=c("increase"),Te=c(""),Pe=m(()=>{const e=parseFloat(xe.value)||0,a=parseFloat(Te.value)||0;return"increase"===Ie.value?(e+a).toFixed(3):(e-a).toFixed(3)}),ze=c(!1),Ue=c(!1),De=c(!1),Ee=c({}),Oe=c([{id:1,productCode:"CARD001",productName:"产品A-[100]",faceValue:"100.00",discountRate:.95},{id:2,productCode:"CARD002",productName:"产品B-[50]",faceValue:"50.00",discountRate:.9},{id:3,productCode:"CARD003",productName:"产品C-[200]",faceValue:"200.00",discountRate:.88}]),Me=c(!1),Re=c([]),Ye=c([]),Ae=c(!1),Be=e=>{D.value=e},Ke=()=>{const e=Date.now().toString(),a=Math.floor(1e3*Math.random()).toString().padStart(3,"0");A.merchantNo=`M${e.slice(-8)}${a}`},$e=()=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let a="merchant_key_";for(let l=0;l<32;l++)a+=e.charAt(Math.floor(62*Math.random()));A.merchantKey=a},Fe=()=>{R.value=!0,Object.assign(A,{merchantNo:"",merchantKey:"",customerName:"",customerEmail:"",balance:""}),Ke(),$e()},je=async()=>{try{await Y.value.validate(),P.success("新增客户成功"),R.value=!1}catch(e){}},qe=async()=>{try{await $.value.validate(),F.value=!0,await new Promise(e=>setTimeout(e,1e3)),P.success("客户信息修改成功"),K.value=!1}catch(e){!1!==e&&P.error("修改失败，请重试")}finally{F.value=!1}},He=e=>{z.confirm(`确认重置客户 "${e.customerName}" 的密钥吗？重置后原密钥将失效。`,"重置密钥确认",{confirmButtonText:"确认重置",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=$e();z.alert(`新密钥已生成，请妥善保管：\n${e}`,"密钥重置成功",{confirmButtonText:"我已保存",type:"success",showClose:!1,closeOnClickModal:!1,closeOnPressEscape:!1}).then(()=>{(async()=>{U.value=!0;try{await new Promise(e=>setTimeout(e,500)),P.success("数据已刷新")}finally{U.value=!1}})()}),P.success("密钥重置成功")}).catch(()=>{P.info("已取消重置")})},Le=(e,a)=>{switch(e){case"edit":(e=>{K.value=!0,Object.assign(j,{customerId:e.customerId,customerName:e.customerName,customerEmail:e.customerEmail,balance:e.balance,merchantNo:e.merchantNo,merchantKey:e.merchantKey,status:e.status||"active"})})(a);break;case"productConfig":Qe(a);break;case"balance":la();break;case"adjustBalance":ta(a);break;case"resetKey":He(a);break;case"delete":(e=>{z.confirm(`确定要删除客户 ${e.customerName} 吗？`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{P.success("删除成功")})})(a)}},Qe=e=>{Ee.value={customerId:e.customerId,customerName:e.customerName,merchantNo:e.merchantNo,customerEmail:e.customerEmail},ze.value=!0,Xe(e.customerId)},Xe=async e=>{Ue.value=!0;try{await new Promise(e=>setTimeout(e,500))}catch(a){P.error("加载产品配置失败")}finally{Ue.value=!1}},Ge=async()=>{Me.value=!0,await Ze(),Re.value=[]},Ze=async()=>{Ae.value=!0;try{await new Promise(e=>setTimeout(e,500));const e=[{productId:"PD1001",productName:"产品A-[10]",faceValue:"10"},{productId:"PD1002",productName:"产品B-[20]",faceValue:"20"},{productId:"PD1003",productName:"产品C-[50]",faceValue:"50"},{productId:"PD1004",productName:"产品D-[20]",faceValue:"20"},{productId:"PD1005",productName:"产品E-[50]",faceValue:"50"}];Ye.value=e}catch(e){P.error("获取产品数据失败")}finally{Ae.value=!1}},Je=()=>{ze.value=!1,Ee.value={}},We=()=>{Me.value=!1,Re.value=[]},ea=()=>{0!==Re.value.length?(Re.value.forEach(e=>{const a=Ye.value.find(a=>a.productId===e);if(a){const e={id:Date.now()+Math.random(),productCode:a.productId,productName:a.productName,faceValue:a.faceValue,discountRate:1};Oe.value.push(e)}}),P.success(`成功添加 ${Re.value.length} 个产品配置`),Me.value=!1,Re.value=[]):P.warning("请至少选择一个产品")},aa=async()=>{De.value=!0;try{await new Promise(e=>setTimeout(e,1e3)),P.success("产品配置保存成功"),ze.value=!1}catch(e){P.error("保存失败，请重试")}finally{De.value=!1}},la=e=>{Ne.value=!0},ta=e=>{ke.value=!0,xe.value=e?e.balance:j.balance,Ie.value="increase",Te.value=""},oa=()=>{P.success("余额调整成功"),j.balance=Pe.value,ke.value=!1},ra=e=>{M.pageSize=e},ua=e=>{M.currentPage=e};return a(()=>{}),(e,a)=>{const c=l("el-input"),s=l("el-form-item"),m=l("el-option"),z=l("el-select"),D=l("el-date-picker"),He=l("el-icon"),Qe=l("el-button"),Xe=l("el-form"),Ze=l("el-card"),la=l("el-table-column"),ta=l("el-tag"),da=l("el-dropdown-item"),na=l("el-dropdown-menu"),ia=l("el-dropdown"),ca=l("el-table"),sa=l("el-pagination"),ma=l("el-dialog"),pa=l("el-switch"),fa=l("el-radio"),va=l("el-radio-group"),ha=l("el-descriptions-item"),ga=l("el-descriptions"),ba=l("el-input-number"),wa=l("el-drawer"),_a=p("loading");return t(),o("div",q,[r(Ze,{shadow:"never",class:"filter-container"},{default:u(()=>[r(Xe,{model:E,class:"multi-line-filter-form"},{default:u(()=>[d("div",H,[r(s,{label:"客户ID：",prop:"customerId"},{default:u(()=>[r(c,{modelValue:E.customerId,"onUpdate:modelValue":a[0]||(a[0]=e=>E.customerId=e),placeholder:"请输入客户ID",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),r(s,{label:"商户号：",prop:"merchantNo"},{default:u(()=>[r(c,{modelValue:E.merchantNo,"onUpdate:modelValue":a[1]||(a[1]=e=>E.merchantNo=e),placeholder:"请输入商户号",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),r(s,{label:"昵称：",prop:"customerName"},{default:u(()=>[r(c,{modelValue:E.customerName,"onUpdate:modelValue":a[2]||(a[2]=e=>E.customerName=e),placeholder:"请输入客户昵称",clearable:"",style:{width:"180px"}},null,8,["modelValue"])]),_:1}),r(s,{label:"邮箱：",prop:"customerEmail"},{default:u(()=>[r(c,{modelValue:E.customerEmail,"onUpdate:modelValue":a[3]||(a[3]=e=>E.customerEmail=e),placeholder:"请输入客户邮箱",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1})]),d("div",L,[r(s,{label:"状态：",prop:"status"},{default:u(()=>[r(z,{modelValue:E.status,"onUpdate:modelValue":a[4]||(a[4]=e=>E.status=e),placeholder:"请选择状态",clearable:"",style:{width:"140px"}},{default:u(()=>[r(m,{label:"启用",value:"active"}),r(m,{label:"禁用",value:"inactive"})]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"注册时间：",prop:"registerTimeRange"},{default:u(()=>[r(D,{modelValue:E.registerTimeRange,"onUpdate:modelValue":a[5]||(a[5]=e=>E.registerTimeRange=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"240px"}},null,8,["modelValue"])]),_:1}),d("div",Q,[r(Qe,{type:"primary",onClick:e.handleFilter},{default:u(()=>[r(He,null,{default:u(()=>[r(n(f))]),_:1}),a[35]||(a[35]=v(" 查询 ",-1))]),_:1},8,["onClick"]),r(Qe,{plain:"",onClick:e.resetFilter},{default:u(()=>[r(He,null,{default:u(()=>[r(n(h))]),_:1}),a[36]||(a[36]=v(" 重置 ",-1))]),_:1},8,["onClick"])])])]),_:1},8,["model"])]),_:1}),r(Ze,null,{default:u(()=>[d("div",X,[d("div",G,[r(Qe,{type:"primary",onClick:Fe},{default:u(()=>[r(He,null,{default:u(()=>[r(n(g))]),_:1}),a[37]||(a[37]=v(" 新增客户 ",-1))]),_:1})])]),b((t(),w(ca,{data:O.value,border:"",stripe:"",onSelectionChange:Be,style:{width:"100%"}},{default:u(()=>[r(la,{type:"selection",width:"55"}),r(la,{prop:"customerId",label:"客户ID",width:"100","show-overflow-tooltip":""}),r(la,{prop:"merchantNo",label:"商户号",width:"160","show-overflow-tooltip":""}),r(la,{prop:"merchantKey",label:"商户密钥",width:"240","show-overflow-tooltip":""},{default:u(({row:e})=>[d("div",Z,[d("span",J,_(e.merchantKey),1),r(Qe,{type:"primary",link:"",size:"small",onClick:a=>(async e=>{try{await navigator.clipboard.writeText(e),P.success("商户密钥已复制到剪贴板")}catch(a){P.error("复制失败，请手动复制")}})(e.merchantKey)},{default:u(()=>[r(He,null,{default:u(()=>[r(n(y))]),_:1})]),_:2},1032,["onClick"])])]),_:1}),r(la,{prop:"customerName",label:"客户昵称",width:"140","show-overflow-tooltip":""}),r(la,{prop:"customerEmail",label:"客户邮箱",width:"200","show-overflow-tooltip":""}),r(la,{prop:"balance",label:"余额",width:"120",sortable:"",align:"right"},{default:u(({row:e})=>[d("span",W,"¥"+_(parseFloat(e.balance).toLocaleString()),1)]),_:1}),r(la,{prop:"status",label:"状态",width:"80",align:"center"},{default:u(({row:e})=>[r(ta,{type:"active"===e.status?"success":"danger"},{default:u(()=>[v(_("active"===e.status?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),r(la,{label:"商户后台",width:"110",align:"center"},{default:u(({row:e})=>[r(Qe,{link:"",type:"primary",onClick:a=>(e=>{const a=new URLSearchParams({merchantNo:e.merchantNo,merchantKey:e.merchantKey,customerName:e.customerName,customerId:e.customerId});window.location.href=`/merchant?${a.toString()}`,P.success(`正在进入 ${e.customerName} 的商户后台系统`)})(e)},{default:u(()=>[r(He,null,{default:u(()=>[r(n(V))]),_:1}),a[38]||(a[38]=v(" 进入后台 ",-1))]),_:2},1032,["onClick"])]),_:1}),r(la,{prop:"registerTime",label:"注册时间",width:"160",sortable:""}),r(la,{label:"操作",width:"120",fixed:"right",align:"center"},{default:u(({row:e})=>[r(ia,{trigger:"click",onCommand:a=>Le(a,e)},{dropdown:u(()=>[r(na,null,{default:u(()=>[r(da,{command:"edit"},{default:u(()=>[r(He,null,{default:u(()=>[r(n(N))]),_:1}),a[40]||(a[40]=v(" 编辑 ",-1))]),_:1}),r(da,{command:"adjustBalance"},{default:u(()=>[r(He,null,{default:u(()=>[r(n(N))]),_:1}),a[41]||(a[41]=v(" 余额操作 ",-1))]),_:1}),r(da,{command:"balance"},{default:u(()=>[r(He,null,{default:u(()=>[r(n(i))]),_:1}),a[42]||(a[42]=v(" 余额详情 ",-1))]),_:1}),r(da,{command:"productConfig"},{default:u(()=>[r(He,null,{default:u(()=>[r(n(S))]),_:1}),a[43]||(a[43]=v(" 产品配置 ",-1))]),_:1}),r(da,{command:"resetKey"},{default:u(()=>[r(He,null,{default:u(()=>[r(n(h))]),_:1}),a[44]||(a[44]=v(" 重置密钥 ",-1))]),_:1}),r(da,{command:"delete",divided:""},{default:u(()=>[r(He,null,{default:u(()=>[r(n(C))]),_:1}),a[45]||(a[45]=d("span",{style:{color:"var(--el-color-danger)"}},"删除",-1))]),_:1})]),_:1})]),default:u(()=>[r(Qe,{text:"",type:"primary",style:{"font-size":"14px"}},{default:u(()=>[a[39]||(a[39]=v(" 操作 ",-1)),r(He,{class:"el-icon--right"},{default:u(()=>[r(n(k))]),_:1})]),_:1})]),_:2},1032,["onCommand"])]),_:1})]),_:1},8,["data"])),[[_a,U.value]]),d("div",ee,[r(sa,{"current-page":M.currentPage,"onUpdate:currentPage":a[6]||(a[6]=e=>M.currentPage=e),"page-size":M.pageSize,"onUpdate:pageSize":a[7]||(a[7]=e=>M.pageSize=e),"page-sizes":[10,20,50,100],total:M.total,layout:"total, sizes, prev, pager, next",onSizeChange:ra,onCurrentChange:ua},null,8,["current-page","page-size","total"])])]),_:1}),r(ma,{modelValue:R.value,"onUpdate:modelValue":a[14]||(a[14]=e=>R.value=e),title:"新增客户",width:"500px"},{footer:u(()=>[d("div",ae,[r(Qe,{onClick:a[13]||(a[13]=e=>R.value=!1)},{default:u(()=>[...a[47]||(a[47]=[v("取消",-1)])]),_:1}),r(Qe,{type:"primary",onClick:je},{default:u(()=>[...a[48]||(a[48]=[v("确定",-1)])]),_:1})])]),default:u(()=>[r(Xe,{ref_key:"addFormRef",ref:Y,model:A,rules:B,"label-width":"100px","label-position":"right"},{default:u(()=>[r(s,{label:"商户号",prop:"merchantNo"},{default:u(()=>[r(c,{modelValue:A.merchantNo,"onUpdate:modelValue":a[8]||(a[8]=e=>A.merchantNo=e),placeholder:"系统自动生成",readonly:"",style:{"background-color":"#ffffff"}},{append:u(()=>[r(Qe,{onClick:Ke,icon:n(h)},null,8,["icon"])]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"商户密钥",prop:"merchantKey"},{default:u(()=>[r(c,{modelValue:A.merchantKey,"onUpdate:modelValue":a[9]||(a[9]=e=>A.merchantKey=e),placeholder:"系统自动生成",readonly:"",style:{"background-color":"#ffffff"}},{append:u(()=>[r(Qe,{onClick:$e,icon:n(h)},null,8,["icon"])]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"客户昵称",prop:"customerName"},{default:u(()=>[r(c,{modelValue:A.customerName,"onUpdate:modelValue":a[10]||(a[10]=e=>A.customerName=e),placeholder:"请输入客户昵称",clearable:""},null,8,["modelValue"])]),_:1}),r(s,{label:"客户邮箱",prop:"customerEmail"},{default:u(()=>[r(c,{modelValue:A.customerEmail,"onUpdate:modelValue":a[11]||(a[11]=e=>A.customerEmail=e),placeholder:"请输入客户邮箱",clearable:""},null,8,["modelValue"])]),_:1}),r(s,{label:"客户余额",prop:"balance"},{default:u(()=>[r(c,{modelValue:A.balance,"onUpdate:modelValue":a[12]||(a[12]=e=>A.balance=e),placeholder:"请输入初始余额",clearable:""},{append:u(()=>[...a[46]||(a[46]=[v("元",-1)])]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),r(ma,{modelValue:K.value,"onUpdate:modelValue":a[22]||(a[22]=e=>K.value=e),title:"编辑客户信息",width:"600px","close-on-click-modal":!1},{footer:u(()=>[d("div",te,[r(Qe,{onClick:a[21]||(a[21]=e=>K.value=!1)},{default:u(()=>[...a[49]||(a[49]=[v("取消",-1)])]),_:1}),r(Qe,{type:"primary",onClick:qe,loading:F.value},{default:u(()=>[...a[50]||(a[50]=[v(" 保存修改 ",-1)])]),_:1},8,["loading"])])]),default:u(()=>[d("div",le,[r(Xe,{ref_key:"editFormRef",ref:$,model:j,rules:Ve,"label-width":"100px","label-position":"right"},{default:u(()=>[r(s,{label:"客户ID"},{default:u(()=>[r(c,{modelValue:j.customerId,"onUpdate:modelValue":a[15]||(a[15]=e=>j.customerId=e),disabled:"",style:{"background-color":"var(--el-fill-color-light)"}},null,8,["modelValue"])]),_:1}),r(s,{label:"商户号"},{default:u(()=>[r(c,{modelValue:j.merchantNo,"onUpdate:modelValue":a[16]||(a[16]=e=>j.merchantNo=e),disabled:"",style:{"background-color":"var(--el-fill-color-light)"}},null,8,["modelValue"])]),_:1}),r(s,{label:"密钥"},{default:u(()=>[r(c,{modelValue:j.merchantKey,"onUpdate:modelValue":a[17]||(a[17]=e=>j.merchantKey=e),disabled:"",style:{"background-color":"var(--el-fill-color-light)"},type:"password","show-password":""},null,8,["modelValue"])]),_:1}),r(s,{label:"客户昵称",prop:"customerName"},{default:u(()=>[r(c,{modelValue:j.customerName,"onUpdate:modelValue":a[18]||(a[18]=e=>j.customerName=e),placeholder:"请输入客户昵称",clearable:"","prefix-icon":n(N)},null,8,["modelValue","prefix-icon"])]),_:1}),r(s,{label:"客户邮箱",prop:"customerEmail"},{default:u(()=>[r(c,{modelValue:j.customerEmail,"onUpdate:modelValue":a[19]||(a[19]=e=>j.customerEmail=e),placeholder:"请输入客户邮箱",clearable:"",type:"email"},null,8,["modelValue"])]),_:1}),r(s,{label:"状态"},{default:u(()=>[r(pa,{modelValue:j.status,"onUpdate:modelValue":a[20]||(a[20]=e=>j.status=e),"active-text":"启用","inactive-text":"禁用","active-value":"active","inactive-value":"inactive",style:{"--el-switch-on-color":"var(--el-color-primary)","--el-switch-off-color":"var(--el-color-info)"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"]),r(ma,{modelValue:Ne.value,"onUpdate:modelValue":a[27]||(a[27]=e=>Ne.value=e),title:"余额详情",width:"900px"},{footer:u(()=>[d("div",re,[r(Qe,{onClick:a[25]||(a[25]=e=>Ne.value=!1)},{default:u(()=>[...a[51]||(a[51]=[v("取消",-1)])]),_:1}),r(Qe,{type:"primary",onClick:a[26]||(a[26]=e=>Ne.value=!1)},{default:u(()=>[...a[52]||(a[52]=[v("确定",-1)])]),_:1})])]),default:u(()=>[r(ca,{data:Se.value,border:"",stripe:""},{default:u(()=>[r(la,{prop:"operator",label:"操作人",width:"120"}),r(la,{prop:"editTime",label:"编辑时间",width:"180"}),r(la,{prop:"amount",label:"数额",width:"120"},{default:u(({row:e})=>[d("span",{class:x(e.amount>0?"amount-positive":"amount-negative")},_(e.amount>0?"+":"")+_(e.amount),3)]),_:1}),r(la,{prop:"type",label:"类型","min-width":"200"})]),_:1},8,["data"]),d("div",oe,[r(sa,{"current-page":Ce.currentPage,"onUpdate:currentPage":a[23]||(a[23]=e=>Ce.currentPage=e),"page-size":Ce.pageSize,"onUpdate:pageSize":a[24]||(a[24]=e=>Ce.pageSize=e),"page-sizes":[10,20,50],total:Ce.total,layout:"total, sizes, prev, pager, next"},null,8,["current-page","page-size","total"])])]),_:1},8,["modelValue"]),r(ma,{modelValue:ke.value,"onUpdate:modelValue":a[31]||(a[31]=e=>ke.value=e),title:"余额调整",width:"500px"},{footer:u(()=>[d("div",pe,[r(Qe,{onClick:a[30]||(a[30]=e=>ke.value=!1)},{default:u(()=>[...a[60]||(a[60]=[v("取消",-1)])]),_:1}),r(Qe,{type:"primary",onClick:oa},{default:u(()=>[...a[61]||(a[61]=[v("确定",-1)])]),_:1})])]),default:u(()=>[d("div",ue,[d("div",de,[a[53]||(a[53]=d("span",{class:"label"},"当前余额:",-1)),d("span",ne,_(xe.value)+"元",1)]),d("div",ie,[a[56]||(a[56]=d("span",{class:"label"},"余额增减:",-1)),r(va,{modelValue:Ie.value,"onUpdate:modelValue":a[28]||(a[28]=e=>Ie.value=e)},{default:u(()=>[r(fa,{value:"increase"},{default:u(()=>[...a[54]||(a[54]=[v("余额增加",-1)])]),_:1}),r(fa,{value:"decrease"},{default:u(()=>[...a[55]||(a[55]=[v("余额减少",-1)])]),_:1})]),_:1},8,["modelValue"])]),d("div",ce,[a[58]||(a[58]=d("span",{class:"label"},"修改数额:",-1)),r(c,{modelValue:Te.value,"onUpdate:modelValue":a[29]||(a[29]=e=>Te.value=e),placeholder:"请输入",style:{width:"200px"},clearable:""},{append:u(()=>[...a[57]||(a[57]=[v("元",-1)])]),_:1},8,["modelValue"])]),d("div",se,[a[59]||(a[59]=d("span",{class:"label"},"修改后余额:",-1)),d("span",me,_(Pe.value)+"元",1)])])]),_:1},8,["modelValue"]),r(wa,{modelValue:ze.value,"onUpdate:modelValue":a[32]||(a[32]=e=>ze.value=e),title:"产品配置",direction:"rtl",size:"60%","before-close":Je},{footer:u(()=>[d("div",we,[r(Qe,{onClick:Je},{default:u(()=>[...a[66]||(a[66]=[v("取消",-1)])]),_:1}),r(Qe,{type:"primary",onClick:aa,loading:De.value},{default:u(()=>[...a[67]||(a[67]=[v(" 保存配置 ",-1)])]),_:1},8,["loading"])])]),default:u(()=>[d("div",fe,[d("div",ve,[a[62]||(a[62]=d("h4",null,"客户信息",-1)),r(ga,{column:2,border:""},{default:u(()=>[r(ha,{label:"客户ID"},{default:u(()=>[v(_(Ee.value.customerId),1)]),_:1}),r(ha,{label:"客户昵称"},{default:u(()=>[v(_(Ee.value.customerName),1)]),_:1}),r(ha,{label:"商户号"},{default:u(()=>[v(_(Ee.value.merchantNo),1)]),_:1}),r(ha,{label:"客户邮箱"},{default:u(()=>[v(_(Ee.value.customerEmail),1)]),_:1})]),_:1})]),d("div",he,[d("div",ge,[a[64]||(a[64]=d("h4",null,"卡密产品配置",-1)),r(Qe,{type:"primary",icon:n(g),onClick:Ge},{default:u(()=>[...a[63]||(a[63]=[v(" 新增产品 ",-1)])]),_:1},8,["icon"])]),b((t(),w(ca,{data:Oe.value,border:"",stripe:"",style:{width:"100%"}},{default:u(()=>[r(la,{prop:"productCode",label:"产品编码",width:"120"}),r(la,{prop:"productName",label:"产品名称","min-width":"150"}),r(la,{prop:"faceValue",label:"面值",width:"100",align:"right"},{default:u(({row:e})=>[d("span",null,"¥"+_(parseFloat(e.faceValue).toLocaleString()),1)]),_:1}),r(la,{label:"折扣比例",width:"150",align:"center"},{default:u(({row:e})=>[r(ba,{modelValue:e.discountRate,"onUpdate:modelValue":a=>e.discountRate=a,min:0,max:1,step:.01,precision:2,size:"small",style:{width:"120px"},onChange:e=>{}},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),r(la,{label:"扣款价格",width:"120",align:"right"},{default:u(({row:e})=>[d("span",be," ¥"+_((parseFloat(e.faceValue)*e.discountRate).toFixed(2)),1)]),_:1}),r(la,{label:"操作",width:"80",align:"center"},{default:u(({row:e,$index:l})=>[r(Qe,{type:"danger",link:"",icon:n(C),onClick:e=>{return a=l,void(Oe.value.length<=1?P.warning("至少需要保留一个产品配置"):(Oe.value.splice(a,1),P.success("产品配置已删除")));var a},size:"small"},{default:u(()=>[...a[65]||(a[65]=[v(" 删除 ",-1)])]),_:2},1032,["icon","onClick"])]),_:1})]),_:1},8,["data"])),[[_a,Ue.value]])])])]),_:1},8,["modelValue"]),r(ma,{modelValue:Me.value,"onUpdate:modelValue":a[34]||(a[34]=e=>Me.value=e),title:"选择产品",width:"500px","before-close":We},{footer:u(()=>[d("div",ye,[r(Qe,{onClick:We},{default:u(()=>[...a[68]||(a[68]=[v("取消",-1)])]),_:1}),r(Qe,{type:"primary",onClick:ea,disabled:0===Re.value.length},{default:u(()=>[v(" 确认选择 ("+_(Re.value.length)+") ",1)]),_:1},8,["disabled"])])]),default:u(()=>[d("div",_e,[r(Xe,{"label-width":"80px"},{default:u(()=>[r(s,{label:"选择产品："},{default:u(()=>[r(z,{modelValue:Re.value,"onUpdate:modelValue":a[33]||(a[33]=e=>Re.value=e),multiple:"",filterable:"",placeholder:"请选择产品",style:{width:"100%"},loading:Ae.value},{default:u(()=>[(t(!0),o(I,null,T(Ye.value,e=>(t(),w(m,{key:e.productId,label:`${e.productName} - ¥${e.faceValue}`,value:e.productId},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1})]),_:1})])]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-27dc2f73"]]),Ne={class:"product-management"},Se={class:"filter-line"},Ce={class:"filter-line"},ke={class:"filter-buttons"},xe={class:"table-toolbar"},Ie={class:"left"},Te={style:{color:"var(--el-color-primary)","font-weight":"500"}},Pe={class:"operation-buttons"},ze={class:"pagination-container"},Ue={class:"dialog-footer"},De={class:"dialog-footer"},Ee=e({__name:"CardManagement",setup(e){const i=c(!1),m=c(!1),y=s({productId:"",productName:""}),V=c([{productId:"PD1001",productName:"电话卡套餐A",faceValue:"10",productLink:"xxxxxx",soldCount:"1 / 1",createTime:"2025-02-25 14:32:33"},{productId:"PD1002",productName:"流量卡套餐B",faceValue:"20",productLink:"www.baidu.com",soldCount:"0 / 100",createTime:"2025-02-25 18:08:34"},{productId:"PD1003",productName:"游戏卡套餐C",faceValue:"50",productLink:"www",soldCount:"0 / 100",createTime:"2025-02-25 18:09:54"}]),S=s({currentPage:1,pageSize:10,total:3}),k=c(!1),x=c(),I=s({productName:"",faceValue:"10"}),T={productName:[{required:!0,message:"请输入产品名称",trigger:"blur"}],faceValue:[{required:!0,message:"请选择商品面值",trigger:"change"}]},z=c(!1),U=c(),D=s({productId:"",productName:"",faceValue:"10"}),E={productName:[{required:!0,message:"请输入产品名称",trigger:"blur"}],faceValue:[{required:!0,message:"请选择商品面值",trigger:"change"}]},O=()=>{},M=()=>{Object.assign(y,{productId:"",productName:""})},R=()=>{k.value=!0,Object.assign(I,{productName:"",faceValue:"10"})},Y=async()=>{try{await x.value.validate(),P.success("新建产品成功"),k.value=!1}catch(e){}},A=async()=>{try{await U.value.validate(),P.success("编辑产品成功"),z.value=!1}catch(e){}},B=e=>{S.pageSize=e},K=e=>{S.currentPage=e};return a(()=>{}),(e,a)=>{const c=l("el-input"),s=l("el-form-item"),$=l("el-icon"),F=l("el-button"),j=l("el-form"),q=l("el-card"),H=l("el-table-column"),L=l("el-popconfirm"),Q=l("el-table"),X=l("el-pagination"),G=l("el-divider"),Z=l("el-radio"),J=l("el-radio-group"),W=l("el-dialog"),ee=p("loading");return t(),o("div",Ne,[r(q,{shadow:"never",class:"filter-container"},{default:u(()=>[r(j,{model:y,class:"multi-line-filter-form"},{default:u(()=>[d("div",Se,[r(s,{label:"产品编码：",prop:"productId"},{default:u(()=>[r(c,{modelValue:y.productId,"onUpdate:modelValue":a[0]||(a[0]=e=>y.productId=e),placeholder:"请输入产品编码",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),r(s,{label:"产品名称：",prop:"productName"},{default:u(()=>[r(c,{modelValue:y.productName,"onUpdate:modelValue":a[1]||(a[1]=e=>y.productName=e),placeholder:"请输入产品名称",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1})]),d("div",Ce,[d("div",ke,[r(F,{type:"primary",onClick:O,loading:m.value},{default:u(()=>[r($,null,{default:u(()=>[r(n(f))]),_:1}),a[13]||(a[13]=v(" 查询 ",-1))]),_:1},8,["loading"]),r(F,{plain:"",onClick:M},{default:u(()=>[r($,null,{default:u(()=>[r(n(h))]),_:1}),a[14]||(a[14]=v(" 重置 ",-1))]),_:1})])])]),_:1},8,["model"])]),_:1}),r(q,null,{default:u(()=>[d("div",xe,[d("div",Ie,[r(F,{type:"primary",icon:n(g),onClick:R},{default:u(()=>[...a[15]||(a[15]=[v("新建产品",-1)])]),_:1},8,["icon"])])]),b((t(),w(Q,{data:V.value,style:{width:"100%"}},{default:u(()=>[r(H,{prop:"productId",label:"产品编码",width:"120"}),r(H,{prop:"productName",label:"产品名称","min-width":"150"},{default:u(({row:e,$index:a})=>[d("span",null,"产品"+_(String.fromCharCode(65+a))+"-["+_(e.faceValue)+"]",1)]),_:1}),r(H,{prop:"faceValue",label:"面值",width:"100",align:"center"},{default:u(({row:e})=>[d("span",Te,_(e.faceValue)+"元",1)]),_:1}),r(H,{prop:"createTime",label:"创建时间",width:"160"}),r(H,{label:"操作",width:"160",fixed:"right"},{default:u(({row:e})=>[d("div",Pe,[r(F,{link:"",type:"primary",icon:n(N),onClick:a=>(e=>{z.value=!0,Object.assign(D,{productId:e.productId,productName:e.productName,faceValue:e.faceValue})})(e)},{default:u(()=>[...a[16]||(a[16]=[v("编辑",-1)])]),_:2},1032,["icon","onClick"]),r(L,{title:"请解绑所有关联此产品的商户后操作",onConfirm:e=>{P.success("删除成功")}},{reference:u(()=>[r(F,{link:"",type:"danger",icon:n(C)},{default:u(()=>[...a[17]||(a[17]=[v("删除",-1)])]),_:1},8,["icon"])]),_:2},1032,["onConfirm"])])]),_:1})]),_:1},8,["data"])),[[ee,i.value]]),d("div",ze,[r(X,{"current-page":S.currentPage,"onUpdate:currentPage":a[2]||(a[2]=e=>S.currentPage=e),"page-size":S.pageSize,"onUpdate:pageSize":a[3]||(a[3]=e=>S.pageSize=e),"page-sizes":[10,20,50,100],total:S.total,layout:"total, sizes, prev, pager, next",onSizeChange:B,onCurrentChange:K},null,8,["current-page","page-size","total"])])]),_:1}),r(W,{modelValue:k.value,"onUpdate:modelValue":a[7]||(a[7]=e=>k.value=e),title:"新建产品",width:"600px"},{footer:u(()=>[d("div",Ue,[r(F,{onClick:a[6]||(a[6]=e=>k.value=!1)},{default:u(()=>[...a[27]||(a[27]=[v("取消",-1)])]),_:1}),r(F,{type:"primary",onClick:Y},{default:u(()=>[...a[28]||(a[28]=[v("确定",-1)])]),_:1})])]),default:u(()=>[r(j,{ref_key:"addFormRef",ref:x,model:I,rules:T,"label-width":"100px","label-position":"right"},{default:u(()=>[r(G,{"content-position":"left"},{default:u(()=>[...a[18]||(a[18]=[v("产品信息",-1)])]),_:1}),r(s,{label:"产品名称",prop:"productName"},{default:u(()=>[r(c,{modelValue:I.productName,"onUpdate:modelValue":a[4]||(a[4]=e=>I.productName=e),placeholder:"请输入产品名称",clearable:""},null,8,["modelValue"])]),_:1}),r(G,{"content-position":"left"},{default:u(()=>[...a[19]||(a[19]=[v("商品面值",-1)])]),_:1}),r(s,{label:"商品面值",prop:"faceValue"},{default:u(()=>[r(J,{modelValue:I.faceValue,"onUpdate:modelValue":a[5]||(a[5]=e=>I.faceValue=e)},{default:u(()=>[r(Z,{value:"10"},{default:u(()=>[...a[20]||(a[20]=[v("10元",-1)])]),_:1}),r(Z,{value:"20"},{default:u(()=>[...a[21]||(a[21]=[v("20元",-1)])]),_:1}),r(Z,{value:"30"},{default:u(()=>[...a[22]||(a[22]=[v("30元",-1)])]),_:1}),r(Z,{value:"50"},{default:u(()=>[...a[23]||(a[23]=[v("50元",-1)])]),_:1}),r(Z,{value:"100"},{default:u(()=>[...a[24]||(a[24]=[v("100元",-1)])]),_:1}),r(Z,{value:"200"},{default:u(()=>[...a[25]||(a[25]=[v("200元",-1)])]),_:1}),r(Z,{value:"300"},{default:u(()=>[...a[26]||(a[26]=[v("300元",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),r(W,{modelValue:z.value,"onUpdate:modelValue":a[12]||(a[12]=e=>z.value=e),title:"编辑产品",width:"500px"},{footer:u(()=>[d("div",De,[r(F,{onClick:a[11]||(a[11]=e=>z.value=!1)},{default:u(()=>[...a[36]||(a[36]=[v("取消",-1)])]),_:1}),r(F,{type:"primary",onClick:A},{default:u(()=>[...a[37]||(a[37]=[v("确定",-1)])]),_:1})])]),default:u(()=>[r(j,{ref_key:"editFormRef",ref:U,model:D,rules:E,"label-width":"100px","label-position":"right"},{default:u(()=>[r(s,{label:"产品编码",prop:"productId"},{default:u(()=>[r(c,{modelValue:D.productId,"onUpdate:modelValue":a[8]||(a[8]=e=>D.productId=e),placeholder:"产品编码",readonly:"",disabled:""},null,8,["modelValue"])]),_:1}),r(s,{label:"产品名称",prop:"productName"},{default:u(()=>[r(c,{modelValue:D.productName,"onUpdate:modelValue":a[9]||(a[9]=e=>D.productName=e),placeholder:"请输入产品名称",clearable:""},null,8,["modelValue"])]),_:1}),r(s,{label:"产品面值",prop:"faceValue"},{default:u(()=>[r(J,{modelValue:D.faceValue,"onUpdate:modelValue":a[10]||(a[10]=e=>D.faceValue=e)},{default:u(()=>[r(Z,{value:"10"},{default:u(()=>[...a[29]||(a[29]=[v("10元",-1)])]),_:1}),r(Z,{value:"20"},{default:u(()=>[...a[30]||(a[30]=[v("20元",-1)])]),_:1}),r(Z,{value:"30"},{default:u(()=>[...a[31]||(a[31]=[v("30元",-1)])]),_:1}),r(Z,{value:"50"},{default:u(()=>[...a[32]||(a[32]=[v("50元",-1)])]),_:1}),r(Z,{value:"100"},{default:u(()=>[...a[33]||(a[33]=[v("100元",-1)])]),_:1}),r(Z,{value:"200"},{default:u(()=>[...a[34]||(a[34]=[v("200元",-1)])]),_:1}),r(Z,{value:"300"},{default:u(()=>[...a[35]||(a[35]=[v("300元",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-165f0875"]]),Oe={class:"page-container"},Me={class:"filter-line"},Re={class:"filter-line"},Ye={class:"filter-line"},Ae={class:"filter-line"},Be={class:"filter-buttons"},Ke={class:"table-toolbar"},$e={class:"toolbar-left"},Fe={class:"toolbar-right"},je={class:"order-info"},qe={class:"order-id"},He={class:"system-id"},Le={class:"merchant-info"},Qe={class:"merchant-id"},Xe={class:"merchant-code"},Ge={class:"merchant-name"},Ze={class:"card-info"},Je={class:"card-number"},We={class:"card-password"},ea={class:"pagination-container"},aa=e({__name:"OrderManagement",setup(e){const i=c(!1),f=c(!1),g=c([]),y=s({orderNo:"",productName:"",transactionStatus:"",verificationStatus:"",withdrawalTime:[],merchantOrderNo:"",systemOrderNo:"",faceValue:"",cardNo:"",merchantCode:"",merchantName:""}),V=s({currentPage:1,pageSize:20,total:0}),N=m(()=>g.value.some(e=>"verified"!==e.verificationStatus&&"locked"!==e.verificationStatus)),S=m(()=>g.value.some(e=>"locked"===e.verificationStatus)),C=m(()=>g.value.filter(e=>"verified"!==e.verificationStatus&&"locked"!==e.verificationStatus).length),k=m(()=>g.value.filter(e=>"locked"===e.verificationStatus).length),x=c([{id:1,orderNo:"ORD20241201001",systemId:"SYS001",productName:"Steam充值卡",cardNumber:"1234-5678-9012-3456",cardPassword:"ABC123DEF456",transactionAmount:100,transactionQuantity:1,transactionStatus:"success",withdrawalTime:"2024-12-01 10:30:00",verificationStatus:"verified",withdrawalTimestamp:1733025e3,faceValue:100},{id:2,orderNo:"ORD20241201002",systemId:"SYS002",productName:"Apple Store充值卡",cardNumber:"9876-5432-1098-7654",cardPassword:"XYZ789GHI012",transactionAmount:50,transactionQuantity:1,transactionStatus:"processing",withdrawalTime:"2024-12-01 11:15:00",verificationStatus:"unverified",withdrawalTimestamp:1733027700,faceValue:50}]);V.total=x.value.length;const I=e=>({success:"处理成功",processing:"处理中",failed:"处理失败"}[e]||"未知状态"),T=e=>({verified:"已核销",unverified:"未核销",locked:"已锁定"}[e]||"未知状态"),U=async()=>{try{i.value=!0,await new Promise(e=>setTimeout(e,500));let e=K;if(y.cardNo&&y.cardNo.trim()){const a=y.cardNo.split("\n").map(e=>e.trim()).filter(e=>e.length>0);a.length>0&&(e=e.filter(e=>a.some(a=>e.cardNumber&&e.cardNumber.includes(a))))}y.orderNo&&(e=e.filter(e=>e.orderNo&&e.orderNo.includes(y.orderNo))),y.productName&&(e=e.filter(e=>e.productName&&e.productName.includes(y.productName))),y.transactionStatus&&(e=e.filter(e=>e.transactionStatus===y.transactionStatus)),y.verificationStatus&&(e=e.filter(e=>e.verificationStatus===y.verificationStatus)),y.merchantOrderNo&&(e=e.filter(e=>e.merchantOrderNo&&e.merchantOrderNo.includes(y.merchantOrderNo))),y.systemOrderNo&&(e=e.filter(e=>e.systemId&&e.systemId.includes(y.systemOrderNo))),y.faceValue&&(e=e.filter(e=>e.faceValue&&e.faceValue.toString().includes(y.faceValue))),y.merchantCode&&(e=e.filter(e=>e.merchantCode&&e.merchantCode.includes(y.merchantCode))),y.merchantName&&(e=e.filter(e=>e.merchantName&&e.merchantName.includes(y.merchantName))),V.total=e.length;const a=(V.currentPage-1)*V.pageSize,l=a+V.pageSize;x.value=e.slice(a,l)}catch(e){P.error("加载数据失败")}finally{i.value=!1}},D=async()=>{V.currentPage=1,await U()},E=()=>{Object.assign(y,{orderNo:"",productName:"",transactionStatus:"",verificationStatus:"",withdrawalTime:[],merchantOrderNo:"",systemOrderNo:"",faceValue:"",cardNo:""}),V.currentPage=1,U()},O=async()=>{await U()},M=e=>{g.value=e},R=async()=>{if(0===g.value.length)return void P.warning("请选择要锁卡的记录");const e=g.value.filter(e=>"verified"!==e.verificationStatus&&"locked"!==e.verificationStatus);if(0!==e.length)try{await z.confirm(`确定要锁定选中的 ${e.length} 张卡吗？`,"批量锁卡确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await new Promise(e=>setTimeout(e,1e3)),e.forEach(e=>{e.verificationStatus="locked"}),P.success(`成功锁定 ${e.length} 张卡`),g.value=[]}catch(a){"cancel"!==a&&P.error("批量锁卡失败")}else P.warning("选中的记录中没有可锁卡的项目")},Y=async()=>{if(0===g.value.length)return void P.warning("请选择要解锁的记录");const e=g.value.filter(e=>"locked"===e.verificationStatus);if(0!==e.length)try{await z.confirm(`确定要解锁选中的 ${e.length} 张卡吗？`,"批量解锁确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await new Promise(e=>setTimeout(e,1e3)),e.forEach(e=>{e.verificationStatus="unverified"}),P.success(`成功解锁 ${e.length} 张卡`),g.value=[]}catch(a){"cancel"!==a&&P.error("批量解锁失败")}else P.warning("选中的记录中没有可解锁的项目")},A=e=>{V.pageSize=e,V.currentPage=1,U()},B=e=>{V.currentPage=e,U()},K=[{id:1,orderNo:"ORD20241201001",systemId:"SYS001",productName:"Steam充值卡",cardNumber:"1234-5678-9012-3456",cardPassword:"ABC123DEF456",transactionAmount:100,transactionQuantity:1,transactionStatus:"success",withdrawalTime:"2024-12-01 10:30:00",verificationStatus:"verified",withdrawalTimestamp:1733025e3,faceValue:100,merchantOrderNo:"MERCH001",systemOrderNo:"SYS001",merchantId:"M001",merchantCode:"MC001",merchantName:"阿里巴巴"},{id:2,orderNo:"ORD20241201002",systemId:"SYS002",productName:"Apple Store充值卡",cardNumber:"9876-5432-1098-7654",cardPassword:"XYZ789GHI012",transactionAmount:50,transactionQuantity:1,transactionStatus:"processing",withdrawalTime:"2024-12-01 11:15:00",verificationStatus:"unverified",withdrawalTimestamp:1733027700,faceValue:50,merchantOrderNo:"MERCH002",systemOrderNo:"SYS002",merchantId:"M002",merchantCode:"MC002",merchantName:"腾讯科技"},{id:3,orderNo:"ORD20241201003",systemId:"SYS003",productName:"Google Play充值卡",cardNumber:"1111-2222-3333-4444",cardPassword:"DEF456GHI789",transactionAmount:30,transactionQuantity:1,transactionStatus:"success",withdrawalTime:"2024-12-01 12:00:00",verificationStatus:"locked",withdrawalTimestamp:1733030400,faceValue:30,merchantOrderNo:"MERCH003",systemOrderNo:"SYS003",merchantId:"M003",merchantCode:"MC003",merchantName:"字节跳动"}];return a(()=>{U()}),(e,a)=>{const c=l("el-input"),s=l("el-form-item"),m=l("el-option"),g=l("el-select"),z=l("el-date-picker"),U=l("el-button"),K=l("el-form"),$=l("el-card"),F=l("el-table-column"),j=l("el-tag"),q=l("el-switch"),H=l("el-table"),L=l("el-pagination"),Q=p("loading");return t(),o("div",Oe,[r($,{shadow:"never",class:"filter-container"},{default:u(()=>[r(K,{model:y,inline:"",class:"multi-line-filter-form"},{default:u(()=>[d("div",Me,[r(s,{label:"订单号：",prop:"orderNo"},{default:u(()=>[r(c,{modelValue:y.orderNo,"onUpdate:modelValue":a[0]||(a[0]=e=>y.orderNo=e),placeholder:"请输入订单号",clearable:"",style:{width:"220px"}},null,8,["modelValue"])]),_:1}),r(s,{label:"产品：",prop:"productName"},{default:u(()=>[r(g,{modelValue:y.productName,"onUpdate:modelValue":a[1]||(a[1]=e=>y.productName=e),placeholder:"请选择产品",clearable:"",style:{width:"168px"}},{default:u(()=>[r(m,{label:"联通充值卡",value:"联通充值卡"}),r(m,{label:"移动充值卡",value:"移动充值卡"}),r(m,{label:"电信充值卡",value:"电信充值卡"})]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"交易状态：",prop:"transactionStatus"},{default:u(()=>[r(g,{modelValue:y.transactionStatus,"onUpdate:modelValue":a[2]||(a[2]=e=>y.transactionStatus=e),placeholder:"请选择交易状态",clearable:"",style:{width:"168px"}},{default:u(()=>[r(m,{label:"处理成功",value:"success"}),r(m,{label:"处理中",value:"processing"}),r(m,{label:"处理失败",value:"failed"})]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"核销状态：",prop:"verificationStatus"},{default:u(()=>[r(g,{modelValue:y.verificationStatus,"onUpdate:modelValue":a[3]||(a[3]=e=>y.verificationStatus=e),placeholder:"请选择核销状态",clearable:"",style:{width:"168px"}},{default:u(()=>[r(m,{label:"已核销",value:"verified"}),r(m,{label:"未核销",value:"unverified"}),r(m,{label:"已锁定",value:"locked"})]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"商户号：",prop:"merchantCode"},{default:u(()=>[r(c,{modelValue:y.merchantCode,"onUpdate:modelValue":a[4]||(a[4]=e=>y.merchantCode=e),placeholder:"请输入商户号",clearable:"",style:{width:"168px"}},null,8,["modelValue"])]),_:1})]),d("div",Re,[r(s,{label:"提卡时间：",prop:"withdrawalTime"},{default:u(()=>[r(z,{modelValue:y.withdrawalTime,"onUpdate:modelValue":a[5]||(a[5]=e=>y.withdrawalTime=e),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",style:{width:"350px"}},null,8,["modelValue"])]),_:1}),r(s,{label:"商户单号：",prop:"merchantOrderNo"},{default:u(()=>[r(c,{modelValue:y.merchantOrderNo,"onUpdate:modelValue":a[6]||(a[6]=e=>y.merchantOrderNo=e),placeholder:"请输入商户单号",clearable:"",style:{width:"220px"}},null,8,["modelValue"])]),_:1}),r(s,{label:"系统单号：",prop:"systemOrderNo"},{default:u(()=>[r(c,{modelValue:y.systemOrderNo,"onUpdate:modelValue":a[7]||(a[7]=e=>y.systemOrderNo=e),placeholder:"请输入系统单号",clearable:"",style:{width:"220px"}},null,8,["modelValue"])]),_:1}),r(s,{label:"商户名称：",prop:"merchantName"},{default:u(()=>[r(c,{modelValue:y.merchantName,"onUpdate:modelValue":a[8]||(a[8]=e=>y.merchantName=e),placeholder:"请输入商户名称",clearable:"",style:{width:"168px"}},null,8,["modelValue"])]),_:1})]),d("div",Ye,[r(s,{label:"面值：",prop:"faceValue"},{default:u(()=>[r(g,{modelValue:y.faceValue,"onUpdate:modelValue":a[9]||(a[9]=e=>y.faceValue=e),placeholder:"请选择面值",clearable:"",style:{width:"168px"}},{default:u(()=>[r(m,{label:"10元",value:"10"}),r(m,{label:"20元",value:"20"}),r(m,{label:"30元",value:"30"}),r(m,{label:"50元",value:"50"}),r(m,{label:"100元",value:"100"})]),_:1},8,["modelValue"])]),_:1})]),d("div",Ae,[r(s,{label:"卡号：",prop:"cardNo"},{default:u(()=>[r(c,{modelValue:y.cardNo,"onUpdate:modelValue":a[10]||(a[10]=e=>y.cardNo=e),type:"textarea",placeholder:"请输入卡号，多个卡号请换行分隔",rows:3,autosize:{minRows:3,maxRows:6},style:{width:"300px"}},null,8,["modelValue"])]),_:1}),d("div",Be,[r(U,{type:"primary",onClick:D,loading:f.value},{default:u(()=>[...a[13]||(a[13]=[v("查询",-1)])]),_:1},8,["loading"]),r(U,{plain:"",onClick:E},{default:u(()=>[...a[14]||(a[14]=[v("重置",-1)])]),_:1})])])]),_:1},8,["model"])]),_:1}),r($,null,{default:u(()=>[d("div",Ke,[d("div",$e,[r(U,{type:"primary",disabled:!N.value,onClick:R},{default:u(()=>[v(" 锁卡 ("+_(C.value)+") ",1)]),_:1},8,["disabled"]),r(U,{type:"warning",disabled:!S.value,onClick:Y},{default:u(()=>[v(" 解锁 ("+_(k.value)+") ",1)]),_:1},8,["disabled"])]),d("div",Fe,[r(U,{icon:n(h),onClick:O},{default:u(()=>[...a[15]||(a[15]=[v("刷新",-1)])]),_:1},8,["icon"])])]),b((t(),w(H,{data:x.value,border:"",stripe:"",style:{"margin-top":"16px",width:"100%"},onSelectionChange:M},{default:u(()=>[r(F,{type:"selection",width:"55"}),r(F,{prop:"orderNo",label:"订单号","min-width":"180"},{default:u(({row:e})=>[d("div",je,[d("div",qe,_(e.orderNo),1),d("div",He,_(e.systemId),1)])]),_:1}),r(F,{prop:"merchantInfo",label:"商户信息","min-width":"200"},{default:u(({row:e})=>[d("div",Le,[d("div",Qe,_(e.merchantId),1),d("div",Xe,_(e.merchantCode),1),d("div",Ge,_(e.merchantName),1)])]),_:1}),r(F,{prop:"productName",label:"产品","min-width":"150"},{default:u(({row:e,$index:a})=>[d("span",null,"产品"+_(String.fromCharCode(65+a))+"-["+_(e.faceValue)+"]",1)]),_:1}),r(F,{prop:"cardInfo",label:"卡密","min-width":"200"},{default:u(({row:e})=>[d("div",Ze,[d("div",Je,_(e.cardNumber),1),d("div",We,_(e.cardPassword),1)])]),_:1}),r(F,{prop:"transactionAmount",label:"交易金额","min-width":"100"},{default:u(({row:e})=>[v(" ¥"+_(e.transactionAmount),1)]),_:1}),r(F,{prop:"transactionQuantity",label:"交易数量","min-width":"100"}),r(F,{prop:"transactionStatus",label:"交易状态","min-width":"120"},{default:u(({row:e})=>{return[r(j,{type:(a=e.transactionStatus,{success:"success",processing:"warning",failed:"danger"}[a]||"info"),size:"small"},{default:u(()=>[v(_(I(e.transactionStatus)),1)]),_:2},1032,["type"])];var a}),_:1}),r(F,{prop:"withdrawalTime",label:"提卡时间","min-width":"160"}),r(F,{prop:"verificationStatus",label:"核销状态","min-width":"120"},{default:u(({row:e})=>{return[r(j,{type:(a=e.verificationStatus,{verified:"success",unverified:"warning",locked:"danger"}[a]||"info"),size:"small"},{default:u(()=>[v(_(T(e.verificationStatus)),1)]),_:2},1032,["type"])];var a}),_:1}),r(F,{label:"锁卡开关","min-width":"100",align:"center",fixed:"right"},{default:u(({row:e})=>[r(q,{"model-value":"locked"===e.verificationStatus,disabled:"verified"===e.verificationStatus,onChange:a=>(async(e,a)=>{try{await new Promise(e=>setTimeout(e,300)),e.verificationStatus=a?"locked":"unverified",P.success(a?"锁卡成功":"解锁成功")}catch(l){P.error(a?"锁卡失败":"解锁失败")}})(e,a),"active-text":"","inactive-text":"","active-color":"verified"===e.verificationStatus?"#C0C4CC":"#13CE66","inactive-color":"verified"===e.verificationStatus?"#C0C4CC":"#DCDFE6"},null,8,["model-value","disabled","onChange","active-color","inactive-color"])]),_:1}),r(F,{prop:"withdrawalTimestamp",label:"核销时间","min-width":"180"},{default:u(({row:e})=>{return[v(_((a=e.withdrawalTimestamp,a?new Date(a).toLocaleString("zh-CN"):"-")),1)];var a}),_:1})]),_:1},8,["data"])),[[Q,i.value]]),d("div",ea,[r(L,{"current-page":V.currentPage,"onUpdate:currentPage":a[11]||(a[11]=e=>V.currentPage=e),"page-size":V.pageSize,"onUpdate:pageSize":a[12]||(a[12]=e=>V.pageSize=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:V.total,onSizeChange:A,onCurrentChange:B},null,8,["current-page","page-size","total"])])]),_:1})])}}},[["__scopeId","data-v-5e99419e"]]),la={class:"card-query"},ta={class:"filter-line"},oa={class:"filter-line"},ra={class:"filter-buttons"},ua={class:"table-toolbar"},da={class:"left"},na={class:"right"},ia={class:"selected-info"},ca={style:{color:"var(--el-color-warning)","font-weight":"500"}},sa={class:"pagination-container"},ma=e({__name:"CardQuery",setup(e){const i=s({cardSecret:"",cardId:"",status:"",verificationStatus:"",lockStatus:""}),g=c([]),y=m(()=>g.value.some(e=>"正常"===e.lockStatus)),V=m(()=>g.value.some(e=>"已锁定"===e.lockStatus)),N=c([{cardNumber:"939684006576672442",password:"p60wXO8T",orderNumber:"sf174047748858929",customerId:"1001",status:"已使用",verificationStatus:"已核销",lockStatus:"正常",productValue:"10",createTime:"2025-02-25 17:59:20"},{cardNumber:"736779794793920531",password:"pXSi3Y20",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"正常",productValue:"10",createTime:"2025-02-25 17:58:15"},{cardNumber:"679706886397601293",password:"ASXKK8D7",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"已锁定",productValue:"10",createTime:"2025-02-25 17:57:42"},{cardNumber:"762829251215552704",password:"XmJUg6eO",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"正常",productValue:"10",createTime:"2025-02-25 17:57:18"},{cardNumber:"332906932136546258",password:"jzWOEfI",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"正常",productValue:"10",createTime:"2025-02-25 17:56:54"},{cardNumber:"613038240784082504",password:"E8ca7Mpw",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"已锁定",productValue:"10",createTime:"2025-02-25 17:56:31"},{cardNumber:"550864709398981014",password:"jMSMZj2",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"正常",productValue:"10",createTime:"2025-02-25 17:56:08"},{cardNumber:"752222246573346743",password:"DXE7gTt8",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"正常",productValue:"10",createTime:"2025-02-25 17:55:44"},{cardNumber:"688099941296756970",password:"Mre8h3Mc",orderNumber:"",customerId:"1002",status:"未使用",verificationStatus:"未核销",lockStatus:"正常",productValue:"10",createTime:"2025-02-25 17:55:21"}]),S=c(!1),C=s({currentPage:1,pageSize:10,total:201}),k=()=>{S.value=!0,setTimeout(()=>{S.value=!1},1e3)},x=()=>{Object.keys(i).forEach(e=>{i[e]=""}),k()},I=e=>{C.pageSize=e,C.currentPage=1,k()},T=e=>{C.currentPage=e,k()},U=e=>{g.value=e},D=()=>{const e=g.value.filter(e=>"正常"===e.lockStatus);0!==e.length?z.confirm(`确认锁定选中的 ${e.length} 张卡密？`,"批量锁卡",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{e.forEach(e=>{e.lockStatus="已锁定"}),P.success(`成功锁定 ${e.length} 张卡密`)}).catch(()=>{P.info("已取消操作")}):P.warning("请选择未锁定的卡密")},E=()=>{const e=g.value.filter(e=>"已锁定"===e.lockStatus);0!==e.length?z.confirm(`确认解锁选中的 ${e.length} 张卡密？`,"批量解锁",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{e.forEach(e=>{e.lockStatus="正常"}),P.success(`成功解锁 ${e.length} 张卡密`)}).catch(()=>{P.info("已取消操作")}):P.warning("请选择已锁定的卡密")},O=()=>{0!==g.value.length?P.success(`正在导出 ${g.value.length} 条数据...`):P.warning("请选择要导出的数据")};return a(()=>{k()}),(e,a)=>{const c=l("el-input"),s=l("el-form-item"),m=l("el-option"),M=l("el-select"),R=l("el-button"),Y=l("el-form"),A=l("el-card"),B=l("el-table-column"),K=l("el-tag"),$=l("el-table"),F=l("el-pagination"),j=p("loading");return t(),o("div",la,[r(A,{shadow:"never",class:"filter-container"},{default:u(()=>[r(Y,{model:i,class:"multi-line-filter-form"},{default:u(()=>[d("div",ta,[r(s,{label:"卡密：",prop:"cardSecret"},{default:u(()=>[r(c,{modelValue:i.cardSecret,"onUpdate:modelValue":a[0]||(a[0]=e=>i.cardSecret=e),placeholder:"请输入卡密",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),r(s,{label:"卡包ID：",prop:"cardId"},{default:u(()=>[r(c,{modelValue:i.cardId,"onUpdate:modelValue":a[1]||(a[1]=e=>i.cardId=e),placeholder:"请输入卡包ID",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),r(s,{label:"使用状态：",prop:"status"},{default:u(()=>[r(M,{modelValue:i.status,"onUpdate:modelValue":a[2]||(a[2]=e=>i.status=e),placeholder:"请选择使用状态",clearable:"",style:{width:"168px"}},{default:u(()=>[r(m,{label:"未使用",value:"0"}),r(m,{label:"已使用",value:"1"})]),_:1},8,["modelValue"])]),_:1}),r(s,{label:"核销状态：",prop:"verificationStatus"},{default:u(()=>[r(M,{modelValue:i.verificationStatus,"onUpdate:modelValue":a[3]||(a[3]=e=>i.verificationStatus=e),placeholder:"请选择核销状态",clearable:"",style:{width:"168px"}},{default:u(()=>[r(m,{label:"未核销",value:"0"}),r(m,{label:"已核销",value:"1"})]),_:1},8,["modelValue"])]),_:1})]),d("div",oa,[r(s,{label:"锁卡状态：",prop:"lockStatus"},{default:u(()=>[r(M,{modelValue:i.lockStatus,"onUpdate:modelValue":a[4]||(a[4]=e=>i.lockStatus=e),placeholder:"请选择锁卡状态",clearable:"",style:{width:"168px"}},{default:u(()=>[r(m,{label:"正常",value:"0"}),r(m,{label:"已锁定",value:"1"})]),_:1},8,["modelValue"])]),_:1}),d("div",ra,[r(R,{type:"primary",icon:n(f),onClick:k},{default:u(()=>[...a[7]||(a[7]=[v("查询",-1)])]),_:1},8,["icon"]),r(R,{plain:"",icon:n(h),onClick:x},{default:u(()=>[...a[8]||(a[8]=[v("重置",-1)])]),_:1},8,["icon"])])])]),_:1},8,["model"])]),_:1}),r(A,null,{default:u(()=>[d("div",ua,[d("div",da,[r(R,{type:"warning",disabled:0===g.value.length||!y.value,onClick:D},{default:u(()=>[...a[9]||(a[9]=[v(" 批量锁卡 ",-1)])]),_:1},8,["disabled"]),r(R,{type:"success",disabled:0===g.value.length||!V.value,onClick:E},{default:u(()=>[...a[10]||(a[10]=[v(" 批量解锁 ",-1)])]),_:1},8,["disabled"]),r(R,{type:"primary",disabled:0===g.value.length,onClick:O},{default:u(()=>[...a[11]||(a[11]=[v(" 批量导出 ",-1)])]),_:1},8,["disabled"])]),d("div",na,[d("span",ia,"已选择 "+_(g.value.length)+" 项",1)])]),b((t(),w($,{data:N.value,style:{width:"100%"},onSelectionChange:U},{default:u(()=>[r(B,{type:"selection",width:"55"}),r(B,{prop:"cardNumber",label:"卡号",width:"180","show-overflow-tooltip":""}),r(B,{prop:"password",label:"密码",width:"120",align:"center"}),r(B,{prop:"orderNumber",label:"订单编号","min-width":"160","show-overflow-tooltip":""}),r(B,{prop:"customerId",label:"客户ID",width:"100",align:"center"}),r(B,{prop:"status",label:"使用状态",width:"100",align:"center"},{default:u(({row:e})=>[r(K,{type:"已使用"===e.status?"success":"未使用"===e.status?"":"warning"},{default:u(()=>[v(_(e.status),1)]),_:2},1032,["type"])]),_:1}),r(B,{prop:"verificationStatus",label:"核销状态",width:"100",align:"center"},{default:u(({row:e})=>[r(K,{type:"已核销"===e.verificationStatus?"success":"warning"},{default:u(()=>[v(_(e.verificationStatus),1)]),_:2},1032,["type"])]),_:1}),r(B,{prop:"lockStatus",label:"锁卡状态",width:"100",align:"center"},{default:u(({row:e})=>[r(K,{type:"已锁定"===e.lockStatus?"danger":"success"},{default:u(()=>[v(_(e.lockStatus),1)]),_:2},1032,["type"])]),_:1}),r(B,{prop:"productValue",label:"商品面值",width:"120",align:"center"},{default:u(({row:e})=>[d("span",ca,_(e.productValue)+"元",1)]),_:1}),r(B,{prop:"createTime",label:"创建时间",width:"160"}),r(B,{label:"操作",width:"150",fixed:"right"},{default:u(({row:e})=>[r(R,{link:"",type:"primary",onClick:a=>(e=>{P.info(`查看卡号 ${e.cardNumber} 的详情`)})(e)},{default:u(()=>[...a[12]||(a[12]=[v(" 查看详情 ",-1)])]),_:2},1032,["onClick"]),"正常"===e.lockStatus?(t(),w(R,{key:0,link:"",type:"warning",onClick:a=>(e=>{z.confirm(`确认锁定卡号 ${e.cardNumber}？`,"锁卡确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{e.lockStatus="已锁定",P.success("锁卡成功")}).catch(()=>{P.info("已取消操作")})})(e)},{default:u(()=>[...a[13]||(a[13]=[v(" 锁卡 ",-1)])]),_:2},1032,["onClick"])):(t(),w(R,{key:1,link:"",type:"success",onClick:a=>(e=>{z.confirm(`确认解锁卡号 ${e.cardNumber}？`,"解锁确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{e.lockStatus="正常",P.success("解锁成功")}).catch(()=>{P.info("已取消操作")})})(e)},{default:u(()=>[...a[14]||(a[14]=[v(" 解锁 ",-1)])]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"])),[[j,S.value]]),d("div",sa,[r(F,{"current-page":C.currentPage,"onUpdate:currentPage":a[5]||(a[5]=e=>C.currentPage=e),"page-size":C.pageSize,"onUpdate:pageSize":a[6]||(a[6]=e=>C.pageSize=e),"page-sizes":[10,20,50,100],total:C.total,layout:"total, sizes, prev, pager, next",onSizeChange:I,onCurrentChange:T},null,8,["current-page","page-size","total"])])]),_:1})])}}},[["__scopeId","data-v-f58be2ed"]]),pa={class:"sub-account-management"},fa={class:"filter-line"},va={class:"filter-buttons"},ha={class:"pagination-container"},ga={class:"dialog-footer"},ba={class:"dialog-footer"},wa=e({__name:"SubAccountManagement",setup(e){const i=s({username:"",status:""}),m=c([{accountId:1,username:"admin",status:"enabled",createTime:"1970-01-01 00:00:00"},{accountId:2,username:"user001",status:"disabled",createTime:"2024-01-15 10:30:00"},{accountId:3,username:"manager",status:"enabled",createTime:"2024-02-20 14:20:00"}]),g=c(!1),y=s({currentPage:1,pageSize:10,total:3}),V=c(!1),S=c(),k=s({username:"",status:"enabled"}),x={username:[{required:!0,message:"请输入用户名",trigger:"blur"}]},I=c(!1),T=c(),U=s({accountId:null,username:"",status:"enabled"}),D={username:[{required:!0,message:"请输入用户名",trigger:"blur"}]};function E(){g.value=!0,setTimeout(()=>{g.value=!1,P.success("搜索完成")},1e3)}function O(){Object.assign(i,{username:"",status:""}),P.info("筛选条件已重置")}function M(e){y.pageSize=e}function R(e){y.currentPage=e}function Y(){S.value.validate(e=>{if(e){const e={accountId:Date.now(),username:k.username,status:k.status,createTime:(new Date).toLocaleString("zh-CN")};m.value.unshift(e),y.total++,V.value=!1,P.success("新增成功")}})}function A(){T.value.validate(e=>{if(e){const e=m.value.findIndex(e=>e.accountId===U.accountId);e>-1&&(m.value[e].username=U.username,m.value[e].status=U.status,I.value=!1,P.success("编辑成功"))}})}return a(()=>{}),(e,a)=>{const c=l("el-input"),s=l("el-form-item"),B=l("el-option"),K=l("el-select"),$=l("el-button"),F=l("el-form"),j=l("el-card"),q=l("el-table-column"),H=l("el-tag"),L=l("el-popconfirm"),Q=l("el-table"),X=l("el-pagination"),G=l("el-switch"),Z=l("el-dialog"),J=p("loading");return t(),o("div",pa,[r(j,{shadow:"never",class:"filter-container"},{default:u(()=>[r(F,{model:i,class:"multi-line-filter-form"},{default:u(()=>[d("div",fa,[r(s,{label:"用户名：",prop:"username"},{default:u(()=>[r(c,{modelValue:i.username,"onUpdate:modelValue":a[0]||(a[0]=e=>i.username=e),placeholder:"请输入用户名",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),r(s,{label:"启用状态：",prop:"status"},{default:u(()=>[r(K,{modelValue:i.status,"onUpdate:modelValue":a[1]||(a[1]=e=>i.status=e),placeholder:"请选择状态",clearable:"",style:{width:"168px"}},{default:u(()=>[r(B,{label:"启用",value:"1"}),r(B,{label:"禁用",value:"0"})]),_:1},8,["modelValue"])]),_:1}),d("div",va,[r($,{type:"primary",icon:n(f),onClick:E},{default:u(()=>[...a[12]||(a[12]=[v("查询",-1)])]),_:1},8,["icon"]),r($,{plain:"",icon:n(h),onClick:O},{default:u(()=>[...a[13]||(a[13]=[v("重置",-1)])]),_:1},8,["icon"])])])]),_:1},8,["model"])]),_:1}),r(j,{shadow:"never",class:"table-card"},{default:u(()=>[b((t(),w(Q,{data:m.value,border:"",stripe:"",style:{width:"100%",height:"calc(100vh - 280px)"},height:"calc(100vh - 280px)"},{default:u(()=>[r(q,{prop:"accountId",label:"账户ID",width:"100"}),r(q,{prop:"username",label:"用户名",width:"180"}),r(q,{prop:"status",label:"状态",width:"120",align:"center"},{default:u(({row:e})=>[r(H,{type:"enabled"===e.status?"success":"danger"},{default:u(()=>[v(_("enabled"===e.status?"已启用":"已禁用"),1)]),_:2},1032,["type"])]),_:1}),r(q,{prop:"createTime",label:"创建时间","min-width":"200"}),r(q,{label:"操作",width:"180",fixed:"right"},{default:u(({row:e})=>[r($,{link:"",type:"primary",icon:n(N),onClick:a=>function(e){Object.assign(U,{accountId:e.accountId,username:e.username,status:e.status}),I.value=!0}(e)},{default:u(()=>[...a[14]||(a[14]=[v("编辑",-1)])]),_:2},1032,["icon","onClick"]),r(L,{title:"确认删除该账户？",onConfirm:a=>function(e){z.confirm(`确定要删除账户 "${e.username}" 吗？`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const a=m.value.findIndex(a=>a.accountId===e.accountId);a>-1&&(m.value.splice(a,1),y.total--,P.success("删除成功"))}).catch(()=>{P.info("已取消删除")})}(e)},{reference:u(()=>[r($,{link:"",type:"danger",icon:n(C)},{default:u(()=>[...a[15]||(a[15]=[v("删除",-1)])]),_:1},8,["icon"])]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[J,g.value]]),d("div",ha,[r(X,{"current-page":y.currentPage,"onUpdate:currentPage":a[2]||(a[2]=e=>y.currentPage=e),"page-size":y.pageSize,"onUpdate:pageSize":a[3]||(a[3]=e=>y.pageSize=e),"page-sizes":[10,20,50,100],total:y.total,layout:"total, sizes, prev, pager, next",onSizeChange:M,onCurrentChange:R},null,8,["current-page","page-size","total"])])]),_:1}),r(Z,{modelValue:V.value,"onUpdate:modelValue":a[7]||(a[7]=e=>V.value=e),title:"新增账户",width:"500px"},{footer:u(()=>[d("div",ga,[r($,{onClick:a[6]||(a[6]=e=>V.value=!1)},{default:u(()=>[...a[16]||(a[16]=[v("取消",-1)])]),_:1}),r($,{type:"primary",onClick:Y},{default:u(()=>[...a[17]||(a[17]=[v("确定",-1)])]),_:1})])]),default:u(()=>[r(F,{ref_key:"addFormRef",ref:S,model:k,rules:x,"label-width":"100px","label-position":"right"},{default:u(()=>[r(s,{label:"用户名",prop:"username"},{default:u(()=>[r(c,{modelValue:k.username,"onUpdate:modelValue":a[4]||(a[4]=e=>k.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),r(s,{label:"启用状态"},{default:u(()=>[r(G,{modelValue:k.status,"onUpdate:modelValue":a[5]||(a[5]=e=>k.status=e),"active-value":"enabled","inactive-value":"disabled"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),r(Z,{modelValue:I.value,"onUpdate:modelValue":a[11]||(a[11]=e=>I.value=e),title:"编辑账户",width:"500px"},{footer:u(()=>[d("div",ba,[r($,{onClick:a[10]||(a[10]=e=>I.value=!1)},{default:u(()=>[...a[18]||(a[18]=[v("取消",-1)])]),_:1}),r($,{type:"primary",onClick:A},{default:u(()=>[...a[19]||(a[19]=[v("确定",-1)])]),_:1})])]),default:u(()=>[r(F,{ref_key:"editFormRef",ref:T,model:U,rules:D,"label-width":"100px","label-position":"right"},{default:u(()=>[r(s,{label:"用户名",prop:"username"},{default:u(()=>[r(c,{modelValue:U.username,"onUpdate:modelValue":a[8]||(a[8]=e=>U.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),r(s,{label:"启用状态"},{default:u(()=>[r(G,{modelValue:U.status,"onUpdate:modelValue":a[9]||(a[9]=e=>U.status=e),"active-value":"enabled","inactive-value":"disabled"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}},[["__scopeId","data-v-f847edc8"]]),_a={class:"operation-log"},ya={class:"filter-line"},Va={class:"filter-buttons"},Na={class:"pagination-container"},Sa=e({__name:"OperationLog",setup(e){const i=s({username:"",timeRange:[]}),m=c([{accountId:1,username:"admin",operationType:"登录系统",operationTime:"2025-08-21 09:30:15",ipAddress:"192.168.1.100",description:"管理员登录后台管理系统"},{accountId:2,username:"user001",operationType:"查看订单",operationTime:"2025-08-21 10:15:22",ipAddress:"192.168.1.101",description:"查看订单列表，筛选条件：状态为已完成"},{accountId:1,username:"admin",operationType:"创建卡密",operationTime:"2025-08-21 11:20:45",ipAddress:"192.168.1.100",description:"批量创建卡密，数量：100张"},{accountId:3,username:"manager",operationType:"编辑用户",operationTime:"2025-08-21 14:35:18",ipAddress:"192.168.1.102",description:"修改用户权限，用户ID：12345"},{accountId:2,username:"user001",operationType:"导出数据",operationTime:"2025-08-21 15:42:33",ipAddress:"192.168.1.101",description:"导出订单数据，时间范围：2025-08-01至2025-08-21"}]),g=c(!1),_=s({currentPage:1,pageSize:10,total:5});function y(){g.value=!0,setTimeout(()=>{g.value=!1,P.success("搜索完成")},1e3)}function V(){Object.assign(i,{username:"",timeRange:[]}),P.info("筛选条件已重置")}function N(e){_.pageSize=e}function S(e){_.currentPage=e}return a(()=>{}),(e,a)=>{const c=l("el-input"),s=l("el-form-item"),C=l("el-date-picker"),k=l("el-button"),x=l("el-form"),I=l("el-card"),T=l("el-table-column"),P=l("el-table"),z=l("el-pagination"),U=p("loading");return t(),o("div",_a,[r(I,{shadow:"never",class:"filter-container"},{default:u(()=>[r(x,{model:i,class:"multi-line-filter-form"},{default:u(()=>[d("div",ya,[r(s,{label:"用户名：",prop:"username"},{default:u(()=>[r(c,{modelValue:i.username,"onUpdate:modelValue":a[0]||(a[0]=e=>i.username=e),placeholder:"请输入用户名",clearable:"",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),r(s,{label:"时间范围：",prop:"timeRange"},{default:u(()=>[r(C,{modelValue:i.timeRange,"onUpdate:modelValue":a[1]||(a[1]=e=>i.timeRange=e),type:"datetimerange","range-separator":"-","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",style:{width:"300px"}},null,8,["modelValue"])]),_:1}),d("div",Va,[r(k,{type:"primary",icon:n(f),onClick:y},{default:u(()=>[...a[4]||(a[4]=[v("查询",-1)])]),_:1},8,["icon"]),r(k,{plain:"",icon:n(h),onClick:V},{default:u(()=>[...a[5]||(a[5]=[v("重置",-1)])]),_:1},8,["icon"])])])]),_:1},8,["model"])]),_:1}),r(I,null,{default:u(()=>[b((t(),w(P,{data:m.value,border:"",stripe:"",style:{width:"100%"}},{default:u(()=>[r(T,{prop:"accountId",label:"账户ID",width:"100",align:"center"}),r(T,{prop:"username",label:"用户名",width:"120"}),r(T,{prop:"operationType",label:"操作类型",width:"120"}),r(T,{prop:"operationTime",label:"操作时间",width:"180"}),r(T,{prop:"ipAddress",label:"IP地址",width:"140",align:"center"}),r(T,{prop:"description",label:"操作描述","min-width":"250","show-overflow-tooltip":""})]),_:1},8,["data"])),[[U,g.value]]),d("div",Na,[r(z,{"current-page":_.currentPage,"onUpdate:currentPage":a[2]||(a[2]=e=>_.currentPage=e),"page-size":_.pageSize,"onUpdate:pageSize":a[3]||(a[3]=e=>_.pageSize=e),"page-sizes":[10,20,50,100],total:_.total,layout:"total, sizes, prev, pager, next",onSizeChange:N,onCurrentChange:S},null,8,["current-page","page-size","total"])])]),_:1})])}}},[["__scopeId","data-v-7a303fc9"]]),Ca={class:"reset-password"},ka={class:"form-container"},xa=e({__name:"ResetPassword",setup(e){const a=c(),n=c(!1),i=s({currentPassword:"",newPassword:"",confirmPassword:""}),m={currentPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"}],newPassword:[{required:!0,validator:(e,l,t)=>{""===l?t(new Error("请输入新密码")):l.length<6?t(new Error("密码长度不能少于6位")):l===i.currentPassword?t(new Error("新密码不能与当前密码相同")):(""!==i.confirmPassword&&a.value.validateField("confirmPassword"),t())},trigger:"blur"}],confirmPassword:[{required:!0,validator:(e,a,l)=>{""===a?l(new Error("请再次输入新密码")):a!==i.newPassword?l(new Error("两次输入密码不一致")):l()},trigger:"blur"}]},p=async()=>{try{await a.value.validate(),n.value=!0,await new Promise(e=>setTimeout(e,1e3)),P.success("密码修改成功"),f()}catch(e){}finally{n.value=!1}},f=()=>{var e;null==(e=a.value)||e.resetFields(),Object.assign(i,{currentPassword:"",newPassword:"",confirmPassword:""})};return(e,c)=>{const s=l("el-input"),h=l("el-form-item"),g=l("el-button"),b=l("el-space"),w=l("el-form"),_=l("el-card");return t(),o("div",Ca,[d("div",ka,[r(_,{class:"form-card"},{default:u(()=>[r(w,{ref_key:"passwordFormRef",ref:a,model:i,rules:m,"label-width":"100px"},{default:u(()=>[r(h,{label:"当前密码",prop:"currentPassword"},{default:u(()=>[r(s,{modelValue:i.currentPassword,"onUpdate:modelValue":c[0]||(c[0]=e=>i.currentPassword=e),type:"password",placeholder:"请输入当前密码","show-password":""},null,8,["modelValue"])]),_:1}),r(h,{label:"新密码",prop:"newPassword"},{default:u(()=>[r(s,{modelValue:i.newPassword,"onUpdate:modelValue":c[1]||(c[1]=e=>i.newPassword=e),type:"password",placeholder:"请输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),r(h,{label:"确认新密码",prop:"confirmPassword"},{default:u(()=>[r(s,{modelValue:i.confirmPassword,"onUpdate:modelValue":c[2]||(c[2]=e=>i.confirmPassword=e),type:"password",placeholder:"请再次输入新密码","show-password":""},null,8,["modelValue"])]),_:1}),r(h,null,{default:u(()=>[r(b,null,{default:u(()=>[r(g,{type:"primary",loading:n.value,onClick:p},{default:u(()=>[...c[3]||(c[3]=[v(" 保存 ",-1)])]),_:1},8,["loading"]),r(g,{onClick:f},{default:u(()=>[...c[4]||(c[4]=[v("重置",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])])}}},[["__scopeId","data-v-4a638ec1"]]),Ia={class:"admin-layout"},Ta={class:"header-right"},Pa={class:"el-dropdown-link"},za=e({__name:"AdminLayout",setup(e){const a=c("dashboard"),i=U(j),s={dashboard:j,"customer-management":Ve,"card-management":Ee,"order-management":aa,"card-query":ma,"subaccount-management":wa,"operation-log":Sa,"reset-password":xa},m=e=>{a.value=e,i.value=s[e]},p=e=>{if("logout"===e)P.success("退出登录成功")};return(e,c)=>{const s=l("el-icon"),h=l("el-dropdown-item"),g=l("el-dropdown-menu"),b=l("el-dropdown"),_=l("el-header"),y=l("el-menu-item"),V=l("el-sub-menu"),N=l("el-menu"),C=l("el-aside"),x=l("el-main"),I=l("el-container");return t(),o("div",Ia,[r(_,{class:"header"},{default:u(()=>[c[2]||(c[2]=d("div",{class:"header-left"},[d("h2",null,"卡密核销系统")],-1)),d("div",Ta,[r(b,{onCommand:p},{dropdown:u(()=>[r(g,null,{default:u(()=>[r(h,{command:"logout"},{default:u(()=>[...c[1]||(c[1]=[v("退出登录",-1)])]),_:1})]),_:1})]),default:u(()=>[d("span",Pa,[c[0]||(c[0]=v(" admin ",-1)),r(s,{class:"el-icon--right"},{default:u(()=>[r(n(k))]),_:1})])]),_:1})])]),_:1}),r(I,null,{default:u(()=>[r(C,{width:"200px",class:"sidebar"},{default:u(()=>[r(N,{"default-active":a.value,class:"el-menu-vertical",onSelect:m},{default:u(()=>[r(y,{index:"dashboard"},{default:u(()=>[r(s,null,{default:u(()=>[r(n(D))]),_:1}),c[3]||(c[3]=d("span",null,"仪表盘",-1))]),_:1}),r(y,{index:"customer-management"},{default:u(()=>[r(s,null,{default:u(()=>[r(n(E))]),_:1}),c[4]||(c[4]=d("span",null,"客户管理",-1))]),_:1}),r(y,{index:"card-management"},{default:u(()=>[r(s,null,{default:u(()=>[r(n(O))]),_:1}),c[5]||(c[5]=d("span",null,"卡密产品管理",-1))]),_:1}),r(y,{index:"order-management"},{default:u(()=>[r(s,null,{default:u(()=>[r(n(M))]),_:1}),c[6]||(c[6]=d("span",null,"订单管理",-1))]),_:1}),r(y,{index:"card-query"},{default:u(()=>[r(s,null,{default:u(()=>[r(n(f))]),_:1}),c[7]||(c[7]=d("span",null,"卡密查询",-1))]),_:1}),r(V,{index:"system-settings"},{title:u(()=>[r(s,null,{default:u(()=>[r(n(S))]),_:1}),c[8]||(c[8]=d("span",null,"系统设置",-1))]),default:u(()=>[r(y,{index:"subaccount-management"},{default:u(()=>[r(s,null,{default:u(()=>[r(n(R))]),_:1}),c[9]||(c[9]=d("span",null,"子账户管理",-1))]),_:1}),r(y,{index:"operation-log"},{default:u(()=>[r(s,null,{default:u(()=>[r(n(Y))]),_:1}),c[10]||(c[10]=d("span",null,"操作日志",-1))]),_:1}),r(y,{index:"reset-password"},{default:u(()=>[r(s,null,{default:u(()=>[r(n(A))]),_:1}),c[11]||(c[11]=d("span",null,"重置密码",-1))]),_:1})]),_:1})]),_:1},8,["default-active"])]),_:1}),r(x,{class:"main-content"},{default:u(()=>[(t(),w(B(i.value)))]),_:1})]),_:1})])}}},[["__scopeId","data-v-091fdcbd"]]);export{za as A};
